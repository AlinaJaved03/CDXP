@{
    ViewBag.Title = "Despatch Instruction";
}
<div id="pcontent">

    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
            <div class="panel panel-default card-view panel-refresh">
                <div class="refresh-container">
                    <div class="la-anim-1"></div>
                </div>
                <div class="panel-heading">
                    <div class="pull-left" style="display: inline-flex;">
                        <i class="fa fa-wpforms" style="padding-top: 4px;margin-right: 5px;color:#fff;"></i>
                        <h6 class="panel-title txt-light">@ViewBag.Title</h6>
                    </div>
                    <div class="pull-right">
                        <a class="pull-left inline-block mr-15" data-toggle="collapse" href="#collapse_1" aria-expanded="true">
                            <i class="zmdi zmdi-chevron-down"></i>
                            <i class="zmdi zmdi-chevron-up"></i>
                        </a>


                        <a href="#" class="pull-left inline-block full-screen mr-15">
                            <i class="zmdi zmdi-fullscreen"></i>
                        </a>
                        @*<a class="pull-left inline-block close-panel" href="#" data-effect="fadeOut">
                                <i class="zmdi zmdi-close"></i>
                            </a>*@
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div id="collapse_1" class="panel-wrapper collapse in">
                    <div class="panel-body">

                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Header</div>
                            <div class="tab2">&nbsp;</div>
                        </div>



                        <div style="margin-bottom: 20px;">
                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="ddlIPP_Cat">Category<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control requiredFieldBGC Ipp" id="ddlIPP_Cat" required>
                                            @Html.Raw(@ViewBag.IPP)
                                        </select>
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="ddlIPP">Power Producer<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC Ipp" id="ddlIPP" required>
                                        </select>
                                    </td>

                                </tr>

                                <tr>

                                    <td style="width: 25%;">
                                        <label for="ddlSite">Producer Site<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">

                                        <select class="form-control frm requiredFieldBGC Ipp" id="ddlSite" required></select>
                                    </td>
                                </tr>
                                <tr style="display:none">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Complex / Block / Unit<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control requiredFieldBGC Ipp" id="ddlBlock"></select>
                                    </td>
                                </tr>
                                <tr style="display:none">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Fuel Type</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" class="form-control frm" readonly id="txtFuel">
                                    </td>
                                </tr>

                                <tr style="display:none">
                                    @*<td style="width: 25%;">
                        <label for="Disconame">Type</label>
                    </td>
                    <td style="width: 25%;">
                        <select class="form-control frm">
                            <option>Complex Wise</option>
                            <option>Block Wise</option>
                        </select>
                    </td>*@


                                    <td style="width: 25%;">
                                        <label for="Disconame">Power Policy</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" id="txtPowerPolicy" class="form-control" readonly>
                                    </td>

                                </tr>



                            </table>

                            <div style="margin-bottom:20px;">
                                <div class="col-6" style="width:49%;float:left;">
                                    <div class="tab0 ">
                                        &nbsp;<div class="tab1 ">&nbsp;Recent Events</div>
                                        <div class="tab2 ">&nbsp;</div>
                                    </div>
                                    <div>
                                        <div id="tblEventsContainer">

                                        </div>

                                    </div>
                                </div>

                                <div class="col-6" style="width:49%;float:right;">
                                    <div class="tab0 ">
                                        &nbsp;<div class="tab1 ">&nbsp;Recent Despatch Instruction</div>
                                        <div class="tab2 ">&nbsp;</div>
                                    </div>
                                    <div>
                                        <div id="tblDespatchContainer"></div>
                                    </div>
                                </div>


                            </div>
                            <div class="tab0">
                                &nbsp;<div class="tab1">&nbsp;Despatch Instruction</div>
                                <div class="tab2">&nbsp;</div>
                            </div>
                            <div style="margin-bottom: 20px;">
                                <table>
                                    <tr>
                                        <td style="width: 15%;">
                                            <label for="Disconame">Notification Date & Time<span class="startColor"> *</span></label>
                                        </td>
                                        <td style="width: 75%;">
                                            <input id="txtDIF_NotifyDateTime" value="@ViewBag.currentDate" type="text" class="form-control frm dtDateTime requiredFieldBGC Ipp">

                                        </td>

                                    </tr>

                                    <tr>
                                        <td>
                                            <label for="Disconame">Current Availability</label>
                                        </td>
                                        <td>
                                            <input type="text" id="txtDIF_currentAvailability" class="form-control  frm Ipp" readonly>
                                        </td>
                                    </tr>

                                    <tr id="trDIF_SystemConstraintcheckbox">
                                        <td>
                                            <label for="Disconame">System Constraint</label>
                                        </td>
                                        <td>
                                            <input type="checkbox" id="txtDIF_SystemConstraint" class="frm" value="true">
                                        </td>
                                    </tr>

                                    <tr id="trDIF_SystemConstraintReason" style="display:none">
                                        <td>
                                            <label for="Disconame">System Constraint Reason</label>
                                        </td>
                                        <td>
                                            <input type="text" id="txtDIF_SystemConstraintReason" class="form-control  frm Ipp">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label>Demand Type<span class="startColor"> *</span></label>
                                        </td>
                                        <td colspan="2">
                                            <select id="ddlDT" class="form-control frm Ipp">
                                                <option class="rdtop">Sync</option>
                                                <option class="rdtop">Desync</option>
                                                <option class="rdtop">Increase/Decrease Load</option>
                                                <option style="display:none" class="rdtop">Reduce Load</option>
                                                <option class="rdtop">Miscellaneous</option>

                                            </select>

                                        </td>
                                    </tr>

                                    <tr id="trDIE_EDemand" style="display:none;">
                                        <td>
                                            <label>Emergency Demand<span class="startColor"> *</span></label>
                                        </td>
                                        <td>
                                            <select id="ddlEmrgncyTyp" class="form-control frm Ipp"><option value=""></option></select>
                                        </td>
                                    </tr>
                                    <tr style="display:none;" id="trDIF_SDDateTime">

                                        <td>&nbsp;</td>
                                        <td>
                                            <table class="table table-striped table-bordered" id="tblMultircd" style="padding-left:unset">
                                                <thead>
                                                    <tr id="trMultircdS">
                                                        <th id="td_ddl_Unit" class="tblrcd " style="width:150px;">
                                                            <select id="ddl_Unit" class="form-control Ipp"></select>
                                                        </th>
                                                        <th id="td_dt_SyncDesyncTime" class="tblrcd ">
                                                            <input type="text" class="form-control  Ipp" id="dt_SyncDesyncTime" readonly />
                                                        </th>
                                                        <th id="td_txt_present_State" class="tblrcd " style="display: none">
                                                            <input type="text" class="form-control  Ipp" id="txt_present_State" readonly />
                                                        </th>
                                                        <th id="td_txt_NTS" class="tblrcd">
                                                            <input type="text" class="form-control  Ipp" id="txt_NTS" readonly />
                                                        </th>
                                                        <th id="td_txt_NTS_Date_Time" class="tblrcd">
                                                            <input style="width:180px;font-weight: 700" type="text" class="form-control  Ipp dtDateTime" id="txt_NTS_Date_Time" readonly />
                                                        </th>
                                                        <th id="td_txt_Target_Demand" class="tblrcd  ">
                                                            <input type="text" class="form-control  Ipp" id="txt_Target_Demand" />
                                                        </th>
                                                        <th id="td_txt_Load_Achieve" class="tblrcd ">
                                                            <input type="text" class="form-control  Ipp" id="txt_Load_Achieve" readonly />
                                                        </th>
                                                        <th id="td_txt_Load_Achieve_Min" class="tblrcd ">
                                                            <input type="text" class="form-control  Ipp" id="txt_Load_Achieve_Min" readonly />
                                                        </th>
                                                        <th id="td_txt_Load_Achieve_Date_Time" class="tblrcd ">
                                                            <input style="width:180px;font-weight: 700" type="text" class="form-control  Ipp" id="txt_Load_Achieve_Date_Time" readonly />
                                                        </th>
                                                        <th id="td_txt_Load_Achieve_Date_Time_WST" class="tblrcd ">
                                                            <input type="text" class="form-control  Ipp" id="txt_Load_Achieve_Date_Time_WST" readonly />
                                                        </th>
                                                        <th id="td_txt_Load_Achieve_Date_Time_WOST" class="tblrcd ">
                                                            <input type="text" class="form-control Ipp" id="txt_Load_Achieve_Date_Time_WOST" readonly />
                                                        </th>
                                                        <th id="td_btn_AddRow" style="width:40px;" class="tblrcd ">
                                                            <input type="button" class="btn btn-success Ipp" id="btn_AddRow" value=" + " />
                                                        </th>
                                                    </tr>
                                                    <tr>

                                                        <th id="th_unit" style="font-weight: 700;text-align: center;">Unit No.</th>
                                                        <th id="th_standby_hrs" style="font-weight: 700;text-align: center;">Standby (hours)</th>
                                                        <th id="th_present_state" style="font-weight: 700;text-align: center;">Present State</th>
                                                        <th id="th_nts" style="font-weight: 700;text-align: center;">NTS (Mins)</th>
                                                        <th id="th_sync_time" style="font-weight: 700;text-align: center;">Sync Time</th>
                                                        <th id="th_target_demand" style="font-weight: 700;text-align: center;">Target Demand (MW)</th>
                                                        <th id="th_calculated_time" style="font-weight: 700;text-align: center;">Calculated Time (Mins)</th>
                                                        <th id="th_load_achievement_min" style="font-weight: 700;text-align: center;">Load Achievement (Mins)</th>
                                                        <th id="th_load_achievement_time" style="font-weight: 700;text-align: center;">Load Achievement Time</th>
                                                        <th id="th_load_achievement_time_wst" style="font-weight: 700;text-align: center;">Load Achievement Time (with ST)</th>
                                                        <th id="th_load_achievement_time_wost" style="font-weight: 700;text-align: center;">Load Achievement Time (without ST)</th>
                                                        <th id="th_actual_sync_time_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Sync Time</th>
                                                        <th id="th_actual_load_achievement_time_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Load Achievement Time</th>
                                                        <th id="th_actual_achieved_load_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Load Achieved</th>

                                                        <th id="th_btn_AddRow">
                                                        </th>
                                                    </tr>

                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr id="trDIF_DDateTime" style="display:none">

                                        <td>&nbsp;</td>
                                        <td>
                                            <table class="table table-striped table-bordered" id="tblMultircdD">
                                                <thead>
                                                    <tr id="trMultircdD">
                                                        <th id="td_Dddl_Unit" class="tblrcd">
                                                            <select id="Dddl_Unit" class="form-control  Ipp"></select>
                                                        </th>
                                                        <th id="td_Current_Load" class="tblrcd">
                                                            <input type="text" class="form-control Ipp" id="txt_DTarget_Demand" />
                                                        </th>
                                                        <th id="td_NTDS" class="tblrcd">
                                                            <input type="text" class="form-control Ipp" id="txt_DLoad_Achieve" readonly />
                                                        </th>                                                       
                                                        <th id="td_DesyncTime" class="tblrcd">
                                                            <input type="text" class="form-control Ipp" id="txt_DLoad_Achieve_Date_Time" readonly />
                                                        </th>
                                                        <th id="td_btn_DAddRow" style="width:40px;" class="tblrcd">
                                                            <input type="button" class="btn btn-success Ipp" id="btn_DAddRow" value=" + " />
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th id="th_dunit" style="font-weight: 700;text-align: center; ">Unit</th>
                                                        <th id="th_dCurrent_load" style="font-weight: 700;text-align: center;">Current Load</th>
                                                        <th id="th_ntds" style="font-weight: 700;text-align: center;">NTDS (Mins)</th>
                                                        <th id="th_desync_time" style="font-weight: 700;text-align: center;">Unit Desync Time</th>
                                                        <th id="th_actual_desync_time_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Desync Time</th>
                                                        @*<th id="th_actual_load_achievement_time_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Load Achievement Time</th>
                                                        <th id="th_actual_achieved_load_ipp" class="ippAck" style="font-weight: 700;text-align: center;display:none">Actual Load Achieved</th>*@

                                                        <th id="th_btn_DAddRow"></th>
                                                    </tr>

                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr id="tr_message_Sync" style="display:none">
                                        <td style="width: 25%;">
                                            <label><span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input type="text" class="form-control Ipp" value="Sync above units as soon as possible" readonly />
                                        </td>
                                    </tr>
                                    <tr id="tr_message_Desync" style="display:none">
                                        <td style="width: 25%;">
                                            <label><span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input type="text" class="form-control Ipp" value="Desync above units as soon as possible" readonly />
                                        </td>
                                    </tr>
                                    <tr id="tr_IDLC" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Complex/Block<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <select id="ddlIDL_COMPLEX" class="form-control Ipp"></select>
                                        </td>

                                    </tr>
                                    <tr id="tr_IDLOBU" style="display:none">
                                        <td style="width: 25%;">
                                            <label>No. of On bar Units<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_ONBAR_UNITS" type="text" class="form-control requiredFieldBGC " readonly style="background-color:rgb(251, 255, 193);">
                                        </td>

                                    </tr>
                                    <tr id="tr_IDLCL" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Current Load<span class="startColor Spanreqclass"> (MW) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_CURRENTLOAD" type="text" class="form-control requiredFieldBGC " style="background-color:rgb(251, 255, 193);">
                                        </td>

                                    </tr>
                                    <tr id="tr_IDL" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Target Demand<span class="startColor Spanreqclass">(MW) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input type="text" id="txtIDL_targetDemand" style="display:inline-block;  background-color:rgb(251, 255, 193);" class="form-control t_a_time requiredFieldBGC">
                                        </td>

                                    </tr>

                                    <tr id="tr_IDLLA" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Load Achieved (Mins)<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_LOAD_ACHIEVE" type="text" readonly class="form-control requiredFieldBGC ">
                                        </td>
                                    </tr>
                                    <tr id="tr_IDLLAT" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Load Achievement Time <span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_LOAD_ACHIEVE_TIME" type="text" readonly class="form-control t_a_time requiredFieldBGC " >

                                        </td>
                                    </tr>
                                    <tr id="tr_IDLLATCAT2" style="display:none">
                                        <td style="width: 25%;">
                                            <label>COMPLEX Load Achievement Time <span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_LOAD_ACHIEVE_TIME_CAT2" type="text" class="form-control dtDateTime requiredFieldBGC " style="background-color:rgb(251, 255, 193);">

                                        </td>
                                    </tr>
                                    <tr id="tr_IDLDM" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Demand Meet(MW)<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_DEMAND_MEET" type="text" class="form-control t_a_time requiredFieldBGC IppID">

                                        </td>
                                    </tr>
                                    <tr id="tr_IDLALAT" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Actual Load Achievement Time<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtIDL_Actual_Load_Achievement_Time" type="text" class="form-control t_a_time dtDateTime requiredFieldBGC IppID">

                                        </td>
                                    </tr>

                                    <tr id="tr_ddlEmergency" style="display:none">
                                        <td style="width: 25%;">
                                            <label>Miscellaneous<span class="startColor Spanreqclass"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <select id="ddl_Emergency" class="form-control Ipp"></select>
                                        </td>
                                    </tr>

                                </table>
                            </div>


                        </div>@*End Of Table*@


                        <div class="tab0 ">
                            &nbsp;<div class="tab1 ">&nbsp;Technical Limits</div>
                            <div class="tab2 ">&nbsp;</div>
                        </div>
                        <div id="Technical_limits" style="width:49%;float:left;">

                        </div>


                        <div class="tab0 npshow nphide" style="display:none;">
                            &nbsp;<div class="tab1">&nbsp;Remarks</div>
                            <div class="tab2">&nbsp;</div>
                        </div>

                        <div class="npshow nphide" style="margin-bottom: 20px; display:none;">
                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Sender Name</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" id="txtDIF_senderName" value="@ViewBag.name" class="form-control frm npshow" >
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Sender Designation</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" id="txtDIF_senderDesg" value="@ViewBag.designation" class="form-control frm npshow" >
                                    </td>
                                </tr>
                            </table>
                            <label>Sender Notes<span class="startColor"> </span></label>
                            <textarea cols="70" rows="6" maxlength="2000" class="requiredFieldBGC frm npshow" id="prevTxtAreaRemarks" style="width: 100%;"></textarea>

                        </div>

                        <div class="tab0 ackshow ackhide" style="display:none;">
                            &nbsp;<div class="tab1">&nbsp;Acknowledgement</div>
                            <div class="tab2">&nbsp;</div>
                        </div>

                        <div class="ackshow ackhide" style="margin-bottom: 20px;display:none;">

                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Acknowledge By</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.name" placeholder="@ViewBag.name" id="txtDIF_AckBy" class="form-control  ackshow" disabled>
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Designation</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.designation" placeholder="@ViewBag.designation" id="txtDIF_AckDesignation" class="form-control  ackshow" disabled>
                                    </td>
                                </tr>
                            </table>
                            <label>Acknowledgement Notes<span class="startColor"></span></label>
                            <textarea cols="70" rows="6" class=" ackshow" maxlength="2000" id="prevTxtAreaAcknowledgement" style="width: 100%;"></textarea>

                        </div>

                        <div class="tab0 compshow comphide" style="display:none;">
                            &nbsp;<div class="tab1">&nbsp;Compliance with Despatch</div>
                            <div class="tab2">&nbsp;</div>
                        </div>

                        <div class="compshow comphide" style="margin-bottom: 20px;display:none;">

                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Updated By </label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.name" placeholder="@ViewBag.name" id="txtDIF_Update" class="form-control ippComp  compshow" >
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Designation</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.designation" placeholder="@ViewBag.designation" id="txtDIF_UpdateDesignation" class="form-control ippComp compshow" >
                                    </td>
                                </tr>

                                <tr id="trDIF_UpdateRd" style="display: none;">
                                    <td colspan="2" style="width:25%;">
                                        <input class="rdCtrl rdAch" type="radio" name="rdDIF_UpdateRd" value="Full_Achieved" required checked /><span class="rdText"> Full Achieved</span>
                                        <input class="rdCtrl rdAch" type="radio" name="rdDIF_UpdateRd" value="Partial_Achieved" required /><span class="rdText"> Partial</span>
                                    </td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                </tr>
                                <tr style="display: none;">
                                    <td>&nbsp;</td>
                                    <td colspan="3">
                                        <table class="table table-striped table-bordered" id="tblMultircd_Remarks">
                                            <thead>
                                                <tr>
                                                    <th>Unit</th>
                                                    <th>Date & Time</th>
                                                    <th>Achieved</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </td>
                                </tr>
                                <tr style="display: none;">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Target Achieved (MW)</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="" id="txtDIF_TargetAchieved" class="form-control frm compshow">
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Achievement Time</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtDIF_UpdateAchievementTime" type="text" class="form-control frm dtDateTime requiredFieldBGC">
                                        @*<input type="text" class="form-control frm dtDateTime requiredFieldBGC" />*@
                                    </td>
                                </tr>
                            </table>

                            <label>Compliance Notes<span class="startColor"></span></label>
                            <textarea cols="70" rows="6" class="ippComp compshow" maxlength="2000" id="prevTxtUpdate" style="width: 100%;"></textarea>

                        </div>


                        <div class="form-actions">
                            <div class="row" style="text-align :right;">
                                <div class="col-md-12">

                                    <button style="float:left;display:none;" value="Submitted" class="btn btn-success btnAction" type="button" id="btnDIF_submit">
                                        Submit
                                    </button>
                                    <button style="float:left;display:none;" value="Submitted" class="btn btn-success btnAction" type="button" id="btnDIF_update">
                                        Update
                                    </button>
                                    <button style="float:left;display:none;" value="Acknowledged" class="btn btn-success btnAction" type="button" id="btnDIF_Ack">
                                        Acknowledge
                                    </button>
                                    <button style="float:left;display:none;" value="Compliance" class="btn btn-success" type="button" id="btnDIF_Cmp">
                                        Compliance
                                    </button>
                                    <button id="btnClose" tg="@ViewBag.tg" style="float:left;" class="btn btn-default" type="button">
                                        Close
                                    </button>

                                </div>
                            </div>
                        </div>



                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {

            var usertype = 0;


            $('body').off('click', '#txtDIF_SystemConstraint');
            $('body').on('click', '#txtDIF_SystemConstraint', function (e) {
                //$("#txtDIF_SystemConstraint").prop("checked", false);

                if ($('#txtDIF_SystemConstraint').is(':checked')) {
                    $('#trDIF_SystemConstraintReason').show();
                }
                else {
                    $('#trDIF_SystemConstraintReason').hide();
                }

            });


            //checkstatus
            function CheckStatus() {
                $('#btnDIF_submit').hide();
                $('#btnDIF_update').hide();
                $('#btnDIF_Ack').hide();
                $('#btnDIF_Cmp').hide();

                if (((usertype == 7) || (usertype == 9)) && $status == "") {

                    $('.clsRmv').show();
                    $('.npshow').show();
                    $('#btnDIF_submit').show();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", false);
                    $('#tr_IDLDM').hide();
                    $('#tr_IDLALAT').hide();
                    $('#tr_IDLLATCAT2').hide();


                    return false;
                }

                if (((usertype == 7) || (usertype == 9)) && $status == "Draft") {
                    //$('.tlimits').hide();
                    $('.npshow').show();
                    $('.frm').prop("disabled", false);
                    $('#btnDIF_submit').show();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);

                    return false;
                }

                if (((usertype == 7) || (usertype == 9)) && $status == "Submitted") {

                    $('.clsRmv').hide();
                    //$('.tlimits').hide();
                    $('.npshow').show();
                    $('.frm').prop("disabled", true);
                    $('.pstate').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", true);
                    $('.compshow').hide();
                    $('#btn_AddRow').hide();
                    $('#remarksShow').val('').hide();
                    $('#txtIDL_DEMAND_MEET').show();
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').show();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#txt_IPPAAT').hide();
                    $('#txt_IPPST').hide();
                    $('#txt_IPPAAL').hide(); 
                    $('.ippAck').hide();
                    $('#trMultircdS,#trMultircdD').hide();


                    return false;
                }                

                if (((usertype == 7) || (usertype == 9)) && $status == "Acknowledged") {

                    $('.clsRmv').hide();
                    //$('.tlimits').hide();
                    $('.npshow').show();
                    $('.frm').prop("disabled", true);
                    $('.pstate').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", true);
                    $('.compshow').hide();
                    $('#btn_AddRow').hide();
                    $('#remarksShow').val('').hide();
                    $('#txtIDL_DEMAND_MEET').show();
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').show();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#txt_IPPAAT').hide();
                    $('#txt_IPPAAL').hide();
                    $('#txt_IPPST').hide();
                    $('.ippAck').hide();
                    $('#trMultircdS,#trMultircdD').hide();


                    return false;
                }

                if (((usertype == 7) || (usertype == 9)) && ($status == "Compliance" || $status == "Full Compliance" || $status == "Partial Compliance" )) {

                    $('.clsRmv').hide();
                    //$('.tlimits').hide();
                    $('.ippAck').show();
                    $('.npshow').show();
                    $('.frm').prop("disabled", true);
                    $('.pstate').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", true);
                    $('.compshow').show();
                    $('.compshow').prop("disabled", true);
                    $('#btn_AddRow').hide();
                    $('#remarksShow').val('').hide();
                    $('#txtIDL_DEMAND_MEET').show();
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true); 
                    $('#txtIDL_Actual_Load_Achievement_Time').show();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#txt_IPPAAT').show();
                    $('#txt_IPPAAL').show();
                    $('#txt_IPPST').show();
                    $('#trMultircdS,#trMultircdD').hide();

                    return false;
                }


                if (((usertype == 7) || (usertype == 9)) && $status == "Achieved") {
                    $('#remarksShow').val('1').hide();
                    $('tblrcd').hide();
                    //$('.tlimits').hide();
                    $('.npshow').show();
                    $('.frm').prop("disabled", true);
                    $('.pstate').prop("disabled", true);
                    $('.ackshow').show();
                    $('.frm').prop("disabled", true);
                    $('.compshow').show();
                    $('.frm, .rdAch').prop("disabled", true);
                    $('#btn_AddRow').hide();
                    $('#trDIF_SystemConstraintcheckbox').hide();
                    $('#trDIF_SystemConstraintReason').hide();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);

                    return false;
                }

                if (usertype == 10 && $status == "Submitted") {

                    $('.clsRmv').hide();
                    //$('.rdtop').prop("disabled", true);
                    //$('.tlimits').hide();
                    $('#trMultircdS,#trMultircdD').hide();
                    $('#btnDIF_Ack').show();
                    $('.npshow').show();
                    $('.npshow').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", false);
                    $('.compshow').hide();                    
                    $('.frm').prop("disabled", true);
                    $('#btn_AddRow').hide();
                    $('#trMultircdS').hide();
                    $('#trMultircdD').hide();
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true); 
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#trDIF_SystemConstraintcheckbox').hide();
                    $('#trDIF_SystemConstraintReason').hide();
                    //$('#txt_IPPAAT').prop("disabled", true);
                    //$('#txt_IPPAAL').prop("disabled", true);
                    //$('#txt_IPPST').prop("disabled", true);
                    $('.ippAck').show();
                    $('.ippCompVal').prop("disabled", true);

                    return false;
                }

                if (usertype == 10 && $status == "Acknowledged") {

                    $('.ippAck').show();
                    $('.clsRmv').hide();
                    $('.frm').prop("disabled", true);
                    $('#trMultircdS,#trMultircdD').hide();
                    $('.ippAck').show();
                    $('.npshow').show();
                    $('.npshow').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", true);
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true); 
                    $('.compshow').show();
                    $('#btn_AddRow').hide();
                    $('#txtIDL_DEMAND_MEET').prop("disabled", false);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", false);
                    $('#trDIF_SystemConstraintcheckbox').hide();
                    $('#trDIF_SystemConstraintReason').hide();
                    $('#txt_IPPAAT').show();
                    $('#txt_IPPAAL').show();
                    $('#txt_IPPST').show();
                    $('#btnDIF_Cmp').show(); 
                    $('#tr_IDLALAT').show();
                    $('#tr_IDLDM').show(); 

                    return false; 
                }

                if (usertype == 10 && ($status == "Compliance" || $status == "Full Compliance" || $status == "Partial Compliance")) { 

                    $('.clsRmv').hide();
                    $('.frm').prop("disabled", true);
                    $('#trMultircdS,#trMultircdD').hide();
                    $('.ippAck').show();
                    $('.npshow').show();
                    $('.npshow').prop("disabled", true);
                    $('.ackshow').show();
                    $('.ackshow').prop("disabled", true);
                    $('.compshow').show();
                    $('.compshow').prop("disabled", true);
                    $('#btn_AddRow').hide();
                    $('#txtIDL_CURRENTLOAD').prop("disabled", true);
                    $('#txtIDL_targetDemand').prop("disabled", true); 
                    $('#txtIDL_DEMAND_MEET').prop("disabled", true);
                    $('#txtIDL_Actual_Load_Achievement_Time').prop("disabled", true);
                    $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').prop("disabled", true);
                    $('#trDIF_SystemConstraintcheckbox').hide();
                    $('#trDIF_SystemConstraintReason').hide();
                    $('#txt_IPPAAT').show();
                    $('#txt_IPPAAL').show();
                    $('#txt_IPPST').show();
                   
                    $('#btnDIF_Cmp').hide();
                    $('.ippCompVal').prop("disabled", true);

                    return false;
                }
               
            }


            $(function () {


                @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 7)
                {
                     @: usertype = 7;
                }
                else if(ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 10)
                {
                    @: usertype = 10;
                }

                @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 9)
                {
                     @: usertype = 9;
                }

                if ($('#btnClose').attr('tg') == "0") {
                    LoadVendors();
                    CheckStatus();
                }
                else {

                    //FILL FORM TO UPDATE OR VIEW OR FOR FLOW
                    LoadVendors();
                    CheckStatus();
                    LoadFormByID();
                }

            });


            function Visible_DI_Elements_Sync() {

                $('#td_ddl_Unit').show();
                $('#td_dt_SyncDesyncTime').show();
                $('#td_txt_present_State').show();
                $('#td_txt_NTS').show();
                $('#td_txt_NTS_Date_Time').show();
                $('#td_txt_Target_Demand').show();
                $('#td_txt_Load_Achieve').show();
                $('#td_txt_Load_Achieve_Date_Time').show();
                $('#td_txt_Load_Achieve_Min').show();
                $('#td_txt_Load_Achieve_Date_Time_WST').show();
                $('#td_txt_Load_Achieve_Date_Time_WOST').show();

                $('#th_unit').show();
                $('#th_standby_hrs').show();
                $('#th_present_state').show();
                $('#th_nts').show();
                $('#th_sync_time').show();
                $('#th_target_demand').show();
                $('#th_calculated_time').show();
                $('#th_load_achievement_time').show();
                $('#th_load_achievement_min').show();
                $('#th_load_achievement_time_wst').show();
                $('#th_load_achievement_time_wost').show();
                $('#td_Dddl_Unit').show();
                $('#td_Current_Load').show();
                $('#td_NTDS').show();
                $('#td_NTDS_Time').show();
                $('#td_DesyncTime').show();
                $('#td_btn_DAddRow').show();
                $('#th_dunit').show();
                $('#th_dCurrent_load').show();
                $('#th_ntds').show();
                $('#th_ntds_time').show();
                $('#th_desync_time').show();
                $('#message_Desync').show();
                $('#message_Sync').show();
                $('#tr_ddlEmergency').show();
                $('#tr_IDLDM').show();
                $('#tr_IDLALAT').show();
                $('#tr_message_Desync').show();
                $('#tr_message_Sync').show();
                $('#tr_IDLLATCAT2').show();

            }

             
            function DT_Cosmetic_byDICat() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);
                        //$("#ddlDT option[value='option1']").remove();


                        if (fd[0].DI_ID == '1') {
                            //$('#ddlDT').append('<option value="option1">Increase/Decrease Load</option>');

                            if ($('#ddlDT').val() == 'Sync') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#trDIF_SDDateTime').show();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WST').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WOST').hide();
                                $('#th_load_achievement_time_wst').hide();
                                $('#th_load_achievement_time_wost').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();
                            }

                            if ($('#ddlDT').val() == 'Miscellaneous') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#tr_ddlEmergency').show();
                                $('#ddl_Emergency').html('<option>Increase Complex load at Maximum possible Ramp Rate</option><option>Decrease Complex load at Maximum possible Ramp Rate</option><option>Increase Complex load at Maximum Step Change</option><option>Decrease Complex load at Maximum Step Change</option><option>Maintain System Frequency at 50 Hz</option>');
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();


                            }
                            if ($('#ddlDT').val() == 'Desync') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#tr_ddlEmergency').hide();
                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').show();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();


                            }
                            if ($('#ddlDT').val() == 'Increase/Decrease Load') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').show();
                                $('#tr_IDLLA').show();
                                $('#tr_IDLLAT').show();
                                $('#tr_IDLCL').show();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').show();
                                $('#td_Current_Load').hide();
                                $('#th_dCurrent_load').hide();
                                $('#td_NTDS').hide();
                                $('#th_ntds').hide();
                                $('#td_DesyncTime').hide();
                                $('#th_desync_time').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').show();
                                $('#tr_IDLALAT').show();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();
                            }
                        }


                        if (fd[0].DI_ID == '2') {

                            //$('#I/D_option').hide();


                            if ($('#ddlDT').val() == 'Sync') {

                                Visible_DI_Elements_Sync();
                                $('#trDIF_SDDateTime').show();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').show();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLLATCAT2').show();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_txt_NTS_Date_Time').hide();
                                $('#th_sync_time').hide();
                                $('#td_txt_Target_Demand').hide();
                                $('#th_target_demand').hide();
                                $('#td_txt_Load_Achieve').hide();
                                $('#th_calculated_time').hide();
                                $('#td_txt_NTS').hide();
                                $('#th_nts').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').show();
                                $('#tr_IDLALAT').show();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WST').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WOST').hide();

                                $('#th_load_achievement_time_wst').hide();
                                $('#th_load_achievement_time_wost').hide();
                            }

                            if ($('#ddlDT').val() == 'Miscellaneous') {
                                Visible_DI_Elements_Sync();

                                $('#trDIF_SDDateTime').hide();
                                $('#tr_IDLLATCAT2').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#tr_ddlEmergency').show();
                                $('#ddl_Emergency').html('<option>Increase Complex load at Maximum Step Change</option><option>Decrease Complex load at Maximum Step Change</option>');
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                            if ($('#ddlDT').val() == 'Desync') {
                                Visible_DI_Elements_Sync();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').show();
                                $('#tr_IDL').show();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLLATCAT2').show();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').show();
                                $('#tr_IDLALAT').show();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();
                            }

                            if ($('#ddlDT').val() == 'Increase/Decrease Load') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();
                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_Current_Load').hide();
                                $('#th_dCurrent_load').hide();
                                $('#td_NTDS').hide();
                                $('#th_ntds').hide();
                                $('#td_DesyncTime').hide();
                                $('#th_desync_time').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                        }



                        if (fd[0].DI_ID == '3') {

                            if ($('#ddlDT').val() == 'Sync') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').show();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WST').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WOST').hide();
                                $('#th_load_achievement_time_wst').hide();
                                $('#th_load_achievement_time_wost').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }
                            if ($('#ddlDT').val() == 'Miscellaneous') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#tr_ddlEmergency').show();
                                $('#ddl_Emergency').html('<option>Increase Complex load at Maximum possible Ramp Rate</option><option>Decrease Complex load at Maximum possible Ramp Rate</option><option>Increase Complex load at Maximum Step Change</option><option>Decrease Complex load at Maximum Step Change</option><option>Maintain System Frequency at 50 Hz</option>');
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                            if ($('#ddlDT').val() == 'Desync') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').show();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                            if ($('#ddlDT').val() == 'Increase/Decrease Load') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').show();
                                $('#tr_IDLLA').show();
                                $('#tr_IDLLAT').show();
                                $('#tr_IDLCL').show();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').show();
                                $('#td_Current_Load').hide();
                                $('#th_dCurrent_load').hide();
                                $('#td_NTDS').hide();
                                $('#th_ntds').hide();
                                $('#td_DesyncTime').hide();
                                $('#th_desync_time').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').show();
                                $('#tr_IDLALAT').show();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }


                        }
                        if (fd[0].DI_ID == '4') {
                            //$('#ddlDT').append('<option value="option1">Increase/Decrease Load</option>');

                            if ($('#ddlDT').val() == 'Sync') {

                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').show();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_txt_present_State').hide();
                                $('#th_present_state').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WST').hide();
                                $('#td_txt_Load_Achieve_Date_Time_WOST').hide();
                                $('#th_load_achievement_time_wst').hide();
                                $('#th_load_achievement_time_wost').hide();
                                $('#td_txt_Target_Demand').hide();
                                $('#th_target_demand').hide();
                                $('#td_txt_Load_Achieve').hide();
                                $('#th_calculated_time').hide();
                                $('#td_txt_NTS_Date_Time').hide();
                                $('#th_sync_time').hide();
                                $('#td_txt_NTS').hide();
                                $('#th_nts').hide();
                                $('#td_txt_Load_Achieve_Date_Time').hide();
                                $('#th_load_achievement_time').hide();
                                $('#message_Desync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').show();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();


                            }

                            if ($('#ddlDT').val() == 'Miscellaneous') {
                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();

                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#tr_ddlEmergency').show();
                                $('#ddl_Emergency').html('<option>Increase Complex load at Maximum possible Ramp Rate</option><option>Decrease Complex load at Maximum possible Ramp Rate</option><option>Increase Complex load at Maximum Step Change</option><option>Decrease Complex load at Maximum Step Change</option><option>Maintain System Frequency at 50 Hz</option>');
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                            if ($('#ddlDT').val() == 'Desync') {

                                Visible_DI_Elements_Sync();
                                $('#tr_IDLLATCAT2').hide();
                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').show();
                                $('#tr_IDL').hide();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').hide();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').hide();
                                $('#td_Current_Load').hide();
                                $('#th_dCurrent_load').hide();
                                $('#td_NTDS').hide();
                                $('#th_ntds').hide();
                                $('#td_DesyncTime').hide();
                                $('#th_desync_time').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_IDLDM').hide();
                                $('#tr_IDLALAT').hide();
                                $('#tr_message_Desync').show();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }

                            if ($('#ddlDT').val() == 'Increase/Decrease Load') {

                                Visible_DI_Elements_Sync();

                                $('#tr_IDLLATCAT2').hide();
                                $('#trDIF_SDDateTime').hide();
                                $('#trDIF_DDateTime').hide();
                                $('#tr_IDL').show();
                                $('#tr_IDLLA').hide();
                                $('#tr_IDLLAT').hide();
                                $('#tr_IDLCL').show();
                                $('#tr_IDLC').hide();
                                $('#tr_IDLOBU').show();
                                $('#td_Current_Load').hide();
                                $('#th_dCurrent_load').hide();
                                $('#td_NTDS').hide();
                                $('#th_ntds').hide();
                                $('#td_DesyncTime').hide();
                                $('#th_desync_time').hide();
                                $('#message_Desync').hide();
                                $('#message_Sync').hide();
                                $('#tr_ddlEmergency').hide();
                                $('#tr_message_Desync').hide();
                                $('#tr_message_Sync').hide();
                                $('#td_txt_Load_Achieve_Min').hide();
                                $('#th_load_achievement_min').hide();

                            }


                        }
                    }

                });

            }


            $('body').off('change', '#ddlDT');
            $('body').on('change', '#ddlDT', function (e) {
                $('#dt_SyncDesyncTime').val('');
                $('#txt_present_State').val('');
                $('#txt_NTS').val('');
                $('#txt_NTS_Date_Time').val('');
                $('#txt_Target_Demand').val('');
                $('#txt_Load_Achieve').val(''); 
                $('#txt_Load_Achieve_Date_Time').val('');
                $('#txt_DTarget_Demand').val('');
                $('#txt_DLoad_Achieve').val('');
                $('#txt_DLoad_Achieve_Date_Time').val('');
                $('#txtIDL_ONBAR_UNITS').val('');
                $('#txtIDL_CURRENTLOAD').val('');
                $('#txtIDL_targetDemand').val('');
                $('#txtIDL_LOAD_ACHIEVE').val('');
                $('#txtIDL_LOAD_ACHIEVE_TIME').val(''); 
                //$('#txt_NTDS_Date_Time').val('');

                LoaddllUnits();
                LoadSyncUnitsCountIDL();
                DT_Cosmetic_byDICat();


                //if ($('#ddlDT').val() == 'Sync') {
                //    $('#trDIF_SDDateTime').show();
                //    $('#trDIF_DDateTime').hide();
                //    $('#tr_IDL').hide();
                //    $('#tr_IDLLA').hide();
                //    $('#tr_IDLLAT').hide();
                //    $('#tr_IDLCL').hide();
                //    $('#tr_IDLC').hide();
                //    $('#tr_IDLOBU').hide();

                //}

                //if ($('#ddlDT').val() == 'Desync') {
                //    $('#trDIF_SDDateTime').hide();
                //    $('#trDIF_DDateTime').show();
                //    $('#tr_IDL').hide();
                //    $('#tr_IDLLA').hide();
                //    $('#tr_IDLLAT').hide();
                //    $('#tr_IDLCL').hide();
                //    $('#tr_IDLC').hide();
                //    $('#tr_IDLOBU').hide();

                //}

                //if ($('#ddlDT').val() == 'Increase/Decrease Load') {
                //    $('#tr_IDL').show();
                //    $('#tr_IDLLA').show();
                //    $('#tr_IDLLAT').show();
                //    $('#tr_IDLCL').show();
                //    $('#tr_IDLC').hide();
                //    $('#tr_IDLOBU').show();


                //    $('#trDIF_DDateTime').hide();
                //    $('#trDIF_SDDateTime').hide();
                //    $('#txtIDL_CURRENTLOAD').val('');
                //    $('#txtIDL_ONBAR_UNITS').val('');
                //    $('#txtIDL_targetDemand').val('');
                //    $('#txtIDL_LOAD_ACHIEVE').val('');
                //    $('#txtIDL_LOAD_ACHIEVE_TIME').val('');

                //}
                //if ($('#ddlDT').val() == 'Reduce Load') {
                //    $('#tr_IDL').show();
                //    $('#tr_IDLLA').show();
                //    $('#tr_IDLLAT').show();
                //    $('#tr_IDLCL').show();
                //    $('#tr_IDLC').show();

                //    $('#trDIF_DDateTime').hide();
                //    $('#trDIF_SDDateTime').hide();
                //    $('#txtIDL_CURRENTLOAD').val('');
                //    $('#txtIDL_targetDemand').val('');
                //    $('#txtIDL_LOAD_ACHIEVE').val('');
                //    $('#txtIDL_LOAD_ACHIEVE_TIME').val('');
                //    $('#tr_IDLOBU').hide();

                //}

            });

            //Start OF EDIT //
            var $status = "";
            var $demandType = "";
            function LoadFormByID() {
                debugger;
                var fromdata = new FormData();
                fromdata.append("vls", '16½' + $('#btnClose').attr('tg'));
                $.ajax({

                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);
                        console.log('EDIT RESPONSE: ' + fd[0]);
                        $status = fd[0].STATUS;
                        debugger;
                        CheckStatus();
                        console.log(fd[0]);

                        $('#ddlIPP_Cat').prop("disabled", true);
                        $('#ddlIPP').prop("disabled", true);
                        $('#ddlSite').prop("disabled", true);

                        // Present state radio buttons
                        //$('input:radio[name="rdDIF_DemandType"][value="' + rdtop + '"]').prop('checked', true);

                        $('#ddlIPP_Cat').val(fd[0].IPP_CAT);
                        $('#ddlIPP').html(fd[0].POWERPRODUCER);//done
                        $('#ddlSite').html(fd[0].VENDORSITE);//done

                        $('#Technical_limits').html(fd[0].FUEL);//done
                        $('#txtFuel').val(fd[0].FUEL);//done
                        $('#txtPowerPolicy').val(fd[0].POWER_POLICY);//done
                        $('#txtDIF_NotifyDateTime').val(fd[0].INTIMATION_TIME);//done
                        $('#ddlDT').val(fd[0].DEMAND_TYPE);//done
                        $('#ddl_Emergency option:selected').val(fd[0].Miscellaneous);
                        debugger;
                        //$('#ddl_Emergency option:selected').text(Miscellaneous);

                        DT_Cosmetic_byDICat();
                        $('#txtDIF_currentAvailability').val(fd[0].CURRENT_AVAILABILITY);//done
                        $('#txtIDL_targetDemand').val(fd[0].TARGET_DEMAND);
                        $('#txtIDL_CURRENTLOAD').val(fd[0].CURRENT_LOAD_IDLOAD);
                        $('#txtIDL_LOAD_ACHIEVE').val(fd[0].IDLOAD_ACHIEVE_MIN);
                        $('#txtIDL_LOAD_ACHIEVE_TIME').val(fd[0].TARGET_DATE_TIME);
                        $('#txtDIF_senderName').val(fd[0].SENDER_NAME);//done
                        $('#txtDIF_senderDesg').val(fd[0].SENDER_DESIGNATION);//done
                        $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').val(fd[0].TARGET_DATE_TIME);

                        $('#prevTxtAreaRemarks').val(fd[0].NPCC_REMARKS);
                        $('#prevTxtAreaRemarks').val(fd[0].NPCC_REMARKS);
                        if ($status == "Acknowledged") {
                            $('#txtDIF_AckBy').val(fd[0].GC_ACK_BY);
                            $('#txtDIF_AckDesignation').val(fd[0].GC_ACK_DESIGNATION);
                            $('#prevTxtAreaAcknowledgement').val(fd[0].GC_ACK_REMARKS);
                            $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').val(fd[0].TARGET_DATE_TIME);

                            //loadtblTechnicalLimits();
                        }
                        debugger;
                        if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                            $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                            $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                            $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                            $('#txtIDL_Actual_Load_Achievement_Time').val(fd[0].GC_COMP_ACHIEVE_DATE_TIME); 
                            $('#txtIDL_DEMAND_MEET').val(fd[0].GC_COMP_TARGET_ACHIEVED);
                            
                        }
                        

                        LoaddllBlockFuel();

                        var fromdata = new FormData();
                        fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                        $.ajax({
                            type: "POST",
                            url: "/NPCC/AjaxCall" + $(location).attr("search"),
                            data: fromdata,
                            contentType: false,
                            processData: false,
                            success: function (response) {

                                var ab = $.parseJSON(response);
                                if ($('#ddlDT').val() == 'Sync') {


                                    if (ab[0].DI_ID == '1') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {
                                                debugger;

                                                $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.HOURS_BW_EVENT_NOTIFICATION + '</td>\
                                        <td>'+ j.PRESENT_STATE + '</td>\
                                        <td>'+ j.NTS_HOURS + '</td>\
                                        <td class="t_a_time">'+ j.SYNC_DESYNC_TIME + '</td>\
                                        <td class="t_a_time">'+ j.TARGET_DEMAND + '</td>\
                                        <td>'+ j.LOAD_ACHIEVE_MINS + '</td>\
                                        <td class="t_a_time">'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td class="ippAck"><input  type="text" class="form-control ippCompVal t_a_time dtDateTime requiredFieldBGC" id="txt_IPPAAT"/></td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal" id="txt_IPPAAL"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv Xrmv" value=" X "></td></tr >');

                                        if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {

                                            $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                            $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                            $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                            $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED); 
                                            $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                            $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                            $('#txt_IPPAAT').prop("disabled", true);
                                            $('#txt_IPPAAL').prop("disabled", true);
                                            $('#txt_IPPST').prop("disabled", true);

                                            }                                      

                                            });
                                        
                                        }
                                        
                                    }

                                    if (ab[0].DI_ID == '2') {

                                            var dtl = fd[0].DTL;
                                            if (dtl != null) {
                                                dtl = $.parseJSON(dtl);
                                                $.each(dtl, function (i, j) {
                                        if (j.BLOCK_NAME != 'Complex') {
                                                    $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.HOURS_BW_EVENT_NOTIFICATION + '</td>\
                                        <td>'+ j.PRESENT_STATE + '</td>\
                                        <td> '+ j.LOAD_ACHIEVE_MINS + '</td>\
                                        <td >'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                            $('#th_actual_load_achievement_time_ipp').hide();
                                            $('#th_actual_achieved_load_ipp').hide();

                                            if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                                                $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                $('#txt_IPPAAT').prop("disabled", true);
                                                $('#txt_IPPAAL').prop("disabled", true);
                                            }
                                            CheckStatus();

                                        }
                                                });
                                            }



                                var dtl = fd[0].DTL;
                                if (dtl != null) {
                                    dtl = $.parseJSON(dtl);
                                    $.each(dtl, function (i, j) {
                                        if (j.BLOCK_NAME == 'Complex') {

                                            $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.HOURS_BW_EVENT_NOTIFICATION + '</td>\
                                        <td>'+ j.PRESENT_STATE + '</td>\
                                        <td> '+ j.LOAD_ACHIEVE_MIN_WST + '</td>\
                                        <td> '+ j.LOAD_ACHIEVE_TIME_WST + '</td>\
                                        <td> '+ j.LOAD_ACHIEVE_TIME_WOST + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                            if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                                                $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                $('#txt_IPPAAT').prop("disabled", true);
                                                $('#txt_IPPAAL').prop("disabled", true);
                                            }
                                        }
                                                });
                                            } 
                                    }
                                     

                                    if (ab[0].DI_ID == '3') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {
                                        $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.HOURS_BW_EVENT_NOTIFICATION + '</td>\
                                        <td>'+ j.PRESENT_STATE + '</td>\
                                        <td>'+ j.NTS_HOURS + '</td>\
                                        <td class="t_a_time">'+ j.SYNC_DESYNC_TIME + '</td>\
                                        <td class="t_a_time">'+ j.TARGET_DEMAND + '</td>\
                                        <td>'+ j.LOAD_ACHIEVE_MINS + '</td>\
                                        <td class="t_a_time">'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td  class="ippAck"><input  type="text" class="form-control ippCompVal t_a_time  dtDateTime requiredFieldBGC" id="txt_IPPAAT"/></td>\
                                        <td  class="ippAck"><input  type="text" class="form-control ippCompVal  t_a_time " id="txt_IPPAAL"/></td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);
                                                    debugger;
                                                }
                                            });
                                        }

                                    }

                                    if (ab[0].DI_ID == '4') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {

                                        $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.HOURS_BW_EVENT_NOTIFICATION + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');

                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);
                                                    debugger;

                                                }
                                            });
                                        }

                                    }
                                }
                                if ($('#ddlDT').val() == 'Desync') {
                                    debugger;

                                    if (ab[0].DI_ID == '1') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {
                                                debugger;
                                            $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.TARGET_DEMAND + '</td>\
                                        <td>'+ j.NTDS_HOURS + '</td>\
                                        <td class="t_a_time">'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                                debugger;
                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {

                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);
                                                    debugger;


                                                }
                                            });
                                        }

                                    }
                                    if (ab[0].DI_ID == '2') {
                                        debugger;

                                        var dtl = fd[0].DTL;

                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            debugger;
                                            $.each(dtl, function (i, j) {

                                            $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.TARGET_DEMAND + '</td>\
                                        <td>'+ j.NTDS_HOURS + '</td>\
                                        <td class="t_a_time">'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                                debugger;

                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {
                                             
                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);

                                                }
                                            });
                                        }

                                    }
                                    if (ab[0].DI_ID == '3') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {

                                            $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td>'+ j.TARGET_DEMAND + '</td>\
                                        <td>'+ j.NTDS_HOURS + '</td>\
                                        <td class="t_a_time">'+ j.LOAD_ACHIEVE_TIME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {

                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);
                                                    debugger;

                                                }
                                            });
                                        }

                                    }
                                    if (ab[0].DI_ID == '4') {
                                        var dtl = fd[0].DTL;
                                        if (dtl != null) {
                                            dtl = $.parseJSON(dtl);
                                            $.each(dtl, function (i, j) {

                                            $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ j.BLOCK_ID + '">' + j.BLOCK_NAME + '</td>\
                                        <td class="ippAck"><input  type="text" class="form-control t_a_time ippCompVal dtDateTime requiredFieldBGC" id="txt_IPPST"/></td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                           
                                                if ($status == "Compliance" || $status == "Partial Compliance" || $status == "Full Compliance") {

                                                    $('#txtDIF_Update').val(fd[0].GC_COMP_BY);
                                                    $('#txtDIF_UpdateDesignation').val(fd[0].GC_COMP_DESIGNATION);
                                                    $('#prevTxtUpdate').val(fd[0].GC_COMP_REMARKS);
                                                    $('#txt_IPPAAL').val(j.GC_COMP_TARGET_ACHIEVED);
                                                    $('#txt_IPPAAT').val(j.GC_COMP_ACHIEVE_DATE_TIME);
                                                    $('#txt_IPPST').val(j.GC_COMP_DESYNC_SYNC_DATE_TIME);
                                                    $('#txt_IPPAAT').prop("disabled", true);
                                                    $('#txt_IPPAAL').prop("disabled", true);
                                                    $('#txt_IPPST').prop("disabled", true);
                                                    debugger;

                                                }
                                            });
                                        }

                                    }
                                }
                                if ($('#ddlDT').val() == 'Increase/Decrease Load') {

                                    LoaddllBlockFuel();

                                }

                                CheckStatus();
                            }
                        });

                                               
                    }//END OF SUCC

                });
                //debugger;

            }

            $('body').off('click', '#btnDIF_update');
            $('body').on('click', '#btnDIF_update', function (event) {
                event.preventDefault();
                removeComma();
                var isTrue = validations();
                var IsVerified = $('#txtDIF_SystemConstraint').val();

                //debugger;
                if (!isTrue) {
                    return false;
                }
                var NotificationStatus = $(this).val();
                if (NotificationStatus == "Achieved" && $.trim($('#txtDIF_UpdateAchievementTime').val()) == "") {
                    alert('Select Valid date...');
                    return false;
                }

                var $Status = '300½' + $('#btnClose').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + 0 + '½' + IsVerified;
                $('.frm').each(function () {
                    $Status += '½' + $(this).val();
                });

                $Status += '½' + $('#ddl_Unit').val();
                $Status += '½' + $('#txt_Target_Demand').val();
                $Status += '½' + $('#txt_Load_Achieve_Date_Time').val();

                //FOR SYNC
                $Status += '½' + $('#prevTxtAreaRemarks').val();
                $Status += '½' + $('#ddlDT').val();
                $Status += '½' + $('#txt_present_State').val();


                //FOR DESYNC
                $Status += '½' + $('#Dddl_Unit').val();
                $Status += '½' + $('#txt_DTarget_Demand').val();
                $Status += '½' + $('#txt_DLoad_Achieve').val();
                $Status += '½' + $('#txt_DLoad_Achieve_Date_Time').val();

                //FOR IDL
                $Status += '½' + $('#txtIDL_CURRENTLOAD').val();
                $Status += '½' + $('#txtIDL_targetDemand').val();
                $Status += '½' + $('#txtIDL_LOAD_ACHIEVE').val();
                $Status += '½' + $('#txtIDL_LOAD_ACHIEVE_TIME').val();
                $Status += '½' + $('#ddl_Emergency').val();
                $Status += '½' + $('#ddlIPP_Cat').val();



                // added for Present State

                if (NotificationStatus == "Acknowledged") {

                    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    /* swal({
                           title: ""+NotificationStatus+" Confirmation",
                           text: "Do you want to " + NotificationStatus +" this despatch instruction?",
                           type: "warning",
                           showCancelButton: true,
                           confirmButtonClass: "btn btn-danger",
                           confirmButtonText: "Continue"
                        }).then((response) => {


                        if (parseInt(response) > 0) {
                           swal({
                               title: "" + NotificationStatus + " Confirmation",
                               text: "This despatch instruction is " + NotificationStatus + "!",
                               type: "success",
                               showCancelButton: false,
                               showConfirmButton: false

                           });
                        }
                        else {
                           swal.close();
                        }; */
                    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

                    $Status += '½' + $('#txtDIF_AckBy').attr('value') + '½' + $('#txtDIF_AckDesignation').attr('value') + '½' + $('#prevTxtAreaAcknowledgement').val();
                }
                //debugger;

                //sync Cat Save scenarios
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '1')) {

                            var nxt = "";
                            var catg = "1";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' +
                                    $($(this).find('td')[5]).html() + '½' + $($(this).find('td')[6]).html() + '½' + $($(this).find('td')[7]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '2') && ($('#ddl_Unit option:selected').text() != 'Complex')) {

                            var nxt = "";
                            var catg = "2";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '2') && ($('#ddl_Unit option:selected').text() == 'Complex')) {

                            var nxt = "";
                            var catg = "2";
                            var comp = "1";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' + $($(this).find('td')[5]).html() + '¼';
                            });



                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '3')) {

                            var nxt = "";
                            var catg = "3";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' +
                                    $($(this).find('td')[5]).html() + '½' + $($(this).find('td')[6]).html() + '½' + $($(this).find('td')[7]).html() + '¼';
                            });


                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }


                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '4')) {

                            var nxt = "";
                            var catg = "4";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '¼';
                            });



                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }


                        if ((($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '1')) || (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '2')) || (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '3'))) {

                            var nxt = "";
                            var catg = "1";
                            var comp = "";

                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '4')) {

                            var nxt = "";
                            var catg = "4";
                            var comp = "";

                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"

                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });
                        }


                        if (($('#ddlDT').val() == 'Increase/Decrease Load') || ($('#ddlDT').val() == 'Reduce Load')) {
                            var nxt = "";
                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                            });
                            console.log(nxt)
                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            //fromdata.append("nxt", nxt);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"
                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });


                        }//END OF Desync

                        if ($('#ddlDT').val() == 'Miscellaneous') {
                            var nxt = "";
                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                            });
                            console.log(nxt)
                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            //fromdata.append("nxt", nxt);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction!",
                                        text: "Despatch Instruction no " + response + " has been " + NotificationStatus + " successfully.",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"
                                    });

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();

                                        }
                                    });

                                }//END OF SUCC
                            });


                        }//END OF Desync


                    }

                });
                //ajax call end
            });
            // Acknowledge End
            // End OF SUBMIT





            $('body').off('click', '.btnAction');
            $('body').on('click', '.btnAction', function (e) {
                e.preventDefault();
                removeComma();
                var isTrue = validations();
                var IsVerified = $('#txtDIF_SystemConstraint').val();

                //debugger;
                if (!isTrue) {
                    return false;
                }
                var NotificationStatus = $(this).val();
                if (NotificationStatus == "Achieved" && $.trim($('#txtDIF_UpdateAchievementTime').val()) == "") {
                    alert('Select Valid date...');
                    return false;
                }
                var $Status = '3½' + $('#btnClose').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + $('#ddlBlock').val().split('½')[0] + '½' + IsVerified;
                $('.frm').each(function () {
                    $Status += '½' + $(this).val();
                });

                //$Status += '½' + $('.rdtop:checked').val();
                //$Status += '½' + $('.rdAch:checked').val();


                $Status += '½' + $('#ddl_Unit').val();
                $Status += '½' + $('#txt_Target_Demand').val();
                $Status += '½' + $('#txt_Load_Achieve_Date_Time').val();

                //FOR SYNC
                $Status += '½' + $('#prevTxtAreaRemarks').val();
                $Status += '½' + $('#ddlDT').val();
                $Status += '½' + $('#txt_present_State').val();


                //FOR DESYNC
                $Status += '½' + $('#Dddl_Unit').val();
                $Status += '½' + $('#txt_DTarget_Demand').val();
                $Status += '½' + $('#txt_DLoad_Achieve').val();
                $Status += '½' + $('#txt_DLoad_Achieve_Date_Time').val();

                //FOR IDL
                $Status += '½' + $('#txtIDL_CURRENTLOAD').val();
                $Status += '½' + $('#txtIDL_targetDemand').val();
                $Status += '½' + $('#txtIDL_LOAD_ACHIEVE').val();
                $Status += '½' + $('#txtIDL_LOAD_ACHIEVE_TIME').val();
                $Status += '½' + $('#ddl_Emergency').val();
                $Status += '½' + $('#ddlIPP_Cat').val();
                $Status += '½' + $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').val();

                //$Status += '½' + $('#ddl_Unit option:selected').text();



                // added for Present State

                if (NotificationStatus == "Acknowledged") {

                    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                    /* swal({
                           title: ""+NotificationStatus+" Confirmation",
                           text: "Do you want to " + NotificationStatus +" this despatch instruction?",
                           type: "warning",
                           showCancelButton: true,
                           confirmButtonClass: "btn btn-danger",
                           confirmButtonText: "Continue"
                        }).then((response) => {


                        if (parseInt(response) > 0) {
                           swal({
                               title: "" + NotificationStatus + " Confirmation",
                               text: "This despatch instruction is " + NotificationStatus + "!",
                               type: "success",
                               showCancelButton: false,
                               showConfirmButton: false

                           });
                        }
                        else {
                           swal.close();
                        }; */
                    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

                    $Status += '½' + $('#txtDIF_AckBy').attr('value') + '½' + $('#txtDIF_AckDesignation').attr('value') + '½' + $('#prevTxtAreaAcknowledgement').val();
                }
                //debugger;

                //sync Cat Save scenarios
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);



                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '1')) {

                            var nxt = "";
                            var nxt = "";
                            var catg = "1";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html()  + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' +
                                    $($(this).find('td')[5]).html() + '½' + $($(this).find('td')[6]).html() + '½' + $($(this).find('td')[7]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '2') && ($('#ddl_Unit option:selected').text() != 'Complex') ) {

                            var nxt = "";
                            var catg = "2";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '2') && ($('#ddl_Unit option:selected').text() == 'Complex')) {

                            var nxt = "";
                            var catg = "2";
                            var comp = "1";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' + $($(this).find('td')[5]).html() + '¼';
                            });



                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '3') ) {

                            var nxt = "";
                            var catg = "3";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' +
                                    $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '½' + $($(this).find('td')[4]).html() + '½' +
                                    $($(this).find('td')[5]).html() + '½' + $($(this).find('td')[6]).html() + '½' + $($(this).find('td')[7]).html() + '¼';
                            });


                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }


                        if (($('#ddlDT').val() == 'Sync') && (fd[0].DI_ID == '4')) {

                            var nxt = "";
                            var catg = "4";
                            var comp = "";

                            $('#tblMultircd tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '¼';
                            });



                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }


                        if ((($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '1')) || (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '2')) || (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '3'))) {

                            var nxt = "";
                            var catg = "1";
                            var comp = "";

                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });

                        }

                        if (($('#ddlDT').val() == 'Desync') && (fd[0].DI_ID == '4')) {

                            var nxt = "";
                            var catg = "4";
                            var comp = "";

                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '¼';
                            });

                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            fromdata.append("nxt", nxt);
                            fromdata.append("catg", catg);
                            fromdata.append("comp", comp);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });
                        }


                if (($('#ddlDT').val() == 'Increase/Decrease Load') || ($('#ddlDT').val() == 'Reduce Load')) {
                    var nxt = "";
                    $('#tblMultircdD tbody tr').each(function () {
                        nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                    });
                    console.log(nxt)
                    var fromdata = new FormData();
                    fromdata.append("vls", $Status);
                    //fromdata.append("nxt", nxt);

                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            var options = {};
                            $("#pageContainer").hide('slide', options, 300);
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                success: function (result) {
                                    var options = {};
                                    $('#pageContainer').html($(result).find('#pcontent').html());
                                    $("#pageContainer").show('slide', options, 500);
                                }
                            });

                        }//END OF SUCC
                    });


                        }//END OF Desync

                        if ($('#ddlDT').val() == 'Miscellaneous') {
                            var nxt = "";
                            $('#tblMultircdD tbody tr').each(function () {
                                nxt += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($(this).find('td')[3]).html() + '¼';
                            });
                            console.log(nxt)
                            var fromdata = new FormData();
                            fromdata.append("vls", $Status);
                            //fromdata.append("nxt", nxt);

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (result) {
                                            var options = {};
                                            $('#pageContainer').html($(result).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                        }
                                    });

                                }//END OF SUCC
                            });


                        }//END OF Desync

                    }
                });

            });



            $('body').off('click', '#btnDIF_Ack');
            $('body').on('click', '#btnDIF_Ack', function (event) {
                event.preventDefault();
                removeComma();


                var isTrue = validations();
                //var IsVerified = $('.chkVerifyAck').val();
                var FormAckStatus = $(this).val();

                if (!isTrue) {
                    return false;
                }
                var $Status = '117½' + $('#btnClose').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + $('#txtDIF_AckBy').val() + '½' + $('#txtDIF_AckDesignation').val() + '½' + $('#prevTxtAreaAcknowledgement').val();

                console.log($Status);

                // ajax call start

                var formdata = new FormData();
                formdata.append("vls", $Status);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: formdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        swal({
                            title: "Despatch Instruction!",
                            text: "Despatch Instruction no " + response + " has been " + FormAckStatus + " successfully.",
                            type: "success",
                            showCancelButton: false,
                            confirmButtonClass: "btn btn-danger",
                            confirmButtonText: "OK"

                        });

                        var options = {};
                        $("#pageContainer").hide('slide', options, 300);
                        $.ajax({
                            url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                            success: function (response) {
                                var options = {};
                                $('#pageContainer').html($(response).find('#pcontent').html());
                                $("#pageContainer").show('slide', options, 500);
                            }
                        });

                    }

                });
                //ajax call end
            });
            // Acknowledge End
            // End OF SUBMIT
            var DI_CAT;
            function GET_DI_CAT() {
                
                var fmdata = new FormData();
                fmdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fmdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        fd = $.parseJSON(response);
                        DI_CAT = fd[0].DI_ID;
                        alert(fd);
                    }

                });


            }

            $('body').off('click', '#btnDIF_Cmp');
            $('body').on('click', '#btnDIF_Cmp', function (event) {
                event.preventDefault();
                removeComma();

                var isTrue = validations();
                var FormAckStatus = $(this).val();

                if (!isTrue) {
                    return false;
                }
                debugger;

                if (($('#ddlDT').val() == 'Sync')) {  

                    // for Event Generation on backend..
                    
                    var nxt = "";
                    $('#tblMultircd tbody tr').each(function (){
                        debugger;
                        nxt += $($(this).find('td')[0]).attr('tg').split('½')[0];
                        debugger;

                        $($(this).find('td .ippCompVal')).each(function () {
                            //nxt += '½' + $($('#tblMultircd tbody tr').find('td')).attr('.ippCompVal');
                            nxt += '½' + $(this).val();
                            debugger;

                        });
                        debugger;

                        nxt += '¼';

                    });

                    debugger;

                    var $Status = '119½' + $('#btnClose').attr('tg').split('½')[0] + '½' + FormAckStatus + '½' + $('#ddlDT').val();
                    $('.ippComp').each(function () {
                        $Status += '½' + $(this).val();
                    });

                    console.log($Status);

                    //var formdata = new FormData();
                    //formdata.append("vls", $Status);
                    //formdata.append("nxt", nxt);
                    //debugger;
                    //// ajax call start

                    //$.ajax({
                    //    type: "POST",
                    //    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    //    data: formdata,
                    //    contentType: false,
                    //    processData: false,
                    //    success: function (response) {

                          
                    var fmdata = new FormData();
                    fmdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fmdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            fd = $.parseJSON(response);
                     
                            debugger;

                    if ((fd[0].DI_ID == '2') || (fd[0].DI_ID == '4')) {
                        debugger;
                        if (fd[0].DI_ID == '2') {
                            debugger;
                            debugger
                            $('#tblMultircd tbody tr').each(function () {
                                debugger;
                                var evt = "";

                                debugger
                                $($(this).find('.t_a_time')).each(function () {
                                    evt += $(this).val() + '½';

                                });

                            var UnitId=  $($(this).find('td')[0]).attr('tg').split('½')[0];
                            var Unitname = $($(this).find('td')[0]).html();
                            var actual_sync_time = evt.split('½')[0];

                                var target_load = $('#txtIDL_targetDemand').val();
                            var target_achievement_time = $('#txtIDL_LOAD_ACHIEVE_TIME_CAT2').val();
                            var actual_demand_meet = $('#txtIDL_DEMAND_MEET').val(); 
                            var actual_demand_meet_time = $('#txtIDL_Actual_Load_Achievement_Time').val();
                            var targetPercent;
                            var perLessTarget_load;
                            var perGreaterTarget_load;
                            target_load = parseInt(target_load);
                            targetPercent = parseInt(targetPercent);
                            targetPercent = (target_load / 100) * 3;
                            debugger;
                            var perLessTarget_load = target_load - targetPercent; 
                            var perGreaterTarget_load = target_load + targetPercent;
                                perLessTarget_load = Math.round(perLessTarget_load);
                                perGreaterTarget_load = Math.round(perGreaterTarget_load);

                            debugger;
                                var $StatusEvent = '123½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + UnitId + '½' + Unitname + '½' + 'Sync' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + actual_sync_time + '½' + target_achievement_time + '½' + target_achievement_time + '½' + target_achievement_time  + '½' + target_achievement_time + '½' + actual_demand_meet_time + '½' + actual_demand_meet + '½' + perLessTarget_load + '½' + perGreaterTarget_load;
                                debugger;
                                $StatusEvent += '½' + $Status;

                            debugger;
                            var frmdata = new FormData();
                                frmdata.append("vls", $StatusEvent);
                                frmdata.append("nxt", nxt);                              

                                // ajax call start

                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: frmdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {

                                        swal({
                                            title: "Despatch Instruction Event Generated!",
                                            text: "Despatch Instruction has been Submitted For " + response + " successfully..",
                                            type: "success",
                                            showCancelButton: false,
                                            confirmButtonClass: "btn btn-danger",
                                            confirmButtonText: "OK"
                                        });
                                        var options = {};
                                        $("#pageContainer").hide('slide', options, 300);
                                        $.ajax({
                                            url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                            success: function (response) {
                                                var options = {};
                                                $('#pageContainer').html($(response).find('#pcontent').html());
                                                $("#pageContainer").show('slide', options, 500);
                                                swal.close();
                                            }
                                        });
                                    }
                                });
                            });
                            
                        }
                        if (fd[0].DI_ID == '4') {

                            debugger;
                            debugger
                            $('#tblMultircd tbody tr').each(function () {
                                debugger;
                                var evt = "";

                                debugger
                                $($(this).find('.t_a_time')).each(function () {
                                    evt += $(this).val() + '½';

                                });
                                var UnitId = $($(this).find('td')[0]).attr('tg').split('½')[0];
                                var Unitname = $($(this).find('td')[0]).html();

                                var UnitId = $($(this).find('td')[0]).attr('tg').split('½')[0];
                                var Unitname = $($(this).find('td')[0]).html();
                                var actual_sync_time = evt.split('½')[0];

                            var $StatusEvent = '121½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + UnitId + '½' + Unitname + '½' + 'Sync' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + actual_sync_time ;
                                debugger;
                                $StatusEvent += '½' + $Status;


                                var frmdata = new FormData();
                                frmdata.append("vls", $StatusEvent);
                                frmdata.append("nxt", nxt);                              

                            // ajax call start

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: frmdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction Event Generated!",
                                        text: "Despatch Instruction has been Submitted For " + response + " successfully..",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"
                                    });
                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (response) {
                                            var options = {};
                                            $('#pageContainer').html($(response).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();
                                        }
                                    });
                                }
                            });
                            });
                        }  
                    
                    }

                    else {

                        debugger
                        $('#tblMultircd tbody tr').each(function () {
                            var evt = "";

                            debugger;
                            $($(this).find('.t_a_time')).each(function () {

                                evt += $(this).html() + '½';
                                evt += $(this).val() + '½';

                                debugger;

                            });

                            //$('.t_a_time').each(function () {
                            //    evt += $(this).html() + '½';
                            //    evt += $(this).val() + '½';

                            //});

                            debugger;
                            var target_achievement_time = evt.split('½')[4];
                            var actual_demand_meet_time = evt.split('½')[9];
                            var target_load = evt.split('½')[2];
                            var actual_demand_meet = evt.split('½')[11];
                            var target_sync_time = evt.split('½')[0];
                            var actual_sync_time = evt.split('½')[7];
                            debugger;
                            var targetPercent; 
                            var perLessTarget_load;
                            var perGreaterTarget_load;
                            target_load = parseInt(target_load);
                            targetPercent = parseInt(targetPercent);
                            targetPercent = (target_load / 100) * 3;
                            debugger;
                            perLessTarget_load = target_load - targetPercent;
                            perGreaterTarget_load = target_load + targetPercent;
                            perLessTarget_load = Math.round(perLessTarget_load);
                            perGreaterTarget_load = Math.round(perGreaterTarget_load);
                            debugger;

                            var $StatusEvent = '120½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + 'Sync' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + actual_sync_time + '½' + target_sync_time + '½' + target_sync_time + '½' + actual_sync_time + '½' + target_achievement_time + '½' + actual_demand_meet_time + '½' + actual_demand_meet + '½' + perLessTarget_load + '½' + perGreaterTarget_load;
                            debugger;
                            $StatusEvent += '½' + $Status;
                            debugger;
                                var fromdata = new FormData();
                            fromdata.append("vls", $StatusEvent);
                            fromdata.append("nxt", nxt);

                                // ajax call start

                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {

                                        swal({
                                            title: "Despatch Instruction Event Generated!",
                                            text: "Despatch Instruction has been Submitted For "+ response +" successfully..",
                                            type: "success",
                                            showCancelButton: false,
                                            confirmButtonClass: "btn btn-danger",
                                            confirmButtonText: "OK"
                                        });
                                        //var options = {};
                                        //$("#pageContainer").hide('slide', options, 300);
                                        //$.ajax({
                                        //    url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        //    success: function (response) {
                                        //        var options = {};
                                        //        $('#pageContainer').html($(response).find('#pcontent').html());
                                        //        $("#pageContainer").show('slide', options, 500);
                                        //        swal.close();
                                        //    }
                                        //});
                                       
                                    }
                                });
                                          
                            });

                            }
                          
                        }

                    });                          
                                      
                }


                if (($('#ddlDT').val() == 'Desync')) {

                    $('#tblMultircdD tbody tr').each(function () {
                        var nxt = "";

                        nxt = $($(this).find('td')[0]).attr('tg').split('½')[0];

                        $($(this).find('td .ippCompVal')).each(function () {
                        //$('.ippCompVal').each(function () {
                            nxt += '½' + $(this).val();

                        });
                        nxt += '¼';

                    });
                     

                    var $Status = '119½' + $('#btnClose').attr('tg').split('½')[0] + '½' + FormAckStatus + '½' + $('#ddlDT').val();
                    $('.ippComp').each(function () {
                        $Status += '½' + $(this).val();
                    });

                    console.log($Status);

                    //var formdata = new FormData();
                    //formdata.append("vls", $Status);
                    //formdata.append("nxt", nxt);
                    //debugger;
                    //// ajax call start

                    //$.ajax({
                    //    type: "POST",
                    //    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    //    data: formdata,
                    //    contentType: false,
                    //    processData: false,
                    //    success: function (response) {
                   

                    var fmdata = new FormData();
                    fmdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fmdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            fd = $.parseJSON(response);

                            debugger;


                    if (fd[0].DI_ID == '4') {

                        debugger
                        $('#tblMultircdD tbody tr').each(function () {
                            debugger;
                            debugger
                            var evt = "";

                            $($(this).find('.t_a_time')).each(function () {
                                evt += $(this).val() + '½';

                            });
                            debugger;
                            var UnitId = $($(this).find('td')[0]).attr('tg').split('½')[0];
                            var Unitname = $($(this).find('td')[0]).html();
                            var actual_sync_time = evt.split('½')[0];
                            debugger;
                            var $StatusEvent = '121½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + UnitId + '½' + Unitname + '½' + 'Desync' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + actual_sync_time;
                            debugger;
                            $StatusEvent += '½' + $Status;
                            var frmdata = new FormData();
                            frmdata.append("vls", $StatusEvent);
                            frmdata.append("nxt", nxt);

                            // ajax call start

                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: frmdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction Event Generated!",
                                        text: "Despatch Instruction has been Submitted For "+ response +" successfully..",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"
                                    });
                                    var options = {};
                                    $("#pageContainer").hide('slide', options, 300);
                                    $.ajax({
                                        url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                        success: function (response) {
                                            var options = {};
                                            $('#pageContainer').html($(response).find('#pcontent').html());
                                            $("#pageContainer").show('slide', options, 500);
                                            swal.close();
                                        }
                                    });
                                }
                            });
                        });
                    }


                    else {

                        debugger;
                        $('#tblMultircdD tbody tr').each(function () {
                            debugger;
                            var evt = "";

                            $($(this).find('.t_a_time')).each(function () {
                              
                                evt += $(this).html() + '½';
                                evt += $(this).val() + '½';
                               
                            });
                            debugger;
                            var target_achievement_time = evt.split('½')[0];
                            var actual_demand_meet_time = evt.split('½')[3];
                        
                            debugger;

                            var $StatusEvent = '124½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + '½' + 'Desync' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + actual_demand_meet_time + '½' + target_achievement_time;
                            debugger;
                            $StatusEvent += '½' + $Status;

                            debugger;


                                var frmdata = new FormData();
                            frmdata.append("vls", $StatusEvent);
                            frmdata.append("nxt", nxt);

                                // ajax call start

                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: frmdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {

                                        swal({
                                            title: "Despatch Instruction Event Generated!",
                                            text: "Despatch Instruction has been Submitted For "+ response +" successfully..",
                                            type: "success",
                                            showCancelButton: false,
                                            confirmButtonClass: "btn btn-danger",
                                            confirmButtonText: "OK"
                                        });

                                        var options = {};
                                        $("#pageContainer").hide('slide', options, 300);
                                        $.ajax({
                                            url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                            success: function (response) {
                                                var options = {};
                                                $('#pageContainer').html($(response).find('#pcontent').html());
                                                $("#pageContainer").show('slide', options, 500);
                                                swal.close();
                                            }
                                        });
                                    }
                                });                            

                        });

                            }

                        }
                    });
                    //    }
                    //});
                }


                if ($('#ddlDT').val() == 'Increase/Decrease Load') {


                    var $Status = '119½' + $('#btnClose').attr('tg').split('½')[0] + '½' + FormAckStatus + '½' + $('#ddlDT').val();
                    $('.IppID').each(function () {
                        $Status += '½' + $(this).val();
                    });
                    debugger;
                    $('.ippComp').each(function () {
                        $Status += '½' + $(this).val();
                    });
                    debugger;



                    //var fromdata = new FormData();
                    //fromdata.append("vls", $Status);

                    //$.ajax({
                    //    type: "POST",
                    //    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    //    data: fromdata,
                    //    contentType: false,
                    //    processData: false,
                    //    success: function (response) {

                    //        swal({
                    //            title: "Despatch Instruction!",
                    //            text: "Despatch Instruction no " + response + " has been " + FormAckStatus + " successfully.",
                    //            type: "success",
                    //            showCancelButton: true,
                    //            showConfirmButton: false

                    //        });

                    //    }//END OF SUCC
                    //});

                    var fmdata = new FormData();
                    fmdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fmdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            fd = $.parseJSON(response);

                            debugger;

                            if (fd[0].DI_ID == '4') {
                                var target_load = $('#txtIDL_targetDemand').val();
                                var actual_demand_meet = $('#txtIDL_DEMAND_MEET').val();
                                var actual_demand_meet_time = $('#txtIDL_Actual_Load_Achievement_Time').val();
                                var targetPercent;
                                var perLessTarget_load;
                                var perGreaterTarget_load;
                                target_load = parseInt(target_load);
                                targetPercent = parseInt(targetPercent);
                                targetPercent = (target_load / 100) * 3;
                                
                                var perLessTarget_load = target_load - targetPercent;
                                var perGreaterTarget_load = target_load + targetPercent;
                                perLessTarget_load = Math.round(perLessTarget_load);
                                perGreaterTarget_load = Math.round(perGreaterTarget_load);

                                var $StatusEvent = '126½' + 'Full Compliance' + '½' + $('#btnClose').attr('tg').split('½')[0] + '½' + target_load + '½' + actual_demand_meet_time + '½' + perLessTarget_load + '½' + perGreaterTarget_load;
                        $StatusEvent += '½' + $Status;

                        var frmdata = new FormData();
                        frmdata.append("vls", $StatusEvent);
                        // ajax call start

                        $.ajax({
                            type: "POST",
                            url: "/NPCC/AjaxCall" + $(location).attr("search"),
                            data: frmdata,
                            contentType: false,
                            processData: false,
                            success: function (response) {

                                swal({
                                    title: "Despatch Instruction Event Generated!",
                                    text: "Despatch Instruction has been Submitted For Full Compliance successfully..",
                                    type: "success",
                                    showCancelButton: false,
                                    confirmButtonClass: "btn btn-danger",
                                    confirmButtonText: "OK"
                                });
                                var options = {};
                                $("#pageContainer").hide('slide', options, 300);
                                $.ajax({
                                    url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                                    success: function (response) {
                                        var options = {};
                                        $('#pageContainer').html($(response).find('#pcontent').html());
                                        $("#pageContainer").show('slide', options, 500);
                                        swal.close();
                                    }
                                });
                            }
                        });
                    }

                    else {
                        debugger;

                        var target_load = $('#txtIDL_targetDemand').val();
                        var target_achievement_time = $('#txtIDL_LOAD_ACHIEVE_TIME').val();
                        var actual_demand_meet = $('#txtIDL_DEMAND_MEET').val();
                        var actual_demand_meet_time = $('#txtIDL_Actual_Load_Achievement_Time').val();
                        var targetPercent;
                        var perLessTarget_load;
                        var perGreaterTarget_load;
                        target_load = parseInt(target_load);
                        targetPercent = parseInt(targetPercent);
                        targetPercent = (target_load / 100) * 3;
                        var targetPercent;
                        target_load = parseInt(target_load);
                        targetPercent = parseInt(targetPercent);
                        targetPercent = (target_load / 100) * 3;

                        var perLessTarget_load = target_load - targetPercent;                        
                        var perGreaterTarget_load = target_load + targetPercent;
                        perLessTarget_load = Math.round(perLessTarget_load);
                        perGreaterTarget_load = Math.round(perGreaterTarget_load);

                        debugger;
                        var id = $('#btnClose').attr('tg').split('½')[0];


                        debugger;

                        var $StatusEvent = '125½' + 'Submitted' + '½' + $('#ddlIPP_Cat').val() + '½' + $('#ddlIPP').val() + '½' + $('#ddlIPP').text() + '½' + $('#ddlSite').val() + '½' + $('#ddlSite').text() + '½' + $('#txtFuel').val() + '½' + $('#ddlIDL_COMPLEX').val() + '½' + 'Complex' + '½' + 'Sync' + '½' + id + '½' + target_achievement_time + '½' + actual_demand_meet_time + '½' + actual_demand_meet + '½' + perLessTarget_load + '½' + perGreaterTarget_load;
                        debugger;
                        $StatusEvent += '½' + $Status;

                            var frmdata = new FormData();
                            frmdata.append("vls", $StatusEvent);
                            // ajax call start
                        debugger;
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: frmdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    swal({
                                        title: "Despatch Instruction Event Generated!",
                                        text: "Despatch Instruction has been Submitted For "+ response+" successfully..",
                                        type: "success",
                                        showCancelButton: false,
                                        confirmButtonClass: "btn btn-danger",
                                        confirmButtonText: "OK"
                                    });
                                }
                            });

                        
                            }
                        }

                    });
                }
                
            });




            $('body').off('click', '.clsRmv');
            $('body').on('click', '.clsRmv', function () {
                $(this).parent().parent().remove();
                //var abcd
                //$('#tblMultircd tbody tr').each(function () {
                //    abcd += $($(this).find('td')[0]).attr('tg').split('½')[0] + '½' + $($(this).find('td')[0]).html() + ;
                //});
                //abcd.

            });


            $('body').off('click', '#btn_AddRow');
            $('body').on('click', '#btn_AddRow', function () {

                if ($('#ddl_Unit').val() == null || $('#ddl_Unit').val() == undefined) {
                    alert("No unit selected....");
                    return false;
                }


                else {

                    var fromdata = new FormData();
                    fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            var fd = $.parseJSON(response);


                            if (fd[0].DI_ID == '1') {

                                if ($('#ddlDT').val() == 'Sync') {


                                    $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ $('#ddl_Unit').val() + '">' + $('#ddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#dt_SyncDesyncTime').val() + '</td>\
                                        <td>'+ $('#txt_present_State').val() + '</td>\
                                        <td>'+ $('#txt_NTS').val() + '</td>\
                                        <td>'+ $('#txt_NTS_Date_Time').val() + '</td>\
                                        <td>'+ $('#txt_Target_Demand').val() + '</td>\
                                        <td>'+ $('#txt_Load_Achieve').val() + '</td>\
                                        <td>'+ $('#txt_Load_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr >');

                                    if ($('#ddl_Unit').val() == null || $('#ddl_Unit').val() == undefined) {
                                        alert("No unit selected....");
                                        return false;
                                    }
                                    //$("#ddl_Unit option[value='" + $('#ddl_Unit').val() + "']").remove();
                                }
                            }



                            if (fd[0].DI_ID == '2') {

                                if ($('#ddlDT').val() == 'Sync') {
                                    if ($('#ddl_Unit option:selected').text() != 'Complex') {

                                        $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ $('#ddl_Unit').val() + '">' + $('#ddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#dt_SyncDesyncTime').val() + '</td>\
                                        <td>'+ $('#txt_present_State').val() + '</td>\
                                        <td> '+ $('#txt_Load_Achieve_Min').val() + '</td>\
                                        <td>'+ $('#txt_Load_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                    }

                                    else {
                                        $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ $('#ddl_Unit').val() + '">' + $('#ddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#dt_SyncDesyncTime').val() + '</td>\
                                        <td>'+ $('#txt_present_State').val() + '</td>\
                                        <td> '+ $('#txt_Load_Achieve_Min').val() + '</td>\
                                        <td> '+ $('#txt_Load_Achieve_Date_Time_WST').val() + '</td>\
                                        <td> '+ $('#txt_Load_Achieve_Date_Time_WOST').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');

                                    }
                                }

                            }

                            if (fd[0].DI_ID == '3') {
                                if ($('#ddlDT').val() == 'Sync') {

                                    $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ $('#ddl_Unit').val() + '">' + $('#ddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#dt_SyncDesyncTime').val() + '</td>\
                                        <td>'+ $('#txt_present_State').val() + '</td>\
                                        <td>'+ $('#txt_NTS').val() + '</td>\
                                        <td>'+ $('#txt_NTS_Date_Time').val() + '</td>\
                                        <td>'+ $('#txt_Target_Demand').val() + '</td>\
                                        <td>'+ $('#txt_Load_Achieve').val() + '</td>\
                                        <td>'+ $('#txt_Load_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                }


                                }


                            if (fd[0].DI_ID == '4') {

                                if ($('#ddlDT').val() == 'Sync') {

                                    $('#tblMultircd tbody').append('<tr>\
                                        <td tg="'+ $('#ddl_Unit').val() + '">' + $('#ddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#dt_SyncDesyncTime').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                    $("#ddl_Unit option[value='" + $('#ddl_Unit').val() + "']").remove();
                                }


                            }

                        }
                    });

                }

            });


            $('body').off('click', '#btn_DAddRow');
            $('body').on('click', '#btn_DAddRow', function () {

                if ($('#Dddl_Unit').val() == null || $('#Dddl_Unit').val() == undefined) {
                    alert("No unit selected....");
                    return false;
                }
                if ($('#Dddl_Unit option:selected').text() == "Complex" || $('#Dddl_Unit option:selected').text() == "Complex ()") {

                    alert("Only Units Can Be Selected")
                }
                else {
                    var fromdata = new FormData();
                    fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            var fd = $.parseJSON(response);

                            if (fd[0].DI_ID == '1') {
                                if ($('#ddlDT').val() == 'Desync') {
                                    $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ $('#Dddl_Unit').val() + '">' + $('#Dddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#txt_DTarget_Demand').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                }
                            }
                            if (fd[0].DI_ID == '2') {
                                if ($('#ddlDT').val() == 'Desync') {
                                    $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ $('#Dddl_Unit').val() + '">' + $('#Dddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#txt_DTarget_Demand').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                }
                            }
                            if (fd[0].DI_ID == '3') {
                                if ($('#ddlDT').val() == 'Desync') {
                                    $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ $('#Dddl_Unit').val() + '">' + $('#Dddl_Unit option:selected').text() + '</td>\
                                        <td>'+ $('#txt_DTarget_Demand').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve').val() + '</td>\
                                        <td>'+ $('#txt_DLoad_Achieve_Date_Time').val() + '</td>\
                                        <td style="padding-left: 1% !important;"><input type="button" id="btn_X" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                }
                            }
                            if (fd[0].DI_ID == '4') {
                                if ($('#ddlDT').val() == 'Desync') {
                                    $('#tblMultircdD tbody').append('<tr>\
                                        <td tg="'+ $('#Dddl_Unit').val() + '">' + $('#Dddl_Unit option:selected').text() + '</td>\
                                        <td style="padding-left: 1% !important;"><input id="btn_X" type="button" class="btn btn-success clsRmv" value=" X "></td></tr > ');
                                }
                            }
                        }
                    });
                }


            });

            $('body').off('click', '#btn_AddTD');
            $('body').on('click', '#btn_AddTD', function () {
                var fromdata = new FormData();
                fromdata.append('vls', '106½' + $('#ddl_Unit').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);
                        var abc_min;
                        abc_min = (fd[0].min_load);
                        console.log(abc_min);
                        if ($('#txtDIF_targetDemand').val() < abc_min) {
                            alert("less then Minimum Load Limit,Minimum Load Limit = " + abc_min);
                            $(txtDIF_targetDemand).val("");

                        }
                        else {
                            var fromdata = new FormData();
                            fromdata.append('vls', '105½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddl_Unit').val() + "½" + $('#dt_SyncDesyncTime').val() + "½" + $('#txtDIF_targetDemand').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var fd = $.parseJSON(response);
                                    console.log(fd);

                                    $('#txtDIF_targetDateTime').val(fd[0].total_Ramp_Held_Mins);
                                    var mins = (fd[0].total_Ramp_Held_Mins);
                                    console.log(mins);
                                    //var s = new Date();
                                    //console.log(s);
                                    //s.setMinutes(s.getMinutes() + mins);
                                    //console.log(s);
                                    //$('#txt_targetDateTime').val(s);

                                    var ntime = $("#txtDIF_NotifyDateTime").val();
                                    var s = new Date(ntime);
                                    console.log(s);
                                    s.setMinutes(s.getMinutes() + mins);
                                    console.log(s);
                                    var d = s;
                                    var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                    console.log(total_time);
                                    $('#txt_targetDateTime').val(total_time);

                                }
                            });
                        }

                    }
                });

            });

            //$('#txt_Target_Demand').on('keyup focusout', function (event) {
            //    alert(event.type); // keyup OR keypress OR blur OR change
            //});

            //for Get laod achieve time + date time by demand input time----Sync
            //var input = document.getElementById("txt_Target_Demand");

            // Execute a function when the user releases a key on the keyboard
            $('#txt_Target_Demand').on('keyup focusout', function (event) {
                // Number 13 is the "Enter" key on the keyboard
                if (event.keyCode === 13 || event.which) {
                    var fromdata = new FormData();
                    fromdata.append('vls', '106½' + $('#ddl_Unit').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            var fd = $.parseJSON(response);
                            console.log(fd);
                            var abc_min;
                            //abc_min = (fd[0].min_load);
                            //console.log(abc_min);
                            //if ($('#txt_Target_Demand').val() < abc_min) {
                            //    alert("less then Minimum Load Limit,Minimum Load Limit = " + abc_min);
                            //    $('#txt_Target_Demand').val("");
                            //    $('#txt_Load_Achieve').val("");
                            //    $('#txt_Load_Achieve_Date_Time').val("");


                            //}
                            //else {
                                var fromdata = new FormData();
                            fromdata.append('vls', '105½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddl_Unit').val() + "½" + $('#dt_SyncDesyncTime').val() + "½" + $('#txt_Target_Demand').val() + "½" + $("#txtDIF_NotifyDateTime").val() + "½" + NTS_mins);
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        var fd = $.parseJSON(response);
                                        console.log(fd);
                                        var total_Ramp_Held_Mins = Math.ceil(fd[0].total_Ramp_Held_Mins);
                                        $('#txt_Load_Achieve').val(total_Ramp_Held_Mins);
                                        var mins = (total_Ramp_Held_Mins);
                                        console.log(mins);
                                        //var s = new Date();
                                        //console.log(s)
                                        //s.setMinutes(s.getMinutes() + mins);
                                        //console.log(s);
                                        //$('#txt_Load_Achieve_Date_Time').val(s);
                                        //$("#txt_Target_Demand").prop("disabled", true);

                                        var ntime = $("#txtDIF_NotifyDateTime").val();
                                        var s = new Date(ntime);
                                        console.log(s);
                                        s.setMinutes(s.getMinutes() + mins + NTS_mins);
                                        console.log(s);
                                        var d = s;
                                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                        console.log(total_time);
                                        $('#txt_Load_Achieve_Date_Time').val(fd[0].Load_Achieve_Time);

                                    }
                                });
                            //}

                        }
                    });

                }
            });


            $('#txtIDL_targetDemand').on('keyup focusout', function (event) {
                // Number 13 is the "Enter" key on the keyboard
                if (event.keyCode === 13 || event.which) {
                    //var fromdata = new FormData();
                    //fromdata.append('vls', '106½' + $('#ddlIDL_COMPLEX').val());
                    //$.ajax({
                    //    type: "POST",
                    //    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    //    data: fromdata,
                    //    contentType: false,
                    //    processData: false,
                    //    success: function (response) {
                    //        var fd = $.parseJSON(response);
                    //        console.log(fd);
                            //var abc_min;
                            //abc_min = (fd[0].min_load);
                            //console.log(abc_min);
                            //if ($('#txtIDL_targetDemand').val() < abc_min) {

                            //    alert("less then Minimum Load Limit,Minimum Load Limit = " + abc_min);
                            //    $('#txtIDL_targetDemand').val("");
                            //    $('#txtIDL_LOAD_ACHIEVE').val("");
                            //    $('#txtIDL_LOAD_ACHIEVE_TIME').val("");

                            //}
                            //else {

                    if ($('#ddlDT').val() == 'Increase/Decrease Load') {


                                    var ramp1;
                                    var ramp2;
                                    var onbarCount;
                                    onbarCount = $('#txtIDL_ONBAR_UNITS').val();
                                    var Current_Load;
                                    Current_Load = $('#txtIDL_CURRENTLOAD').val() / onbarCount;
                                    var IDL_Demand;
                                    IDL_Demand = $('#txtIDL_targetDemand').val() / onbarCount;
                                    //for current load
                                    var fromdata = new FormData();
                                    fromdata.append('vls', '151½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddlIDL_COMPLEX').val() + "½" + '0' + "½" + Current_Load + "½" + IDL_Demand + "½" +   $("#txtDIF_NotifyDateTime").val());
                                    $.ajax({
                                        type: "POST",
                                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                        data: fromdata,
                                        contentType: false,
                                        processData: false,
                                        success: function (response) {
                                            var fd = $.parseJSON(response);
                                            console.log(fd);
                                            //ramp1 = (fd[0].total_Ramp_Held_Mins);
                                            debugger;

                                    //for target demand
                                    //var fromdata = new FormData();
                                    //fromdata.append('vls', '105½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddlIDL_COMPLEX').val() + "½" + '0' + "½" + IDL_Demand);
                                    //$.ajax({
                                    //    type: "POST",
                                    //    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    //    data: fromdata,
                                    //    contentType: false,
                                    //    processData: false,
                                    //    success: function (response) {

                                    //        var ab = $.parseJSON(response);
                                    //        console.log(ab);
                                            //ramp2 = (ab[0].total_Ramp_Held_Mins);
                                            ////alert(ramp2);
                                            //var calculated_ramp = ramp2 - ramp1;
                                            ////calculated_ramp = Math.abs(calculated_ramp);
                                            //////alert(calculated_ramp);

                                            //calculated_ramp = Math.ceil(calculated_ramp);
                                            ////console.log(calculated_ramp);
                                            //debugger;

                                            $('#txtIDL_LOAD_ACHIEVE').val(Math.abs(fd[0].total_Ramp_Held_Mins));
                                            //var mins = Math.abs(calculated_ramp);
                                            //console.log(mins);

                                            //var d = new Date();
                                            //[(d.getMonth() + 1),
                                            //    d.getDate(),
                                            //    d.getFullYear()].join('-') + ' ' +
                                            //    [d.getHours(),
                                            //    d.getMinutes()].join(':');
                                            //console.log(d);
                                            //d.setMinutes(d.getMinutes() + mins);
                                            //console.log(d);
                                            //$('#txtIDL_LOAD_ACHIEVE_TIME').val(d);

                                            //var ntime = $("#txtDIF_NotifyDateTime").val();
                                            //var s = new Date(ntime);
                                            //console.log(s);
                                            //s.setMinutes(s.getMinutes() + mins);
                                            //console.log(s);
                                            //var d = s;
                                            //var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                            //console.log(total_time);
                                            $('#txtIDL_LOAD_ACHIEVE_TIME').val(fd[0].Load_Achieve_Time);

                                }
                            });
                                    //    }
                                    //});


                    }

                }
            });



            $('#txt_DTarget_Demand').on('keyup focusout', function (event) {
                // Number 13 is the "Enter" key on the keyboard
                if (event.keyCode === 13 || event.which) {
                    var fromdata = new FormData();
                    fromdata.append('vls', '106½' + $('#Dddl_Unit').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            var fd = $.parseJSON(response);
                            console.log(fd);
                            var abc_min;
                            abc_min = (fd[0].min_load);
                            console.log(abc_min);
                            //if ($('#txt_DTarget_Demand').val() < abc_min) {
                            //    alert("less then Minimum Load Limit,Minimum Load Limit = " + abc_min);
                            //    $('#txt_DTarget_Demand').val("");
                            //    $('#txt_DLoad_Achieve').val("");
                            //    $('#txt_DLoad_Achieve_Date_Time').val("");


                            //}
                            //else {
                                var fromdata = new FormData();
                            fromdata.append('vls', '150½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#Dddl_Unit').val() + "½" + '0' + "½" + $('#txt_DTarget_Demand').val() + "½" + $("#txtDIF_NotifyDateTime").val() );
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        var fd = $.parseJSON(response);
                                        console.log(fd);

                                        console.log(fd);
                                        var total_Ramp_Held_Mins = Math.ceil(fd[0].total_Ramp_Held_Mins);
                                        $('#txt_DLoad_Achieve').val(total_Ramp_Held_Mins);

                                        var mins = (total_Ramp_Held_Mins);
                                        console.log(mins);
                                        
                                        var ntime = $("#txtDIF_NotifyDateTime").val();
                                        var s = new Date(ntime);
                                        console.log(s);
                                        s.setMinutes(s.getMinutes() + mins);
                                        console.log(s);
                                        var d = s;
                                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                        console.log(total_time);
                                        $('#txt_DLoad_Achieve_Date_Time').val(fd[0].Load_Achieve_Time);

                                    }
                                });
                            }

                        //}
                    });

                }
            });

            addComma(); //for now will be in current availability function when added.
            var radioValue = '', isSDDateTimeVisible = false;
            $('body').on('focus', ".dtDateTime", function () {
                $(this).datetimepicker({
                    format: 'DD-MMM-YYYY HH:mm'
                });
            });
            //btnClose Start
            $('body').off('click', '#btnClose');
            $('body').on('click', '#btnClose', function (e) {
                e.preventDefault();

                var options = {};
                $("#pageContainer").hide('slide', options, 300);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/DespatchInstructionList" + $(location).attr('search'),
                    success: function (result) {
                        var options = {};
                        $('#pageContainer').html($(result).find('#pcontent').html());
                        $("#pageContainer").show('slide', options, 500);
                    }
                });

            });//End of btnClose click

            //button submit function

            function LoadVendors() {

                var fromdata = new FormData();
                fromdata.append('vls', '100½' + $('#ddlIPP_Cat').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        //var fd = $.parseJSON(response);
                        //$('#ddlIPP').val(fd[0].vendors);
                        $('#ddlIPP').html(response);

                        if ($('#ddlIPP').val() == null || $('#ddlIPP').val() == undefined || $('#ddlIPP').val() == "") {

                            $('#ddlSite,#ddlBlock').html('');
                            //$('#txtFuel, #txtCapacity, #txtDependableCapacity, #txtPowerPolicy').val('');
                        }
                        else {
                            LoadVendorSites();
                        }
                    }
                });

            }//END OF LOAD



            function LoadVendorSites() {
                //debugger;
                var fromdata = new FormData();
                fromdata.append('vls', '0½' + $('#ddlIPP').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlSite').html(response);
                        if ($('#ddlSite').val() == null || $('#ddlSite').val() == undefined || $('#ddlSite').val() == "") {

                            $('#ddlBlock,#ddl_Unit').html('');
                            $('#txtFuel, #txtCapacity, #txtDependableCapacity, #txtPowerPolicy').val('');
                        }
                        else {
                            DT_Cosmetic_byDICat();
                            loadCurrentAvailability();
                            LoaddllBlockFuel();
                            LoadSyncUnitsCountIDL();
                            $('.clsRmv').parent().parent().remove();

                        }
                    }
                });
            }//END OF LOAD


            //Function for checking Current Availability (Raza)
            function loadCurrentAvailability() {

                var fromdata = new FormData();
                fromdata.append('vls', '190½' + $('#ddlSite').val() + '½' + $('#txtDIF_NotifyDateTime').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(response);
                        $('#txtDIF_currentAvailability').val('Availability = ' + fd[0].AVAILABILITY + ' , ' + 'FUEL TYPE = ' + fd[0].FUEL_TYPE + ' , ' + 'Remarks = ' + fd[0].Remarks);
                    }

                });
            }



            function loadComplex_IDL() {
                var fromdata = new FormData();
                fromdata.append('vls', '191½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlIDL_COMPLEX').html(response);
                        if ($('#ddlDT').val() == 'Increase/Decrease Load') {
                            //loadtblTechnicalLimits();

                        }

                    }

                });
            }


            function LoaddllBlockFuel() {

                var fromdata = new FormData();
                fromdata.append('vls', '107½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlBlock').html(response);
                        if ($('#ddlBlock').val() == null || $('#ddlBlock').val() == undefined || $('#ddlBlock').val() == "") {
                            $('#txtFuel, #txtPowerPolicy, #txtCapacity , #txtDependableCapacity , #txtTargetDate, #txtINTIMATION_DATE_TIME').val('');
                            $("#tblEventsContainer").html('');
                        }
                        else {
                            $('#txtFuel').val($('#ddlBlock').val().split('½')[1]);
                            $('#txtCapacity , #txtDependableCapacity').val($('#ddlBlock').val().split('½')[2]);
                            $('#txtPowerPolicy').val($('#ddlBlock').val().split('½')[3]);
                            $('#Technical_limits');
                            $('#Technical_limits').html($('#ddlBlock').val().split('½')[4]);
                            loadtblEvents();
                            loadtblDespatch();
                            LoaddllUnits();
                            //CURRENT AVAILBLITY CALLS
                            //Fn_checkPowerPolicy();
                        }
                    }
                });
            }


            function LoaddllUnits() {

                if ($('#ddlDT').val() == 'Sync') { 

                    var fromdata = new FormData();
                    fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {

                            var fd = $.parseJSON(response);

                            if (fd[0].DI_ID == '2') {

                                var fromdata = new FormData();
                                fromdata.append('vls', '113½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() );
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        $('#ddl_Unit').html(response);
                                        getEventTime_Unit();
                                        console.log($('#dt_SyncDesyncTime').val());
                                        getEventTime_Unit();
                                    }

                                });
                            }

                            if ((fd[0].DI_ID == '1') || (fd[0].DI_ID == '3') || (fd[0].DI_ID == '4')) {

                                var fromdata = new FormData();
                                fromdata.append('vls', '101½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddlDT').val());
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        $('#ddl_Unit').html(response);
                                        getEventTime_Unit();
                                        console.log($('#dt_SyncDesyncTime').val());
                                        getEventTime_Unit();
                                    }

                                });
                            }
                            loadtblTechnicalLimits();
                        }
                    });
                }

                if ($('#ddlDT').val() == 'Desync') {
                    var fromdata = new FormData();
                    fromdata.append('vls', '101½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddlDT').val());
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            $('#Dddl_Unit').html(response);
                            loadtblTechnicalLimits();
                            getEventTime_Unit();
                            console.log($('#dt_DSyncDesyncTime').val('0'));
                            $('#txt_NTDS').val('0');
                            //$('#txt_NTDS_Date_Time').val('');
                            $('#txt_Dpresent_State').val('Hot');

                        }
                    });
                }

            }


            function LoadSyncUnitsCountIDL() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if ((fd[0].DI_ID == '3') && ($('#ddlDT').val() == 'Increase/Decrease Load')) {

                            var fromdata = new FormData();
                            fromdata.append('vls', '115½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var fd = $.parseJSON(response);
                                    console.log(response);

                                    $('#txtIDL_ONBAR_UNITS').val(fd[0].Column1);
                                    loadComplex_IDL();
                                    loadtblTechnicalLimits();

                                }
                            });


                        }
                        else if ((fd[0].DI_ID != '3') && ($('#ddlDT').val() == 'Increase/Decrease Load')){
                            var fromdata = new FormData();
                            fromdata.append('vls', '109½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var fd = $.parseJSON(response);
                                    console.log(response);

                                    $('#txtIDL_ONBAR_UNITS').val(fd[0].Column1);
                                    loadComplex_IDL();
                                    loadtblTechnicalLimits();

                                }
                            });
                        }
                    }

                });

            }


            var hours;
            function getEventTime_Unit() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if ((fd[0].DI_ID == '2') && ($('#ddl_Unit option:selected').text() == 'Complex')) {

                            var fromdata = new FormData();
                            fromdata.append('vls', '116½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val() + '½' + $('#txtDIF_NotifyDateTime').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var fd = $.parseJSON(response);
                                    console.log(fd);

                                    $('#dt_SyncDesyncTime').val(fd[0].Hours);
                                    get_PresentState();

                                }
                            });
                            //}
                        }
                        else {
                            var fromdata = new FormData();
                            fromdata.append('vls', '102½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddl_Unit').val() + "½" + $('#ddlDT').val() + "½" + $('#txtDIF_NotifyDateTime').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {

                                    var fd = $.parseJSON(response);
                                    console.log(fd);
                                    $('#dt_SyncDesyncTime').val(fd[0].Hours);
                                    //getEventTimeForCat2Complex();
                                    get_PresentState();

                                }
                            });
                        }

                    }
                });

            }



            var NTS_mins;
            function get_PresentState() {
                var fromdata = new FormData();
                fromdata.append('vls', '103½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddl_Unit').val() + "½" + $('#ddlDT').val() + "½" + $('#dt_SyncDesyncTime').val() + "½" + $("#txtDIF_NotifyDateTime").val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);

                        $('#txt_present_State').val(fd[0].STATE_NAME);
                        $('#txt_NTS').val(fd[0].NTS);
                        NTS_mins = parseInt(fd[0].NTS);
                        console.log(fd[0].NTS_Time);
                        //alert(fd[0].NTS_Time);
                        var total_time = fd[0].NTS_Time;



                        //alert(NTS_mins);
                        //var s = new Date();
                        //console.log(s)
                        //s.setMinutes(s.getMinutes() + mins);
                        //console.log(s);
                        //$('#txt_NTS_Date_Time').val(s);

                        //var ntime = $("#txtDIF_NotifyDateTime").val();
                        //var s = new Date(ntime);
                        //console.log(s);
                        //s.setMinutes(s.getMinutes() + NTS_mins);

                        ////var d = s;
                        //var total_time = s.getDate() + '-' + (s.getMonth() + 1) + '-' + s.getFullYear() + ' ' + s.getHours() + ':' + s.getMinutes();
                        ////Date.parse(total_time);
                        ////alert(typeof(total_time) + total_time);
                        //console.log(total_time);
                        //alert(total_time + typeof (total_time) );
                        $('#txt_NTS_Date_Time').val(total_time);
                        getDeratedCapacity();

                        getFullloadtime_for_DGs();
                    }
                });
            }



            function getDeratedCapacity() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if (((fd[0].DI_ID == '3') || (fd[0].DI_ID == '1')) || ((fd[0].DI_ID == '2') && ($('#ddlDT').val() == 'Desync'))) {

                            var fromdata = new FormData();
                            fromdata.append('vls', '114½' + $('#ddl_Unit').val());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var ab = $.parseJSON(response);
                                    console.log(ab);
                                    if ((fd[0].DI_ID == '3')) {
                                        $('#txt_DTarget_Demand').val(ab[0].CAPACITY);
                                        $('#txt_Target_Demand').prop("disabled", true);
                                    }
                                    if ((fd[0].DI_ID == '1')) {
                                        $('#txt_Target_Demand').prop("disabled", false);
                                    }
                                    if ((fd[0].DI_ID == '1')) {
                                        $('#txt_DTarget_Demand').val(ab[0].CAPACITY);
                                        $('#txt_DTarget_Demand').prop("disabled", false);
                                    }
                                    if ((fd[0].DI_ID == '2') && ($('#ddlDT').val() == 'Desync')) {
                                        $('#txt_DTarget_Demand').prop("disabled", true);
                                        $('#txt_DTarget_Demand').val(ab[0].CAPACITY);
                                        getAuto_Calculated_Time_Achievement_Time_Desync();
                                    }
                                    $('#txt_Target_Demand').val(ab[0].CAPACITY);
                                    getAuto_Calculated_Time_Achievement_Time();
                                }
                            });
                        }
                    }
                });

            }

           function getAuto_Calculated_Time_Achievement_Time()
            {
                var fromdata = new FormData();
               fromdata.append('vls', '105½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#ddl_Unit').val() + "½" + $('#dt_SyncDesyncTime').val() + "½" + $('#txt_Target_Demand').val() + "½" + $("#txtDIF_NotifyDateTime").val() + "½" + NTS_mins);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false, 
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);
                        var total_Ramp_Held_Mins = Math.ceil(fd[0].total_Ramp_Held_Mins);
                        $('#txt_Load_Achieve').val(total_Ramp_Held_Mins);
                        var mins = (total_Ramp_Held_Mins);
                        console.log(mins);
                        //var s = new Date();
                        //console.log(s)
                        //s.setMinutes(s.getMinutes() + mins);
                        //console.log(s);
                        //$('#txt_Load_Achieve_Date_Time').val(s);
                        //$("#txt_Target_Demand").prop("disabled", true);
                        var ntime = $("#txtDIF_NotifyDateTime").val();
                        var s = new Date(ntime);
                        console.log(s);
                        s.setMinutes(s.getMinutes() + mins + NTS_mins);
                        console.log(s);
                        var d = s;
                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                        console.log(total_time);
                        $('#txt_Load_Achieve_Date_Time').val(fd[0].Load_Achieve_Time);

                    }
                    });

            }


            function getAuto_Calculated_Time_Achievement_Time_Desync() {
                var fromdata = new FormData();
                fromdata.append('vls', '150½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + $('#Dddl_Unit').val() + "½" + '0' + "½" + $('#txt_DTarget_Demand').val() + "½" + $("#txtDIF_NotifyDateTime").val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);

                        console.log(fd);
                        var total_Ramp_Held_Mins = Math.ceil(fd[0].total_Ramp_Held_Mins);
                        $('#txt_DLoad_Achieve').val(total_Ramp_Held_Mins);

                        var mins = (total_Ramp_Held_Mins);
                        console.log(mins);
                        //var s = new Date();
                        //console.log(s)
                        //s.setMinutes(s.getMinutes() + mins);
                        //console.log(s);
                        //$('#txt_DLoad_Achieve_Date_Time').val(s);
                        //$("#txt_Target_Demand").prop("disabled", true);

                        var ntime = $("#txtDIF_NotifyDateTime").val();
                        var s = new Date(ntime);
                        console.log(s);
                        s.setMinutes(s.getMinutes() + mins);
                        console.log(s);
                        var d = s;
                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                        console.log(total_time);

                        $('#txt_DLoad_Achieve_Date_Time').val(fd[0].Load_Achieve_Time);

                    }
                });
            }

            function getFullloadtime_for_DGs() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if (fd[0].DI_ID == '2') {

                            if ($('#ddl_Unit option:selected').text() == 'Complex') {

                                var fromdata = new FormData();
                                fromdata.append('vls', '112½' + $('#ddl_Unit').val() + "½" + $('#txt_present_State').val());
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        var fd = $.parseJSON(response);
                                        console.log(fd);
                                        var full_load_time = fd[0].FULL_LOAD_TIME;
                                        var full_load_time_wst = fd[0].FULL_LOAD_TIME_WITH_ST;


                                        $('#th_load_achievement_time').hide();
                                        $('#td_txt_Load_Achieve_Date_Time').hide();
                                        $('#th_load_achievement_min').show();
                                        $('#td_txt_Load_Achieve_Min').show();
                                        $('#td_txt_Load_Achieve_Date_Time_WST').show();
                                        $('#td_txt_Load_Achieve_Date_Time_WOST').show();
                                        $('#th_load_achievement_time_wst').show();
                                        $('#th_load_achievement_time_wost').show();

                                        //$('#txt_Load_Achieve_Date_Time_WST').val(fd[0].FULL_LOAD_TIME_WITH_ST);
                                        //$('#txt_Load_Achieve_Date_Time_WOST').val(fd[0].FULL_LOAD_TIME);

                                        //load achievement time for Without ST
                                        var ntime = $("#txtDIF_NotifyDateTime").val();
                                        var s = new Date(ntime);
                                        console.log(s);
                                        s.setMinutes(s.getMinutes() + full_load_time);
                                        console.log(s);
                                        var d = s;
                                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                        console.log(total_time);
                                        $('#txt_Load_Achieve_Date_Time_WOST').val(total_time);


                                        //load achievement time for Without ST
                                        var ntime = $("#txtDIF_NotifyDateTime").val();
                                        var s = new Date(ntime);
                                        console.log(s);
                                        s.setMinutes(s.getMinutes() + full_load_time_wst);
                                        console.log(s);
                                        var d = s;
                                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                        console.log(total_time);
                                        $('#txt_Load_Achieve_Date_Time_WST').val(total_time);
                                        $('#txt_Load_Achieve_Min').val(full_load_time_wst);


                                    }
                                });


                            }

                            if ($('#ddl_Unit option:selected').text() != 'Complex') {



                                var fromdata = new FormData();
                                fromdata.append('vls', '111½' + $('#ddl_Unit').val() + "½" + $('#txt_present_State').val());
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {
                                        var fd = $.parseJSON(response);
                                        console.log(fd);

                                        var full_load_time = fd[0].FULL_LOAD_TIME;

                                        $('#th_load_achievement_min').show();
                                        $('#td_txt_Load_Achieve_Min').show();

                                        $('#th_load_achievement_time').show();
                                        $('#td_txt_Load_Achieve_Date_Time').show();
                                        //$('#txt_Load_Achieve_Date_Time').val(fd[0].FULL_LOAD_TIME);

                                        $('#td_txt_Load_Achieve_Date_Time_WST').hide();
                                        $('#td_txt_Load_Achieve_Date_Time_WOST').hide();
                                        $('#th_load_achievement_time_wst').hide();
                                        $('#th_load_achievement_time_wost').hide();


                                        //load achievement time for Without ST
                                        var ntime = $("#txtDIF_NotifyDateTime").val();
                                        var s = new Date(ntime);
                                        console.log(s);
                                        s.setMinutes(s.getMinutes() + full_load_time);
                                        console.log(s);
                                        var d = s;
                                        var total_time = d.getDate() + '-' + (d.getMonth() + 1) + '-' + d.getFullYear() + ' ' + d.getHours() + ':' + d.getMinutes();
                                        console.log(total_time);
                                        $('#txt_Load_Achieve_Date_Time').val(total_time);
                                        $('#txt_Load_Achieve_Min').val(full_load_time);



                                    }
                                });

                            }
                        }
                    }
                });
            }

            function getEventTimeForCat2Complex() {
                var fromdata = new FormData();
                fromdata.append('vls', '110½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        var fd = $.parseJSON(response);

                        if (fd[0].DI_ID == '2') {

                            if ($('#ddl_Unit option:selected').text() == 'Complex') {



                                //$('#dt_SyncDesyncTime').val('');
                                var fromdata = new FormData();
                                fromdata.append('vls', '116½' + $('#ddlIPP').val() + '½' + $('#ddlSite').val() + '½' + $('#txtDIF_NotifyDateTime').val());
                                $.ajax({
                                    type: "POST",
                                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                                    data: fromdata,
                                    contentType: false,
                                    processData: false,
                                    success: function (response) {

                                        var fd = $.parseJSON(response);
                                        console.log(fd);

                                        $('#dt_SyncDesyncTime').val(fd[0].Hours);
                                    }
                                });
                            }
                        }
                    }
                });
            }



            //for change of notification time..

            $('body').off('click', '#txtDIF_NotifyDateTime');
            $('body').on('click', '#txtDIF_NotifyDateTime', function (e) {
                LoadVendorSites();

            });


            $('body').off('change', '#ddl_Unit');
            $('body').on('change', '#ddl_Unit', function (e) {
                getEventTime_Unit();
                loadtblTechnicalLimits();

                //$('.clsRmv').parent().parent().remove();

            });
            $('body').off('change', '#Dddl_Unit');
            $('body').on('change', '#Dddl_Unit', function (e) {
                getDeratedCapacity();
                loadtblTechnicalLimits();

                //$('.clsRmv').parent().parent().remove();

            });

            $('body').off('change', '#ddlIPP_Cat');
            $('body').on('change', '#ddlIPP_Cat', function (e) {
                LoadVendors();

            });



            $('body').off('change', '#ddlIPP');
            $('body').on('change', '#ddlIPP', function (e) {
                $('#dt_SyncDesyncTime').val('');
                $('#txt_present_State').val('');
                $('#txt_NTS').val('');
                $('#txt_NTS_Date_Time').val('');
                $('#txt_Target_Demand').val('');
                $('#txt_Load_Achieve').val('');
                $('#txt_Load_Achieve_Date_Time').val('');
                $('#txt_DTarget_Demand').val('');
                $('#txt_DLoad_Achieve').val('');
                $('#txt_DLoad_Achieve_Date_Time').val('');
                $('#txtIDL_ONBAR_UNITS').val('');
                $('#txtIDL_CURRENTLOAD').val('');
                $('#txtIDL_targetDemand').val('');
                $('#txtIDL_LOAD_ACHIEVE').val('');
                $('#txtIDL_LOAD_ACHIEVE_TIME').val('');

                LoadVendorSites();
                loadCurrentAvailability();
                LoadSyncUnitsCountIDL();
                loadtblEvents();
                loadtblDespatch();


            });// End of change


            $('body').off('change', '#ddlSite');
            $('body').on('change', '#ddlSite', function (e) {
                LoaddllBlockFuel();
                DT_Cosmetic_byDICat();

            });// End of change


            $('body').off('change', '#ddlBlock');
            $('body').on('change', '#ddlBlock', function (e) {

                if ($('#ddlBlock').val() == null || $('#ddlBlock').val() == undefined || $('#ddlBlock').val() == "") {
                    $('#txtFuel, #txtCapacity, #txtDependableCapacity, #txtPowerPolicy').val('');
                    $("#tblEventsContainer").html('');
                }
                else {
                    $('#txtFuel').val($('#ddlBlock').val().split('½')[1]);
                    $('#txtCapacity , #txtDependableCapacity').val($('#ddlBlock').val().split('½')[2]);
                    $('#txtPowerPolicy').val($('#ddlBlock').val().split('½')[3]);
                    $('#Technical_limits').html($('#ddlBlock').val().split('½')[4]);

                    loadtblEvents();
                    loadtblDespatch();
                    //Fn_checkPowerPolicy();

                }
            });// End of



            $('body').off('click', '.rdtop');
            $('body').on('click', '.rdtop', function (e) {
                //debugger;
                radioValue = $(this).val();
                if (radioValue.toLowerCase() == "sync" || radioValue.toLowerCase() == "desync") {
                    $('#trDIF_SDDateTime').show();
                    isSDDateTimeVisible = true;
                    $('#tblMultircd_Remarks tbody').html('');
                    $('#tblMultircd tbody').html('');
                    $('#ddlEmrgncyTyp').html('<option value=""></option>');
                }


                else {
                    $('#trDIF_SDDateTime').hide();
                    isSDDateTimeVisible = false;
                    $('#Sync_TimeLabel').hide();//.addClass('display-none');
                }

                ///emergency demand code snippet start
                if (radioValue.toLowerCase() == "emergency") {
                    $('#trDIE_EDemand').show();//.removeClass('display-none');
                    $('#txtDIF_targetDemand').css("background-color", "");
                    $('#txtDIF_targetDateTime').css("background-color", "");
                    $('.Spanreqclass').hide();//.addClass('display-none');
                    $('#ddlEmrgncyTyp').html('<option>Fast Ramp Down</option><option>Fast Ramp Up </option><option>Shutdown</option>');

                }
                else {
                    $('#trDIE_EDemand').hide();//.addClass('display-none');
                    $('#txtDIF_targetDemand').css("background-color", "rgb(251, 255, 193)");
                    $('#txtDIF_targetDateTime').css("background-color", "rgb(251, 255, 193)");
                    $('.Spanreqclass').show();//.removeClass('display-none');
                    $('#ddlEmrgncyTyp').html('<option value=""></option>');

                }
                //if (radioValue.toLowerCase() == "sync" || radioValue.toLowerCase() == "desync") {
                //    var fromdata = new FormData();
                //    fromdata.append('vls', '101½' + $('#ddlIPP').val() + "½" + $('#ddlSite').val() + "½" + radioValue);
                //    $.ajax({
                //        type: "POST",
                //        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                //        data: fromdata,
                //        contentType: false,
                //        processData: false,
                //        success: function (response) {
                //            $('#ddl_Unit').html(response);
                //            if ($('#ddl_Unit').val() == null || $('#ddl_Unit').val() == undefined || $('#ddl_Unit').val() == "") {
                //                //$('#txtFuel, #txtPowerPolicy, #txtCapacity , #txtDependableCapacity , #txtTargetDate, #txtINTIMATION_DATE_TIME').val('');
                //                //$("#tblEventsContainer").html('');
                //            }
                //            //else {
                //            //    $('#txtFuel').val($('#ddlBlock').val().split('½')[1]);
                //            //    $('#txtCapacity , #txtDependableCapacity').val($('#ddlBlock').val().split('½')[2]);
                //            //    $('#txtPowerPolicy').val($('#ddlBlock').val().split('½')[3]);
                //            //    $('#Technical_limits');
                //            //    $('#Technical_limits').html($('#ddlBlock').val().split('½')[4]);
                //            //    loadtblEvents();
                //            //    loadtblDespatch();
                //            //    loadCurrentAvailability();
                //            //    //CURRENT AVAILBLITY CALLS
                //            //    //Fn_checkPowerPolicy();
                //            //}
                //        }
                //    });



                //}
            });



            function loadtblEvents() {
                //hits 14
                $("#tblEventsContainer").html('<div style="text-align:center;padding:20px;"><img alt="" src="../Content/img/DataLoader.gif" /></div>');

                var fromdata = new FormData();

                fromdata.append("vls", '14½' + $("#ddlSite option:selected").val());
                var choice = {};
                choice.url = '/NPCC/AjaxCallNext' + $(location).attr('search');
                choice.type = "POST";
                choice.data = fromdata;
                choice.contentType = false;
                choice.processData = false;
                choice.success = function (response) {
                    if ($('#tblEvents').hasClass('dataTable')) {
                        $('#tblEvents').dataTable().fnDestroy();
                    }
                    $('#tblEventsContainer').html(response);
                    $($('#tblEvents thead tr th')[0]).css('width', '35px');
                    $('#tblEvents tbody tr').each(function (index, element) {
                        $($(this).find('td')[0]).html(parseInt(index) + 1);
                    });


                };
                choice.error = function (err) {
                    console.log(err.statusText);
                };
                $.ajax(choice);
            }


            function loadtblTechnicalLimits() {
                //hits 14
                $("#Technical_limits").html('<div style="text-align:center;padding:20px;"><img alt="" src="../Content/img/DataLoader.gif" /></div>');

                var fromdata = new FormData();

                fromdata.append("vls", '118½' + $("#ddlSite option:selected").val() + '½' + $("#Dddl_Unit").val() + '½' + $("#ddl_Unit").val() + '½' + $('#ddlIDL_COMPLEX').val() + '½' + $("#ddlDT").val() );
                var choice = {};
                choice.url = '/NPCC/AjaxCall' + $(location).attr('search');
                choice.type = "POST";
                choice.data = fromdata;
                choice.contentType = false;
                choice.processData = false;
                choice.success = function (response) {
                    if ($('#Technical_limits').hasClass('dataTable')) {
                        $('#Technical_limits').dataTable().fnDestroy();
                    }
                    $('#Technical_limits').html(response);
                    $($('#tblTechnicalLimit thead tr th')[0]).css('width', '35px');
                    $(  '#tblTechnicalLimit tbody tr').each(function (index, element) {
                        $($(this).find('td')[0]).html(parseInt(index) + 1);
                    });


                };
                choice.error = function (err) {
                    console.log(err.statusText);
                };
                $.ajax(choice);
            }


            function loadtblDespatch() {
                //hits 15
                $("#tblDespatchContainer").html('<div style="text-align:center;padding:20px;"><img alt="" src="../Content/img/DataLoader.gif" /></div>');

                var fromdata = new FormData();
                fromdata.append("vls", '15½' + $("#ddlSite option:selected").val());
                var choice = {};
                choice.url = '/NPCC/AjaxCallNext' + $(location).attr('search');
                choice.type = "POST";
                choice.data = fromdata;
                choice.contentType = false;
                choice.processData = false;
                choice.success = function (response) {
                    if ($('#tblDespatch').hasClass('dataTable')) {
                        $('#tblDespatch').dataTable().fnDestroy();
                    }
                    $('#tblDespatchContainer').html(response);
                    $($('#tblDespatch thead tr th')[0]).css('width', '35px');
                    $('#tblDespatch tbody tr').each(function (index, element) {
                        $($(this).find('td')[0]).html(parseInt(index) + 1);
                    });
                };
                choice.error = function (err) {
                    console.log(err.statusText);
                };
                $.ajax(choice);
            }



            function validations() {
                if ($('#ddlDIF_IPP').val() == '-1') {
                    swal({
                        title: "Error",
                        text: "Please select power producer!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlDIF_IPP').focus(), 100)
                        }
                    });
                    return false;
                }
                if ($('#ddlDIF_Site').val() == '-1') {
                    swal({
                        title: "Error",
                        text: "Please select power producer site!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlDIF_Site').focus(), 100)
                        }
                    });
                    return false;
                }
                if ($('#ddlDIF_CBF').val() == '-1') {
                    swal({
                        title: "Error",
                        text: "Please select complex/block/unit!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlDIF_CBF').focus(), 100)
                        }
                    });
                    return false;
                }
                if ($('#txtDIF_NotifyDateTime').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please enter notfication date & time!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#txtDIF_NotifyDateTime').focus(), 100)
                        }
                    });
                    return false;
                }
                //if ($('#txtDIF_UpdateAchievementTime').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter achievement date & time!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#txtDIF_UpdateAchievementTime').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                //if (radioValue == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please select demand type!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#rdDIF_SDDateTime').focus(), 100)
                //        }
                //    });
                //    return false;
                //}

                if (isSDDateTimeVisible && $('#txtDIF_SDDateTime').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please enter sync / desync date & time!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#txtDIF_SDDateTime').focus(), 100)
                        }
                    });
                    return false;
                }
                //if ($('#txtDIF_targetDemand').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter target demand!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#txtDIF_targetDemand').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                //if ($('#txtDIF_targetDateTime').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter target date & time!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#txtDIF_targetDateTime').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                //if ($('#prevTxtAreaRemarks').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter remarks!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#prevTxtAreaRemarks').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                return true;
            }

            function removeComma() {
                $('.clsAddComa').each(function (index, element) {
                    var $val = $(this).val().replace(/,/g, '');
                    $(this).val($val);
                });
            }
            function addComma() {
                $('.clsAddComa').each(function (index, element) {
                    var $val = $(this).val().replace(/,/g, '');
                    $val = numberWithCommas($val);
                    $(this).val($val);
                });
            }
            function numberWithCommas(x) {
                // return x.toString().replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                x = x.toString();
                if (x % 1 == 0) {
                    if (x.indexOf(".") < 0) {
                        x = x.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                        x += ".0000";
                    } else {
                        x = x.replace('.0000', '').replace('.000', '').replace('.00', '').replace('.0', '');
                        x = x.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                        x += ".0000";

                    }
                } else {
                    var index = x.indexOf(".");
                    var p1 = x.substring(0, index);
                    p1 = p1.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    var p2 = x.substring(index);
                    p2 = p2 + "0000";
                    p2 = p2.substring(0, 5);
                    x = p1 + p2;
                }
                return x;
            }

            //misscleneous functions

            $('body').on('focus', "#txtDIF_targetDemand", function () {
                removeComma();
            });

            $('body').on('focusout', "#txtDIF_targetDemand", function () {
                addComma();
            });

            $('body').off('change', '#txtDIF_targetDemand');
            $('body').on('change', '#txtDIF_targetDemand', function (e) {
                e.preventDefault();
                var thisCtrl = $(this);
                if (parseInt(thisCtrl.val()) > parseInt($('#txtDIF_currentAvailability').html())) {
                    thisCtrl.val('');
                    swal({
                        title: "Warning",
                        text: "Target demand should be less than or equal to current availability!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => thisCtrl.focus(), 100)
                        }
                    });
                    return false;
                }
                addComma();

            });

            $('body').off('keypress', '.clsAddComa');
            $('body').on('keypress', '.clsAddComa', function (event) {
                var keyCode = event.keyCode || event.which;
                if (keyCode == 9) {
                    event.preventDefault();
                    // call custom function here
                }
                var $this = $(this);
                if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
                    ((event.which < 48 || event.which > 57) &&
                        (event.which != 0 && event.which != 8))) {
                    event.preventDefault();

                }

                var text = $(this).val();
                text = text.replace(/,/g, '');
                if ((event.which == 46) && (text.indexOf('.') == -1)) {
                    setTimeout(function () {
                        if ($this.val().substring($this.val().indexOf('.')).length > 5) {
                            $this.val($this.val().substring(0, $this.val().indexOf('.') + 5));
                        }
                    }, 1);
                }

                if ((text.indexOf('.') != -1) &&
                    (text.substring(text.indexOf('.')).length > 4) &&
                    (event.which != 0 && event.which != 8) &&
                    ($(this)[0].selectionStart >= text.length - 4)) {
                    event.preventDefault();
                }

            });


            $('body').off("paste", '.clsAddComa');
            $('body').on("paste", '.clsAddComa', function (e) {
                var thisCtrl = $(this);
                var text = e.originalEvent.clipboardData.getData('Text');
                text = text.replace(/,/g, '');
                if ($.isNumeric(text)) {
                    if ((text.substring(text.indexOf('.')).length >= 5) && (text.indexOf('.') > -1)) {
                        e.preventDefault();
                        thisCtrl.val(text.substring(0, text.indexOf('.') + 5));
                        thisCtrl.change();
                    }
                }
                else {
                    e.preventDefault();
                    swal({
                        title: "Invalid Input",
                        text: "Please enter only numeric values!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => thisCtrl.focus(), 100)
                        }
                    });
                }
            });
        });//END OF DOC READY


    </script>
</div>