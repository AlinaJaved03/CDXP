
@{
    ViewBag.Title = "View Despatch Details";
}
<div id="pcontent">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
            <div class="panel panel-default card-view panel-refresh">
                <div class="refresh-container">
                    <div class="la-anim-1"></div>
                </div>
                <div class="panel-heading">
                    <div class="pull-left" style="display: inline-flex;">
                        <i class="fa fa-wpforms" style="padding-top: 4px;margin-right: 5px;color:#fff;"></i>
                        <h6 class="panel-title txt-light">@ViewBag.Title</h6>
                    </div>
                    <div class="pull-right">
                        <a class="pull-left inline-block mr-15" data-toggle="collapse" href="#collapse_1" aria-expanded="true">
                            <i class="zmdi zmdi-chevron-down"></i>
                            <i class="zmdi zmdi-chevron-up"></i>
                        </a>


                        <a href="#" class="pull-left inline-block full-screen mr-15">
                            <i class="zmdi zmdi-fullscreen"></i>
                        </a>

                    </div>
                    <div class="clearfix"></div>
                </div>
                <div id="collapse_1" class="panel-wrapper collapse in">
                    <div class="panel-body">

                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Header</div>
                            <div class="tab2">&nbsp;</div>
                        </div>



                        <div style="margin-bottom: 20px;">
                            <table class="tblFrm">
                                <tr>

                                    <td style="width: 25%;">
                                        <label for="ddlIPP">Power Producer <span class="clsstar" style="color:rgb(0, 149, 235);font-size: 20px;">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select id="ddlIPP" class="form-control">@Html.Raw(@ViewBag.IPP)</select>
                                    </td>

                                    <td style="width: 25%;">
                                        <label for="txtStatus">Status</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtStatus" type="text" value="Draft" readonly class="form-control">
                                    </td>

                                </tr>

                               
                                <tr>

                                    <td style="width: 25%;">
                                        <label for="ddlSite">Producer Site <span class="clsstar" style="color:rgb(0, 149, 235);font-size: 20px;">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select id="ddlSite" class="form-control"></select>
                                    </td>

                                    <td><label>Submit Date</label></td>

                                    <td><input id="txtSubmitDate" type="text" disabled class="form-control" /></td>

                                   
                                </tr>


                                <tr>

                                    <td style="width: 25%;">
                                        <label for="ddlBlock"> Block / Complex <span class="clsstar" style="color: rgb(0, 149, 235); font-size: 20px;">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select id="ddlBlock" class="form-control">
                                            <option>Select</option>
                                        </select>
                                    </td>

                                    <td style="width: 25%;">
                                        <label for="txtTargetDate">Declaration for<span class="clsstar" style="color:rgb(0, 149, 235);font-size: 20px;">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtTargetDate" type="text" disabled class="form-control" style="background-color: rgb(251, 255, 193)" />
                                    </td>
                                    


                                </tr>

                                <tr>
                                    <td style="width: 25%;">
                                        <label for="txtFuel">Fuel</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtFuel" type="text" readonly value="GAS" class="form-control" />
                                    </td>

                                    <td style="width: 25%;">
                                        <label for="txtINTIMATION_DATE_TIME">Intimation Date & Time<span class="clsstar" style="color:rgb(0, 149, 235);font-size: 20px;">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtINTIMATION_DATE_TIME" type="text" value="@ViewBag.IntimationTime" class="form-control dtDateTime" style="background-color: rgb(251, 255, 193)" />
                                    </td>
                                </tr>


                               
                                <tr>

                                   
                                    
                                    <td style="width: 25%;"><label for="txtRevisedAvailablity" class="pol1994" style="display: none;">Revised Availability</label></td>
                                    <td style="width: 25%;"><input id="txtRevisedAvailablity" type="text" value="0" class="form-control pol1994" style="display: none;background: #ffff0045;" /></td>
                                    <td style="padding-left: 0px !important;"><span style="display: none;" class="pol1994">MW</span></td>

                                </tr>



                                <tr>
                                    <td style="width: 25%;">
                                        <label for="txtCapacity">Installed Capacity</label>
                                    </td>
                                    <td style="width: 25%;">

                                        <input id="txtCapacity" type="text" readonly value="" class="form-control">
                                    </td>


                                    <td style="width: 25%;">
                                    </td>
                                    <td style="width: 25%;">
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="txtDependableCapacity">Dependable Capacity</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtDependableCapacity" readonly type="text" value="" class="form-control" />
                                    </td>
                                    <td style="width: 25%;">
                                    </td>
                                    <td style="width: 25%;">
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="txtPowerPolicy">Power Policy</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="txtPowerPolicy" readonly type="text" value="" class="form-control" />
                                    </td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>

                            </table>


                        </div>@*End Of Table*@

                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Despatch Detail</div>
                            <div class="tab2">&nbsp;</div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <style type="text/css">
                                #tblHourlyData > tbody > tr > td:nth-child(2) > input, #tblHourlyData > tbody > tr > td:nth-child(3) > input, #tblHourlyData > tbody > tr > td:nth-child(6) > input {
                                    background-color: rgb(251, 255, 193);
                                    text-align: right;
                                }
                            </style>
                            <table class="tablesaw table-bordered table-hover table" data-tablesaw-mode="swipe" id="tblHourlyData">
                                <thead>
                                    <tr>
                                        <th style="width:50px;text-align:Center;" rowspan="2">00:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">01:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">02:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">03:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">04:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">05:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">06:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">07:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">08:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">09:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">010:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">011:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">012:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">013:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">014:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">015:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">016:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">017:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">018:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">019:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">020:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">021:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">022:00</th>
                                        <th style="width:50px;text-align:Center;" rowspan="2">023:00</th>
                                        

                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 4 || ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 7)// 4)
                        {
                            <div class="tab0">
                                &nbsp;<div class="tab1">&nbsp;Power Producer</div>
                                <div class="tab2">&nbsp;</div>
                            </div>

                            <div style="margin-bottom: 20px;">
                                <table class="tblFrm" style="width:100%;">
                                    <tr>
                                        <td style="width: 19%;">
                                            <label for="txtSENDER_NAME">Sender Name</label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtSENDER_NAME" disabled type="text" value="@ViewBag.userinfo.DISPLAY_NAME" class="form-control frm">
                                        </td>
                                        <td style="width: 25%;">
                                            <label for="txtSENDER_DESIGNATION">Sender Designation</label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtSENDER_DESIGNATION" disabled type="text" value="@ViewBag.userinfo.DISPLAY_DESIGNATION" class="form-control frm">
                                        </td>
                                    </tr>
                                   
                                </table>


                                @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 4 && ViewBag.sts != "Acknowledged")
                                {
                                    <div class="form-actions">
                                        <div class="row">
                                            <div class="col-md-12" style="text-align:right;">

                                                <button id="btnSubmitRDAC" tag=@ViewBag.WP_GC_HOURLY_DATA_HEADER_ID_PK dacid="@ViewBag.dacid" typ="Submitted" class="btn btn-success" style="margin-right:20px;" type="button">Submit</button>
                                                <button id="btnSaveRDAC" tag=@ViewBag.WP_GC_HOURLY_DATA_HEADER_ID_PK dacid="@ViewBag.dacid" typ="Draft" class="btn btn-default" type="button" style="margin-right:20px;display:none;">Save</button>
                                                <button class="btn btn-default btnCloseRDAC" conn="@(ViewBag.conn ?? String.Empty)" tag="@(ViewBag.WP_GC_HOURLY_DATA_HEADER_ID_PK ?? String.Empty)" type="button">Close</button>

                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        }

                        @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 7 || ViewBag.sts == "Acknowledged")
                        {
                            <div class="tab0">
                                &nbsp;<div class="tab1">&nbsp;NPCC Remarks</div>
                                <div class="tab2">&nbsp;</div>
                            </div>

                            <div style="margin-bottom: 20px;">

                                <table class="tblFrm" style="width:100%;">
                                    <tr>
                                        <td style="width: 19%;">
                                            <label for="Disconame">Receiver Name</label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtRECEIVER_NAME" disabled type="text" value="@ViewBag.userinfo.DISPLAY_NAME" class="form-control frm">
                                        </td>
                                        <td style="width: 25%;">
                                            <label for="Disconame">Receiver Designation</label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input id="txtRECEIVER_DESIGNATION" disabled type="text" value="@ViewBag.userinfo.DISPLAY_DESIGNATION" class="form-control frm">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="vertical-align:top;">
                                            Notes
                                        </td>
                                        <td colspan="3">
                                            <textarea id="txtRECEIVER_REMARKS" cols="70" rows="6" maxlength="2000" class="frm" style="width: 100%;"></textarea>
                                        </td>
                                    </tr>
                                </table>
                                <div class="form-actions">
                                    <div class="row">
                                        <div class="col-md-12" style="text-align:right;">

                                            <button id="btnAcknowledgeRDAC" class="btn btn-success" type="button" style="margin-right:20px;">Acknowledge</button>
                                            <button class="btn btn-default btnCloseRDAC" type="button" conn="@(ViewBag.conn ?? String.Empty)" tag="@(ViewBag.WP_GC_HOURLY_DATA_HEADER_ID_PK ?? String.Empty)">Close</button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {

            $('body').off('click', '#btnAcknowledgeRDAC');
            $('body').on('click', '#btnAcknowledgeRDAC', function (e) {
                e.preventDefault();
                var $data = '12½' + $('.btnCloseRDAC').attr('tag') + '½' + $('#txtRECEIVER_NAME').val() + '½' + $('#txtRECEIVER_DESIGNATION').val() + '½' + $('#txtRECEIVER_REMARKS').val() + '½';
                var fromdata = new FormData();
                fromdata.append("vls", $data);


                swal({
                    title: "Are you sure?",
                    text: "Do you really want to acknowledge record?",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonClass: "btn-danger",
                    confirmButtonText: "Yes, Acknowledge it!",
                    closeOnConfirm: false
                },
                    function () {
                        $('.sa-button-container').hide();
                        $.ajax({
                            type: "POST",
                            url: "/NPCC/AjaxCall" + $(location).attr("search"),
                            data: fromdata,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                $('.sa-button-container').show();
                                swal("Success!", "Record has been Acknowledged Successfully.", "success");
                                $($('.btnCloseRDAC')[0]).click()
                            }
                        });
                    }

                );





            });//END OF CLCICK

            $('body').off('change', '#txtHOURLY_DATA_TYPE');
            $('body').on('change', '#txtHOURLY_DATA_TYPE', function (e) {
                e.preventDefault();

                if ($(this).val() == "ADAC") {
                    var fromdata = new FormData();
                    fromdata.append("vls", '7');
                    $.ajax({
                        type: "POST",
                        url: "/NPCC/AjaxCall" + $(location).attr("search"),
                        data: fromdata,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            $('#tblHourlyData > tbody > tr').each(function (index, element) {
                                var $tr = $(this);
                                if (index <= parseInt(response)) {
                                    $($tr.find('td')[5]).html('');
                                    $($tr.find('td')[6]).html('');
                                }
                                else {
                                    $($tr.find('td')[1]).html('<input type="text" class="form-control" value="' + $($tr.find('td')[1]).attr('tg') + '">');
                                    $($tr.find('td')[2]).html('<input type="text" class="form-control" value="' + $($tr.find('td')[2]).attr('tg') + '">');
                                }
                            });
                        }
                    });
                    $('#ddlRevisionType').html('<option></option>');
                    $('.forRDAC').hide();
                }
                else {
                    $('#tblHourlyData > tbody > tr').each(function (index, element) {
                        var $tr = $(this);
                        $($tr.find('td')[5]).html('<input type="text" class="form-control" value="">');
                        $($tr.find('td')[6]).html('<input type="text" class="form-control" value="">');
                        $($tr.find('td')[1]).html($($tr.find('td')[1]).attr('tg'));
                        $($tr.find('td')[2]).html($($tr.find('td')[2]).attr('tg'));
                    });
                    $('#ddlRevisionType').html('<option>Fuel Change Over</option><option>Upward Revision</option><option>Downward Revision</option>');
                    $('.forRDAC').show();
                }

            });

            $('body').off('click', '#btnSaveRDAC, #btnSubmitRDAC');
            $('body').on('click', '#btnSaveRDAC, #btnSubmitRDAC', function (e) {
                e.preventDefault();
                if ($('#ddlBlock').val() == null || $('#ddlBlock').val() == undefined) {
                    swal({
                        title: "Error",
                        text: "Please select valid block!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#invoiceDate').focus(), 100);
                        }
                    });
                    return false;
                }
                var $data = '6½' + $(this).attr('tag') + '½' + $(this).attr('typ') + '½' +
                    $('#txtHOURLY_DATA_TYPE').val() +
                    '½' +
                    $('#ddlSite').val() +
                    '½' +
                    $('#txtPowerPolicy').val() +
                    '½' +
                    $('#txtTargetDate').val() +
                    '½' +
                    $('#txtINTIMATION_DATE_TIME').val() +
                    '½';

                $('.frm').each(function (index, element) {
                    $data += $(this).val() + '½';
                });
                $data += $('#ddlBlock').val().split('½')[0] + '½' + $('#btnSubmitRDAC').attr('dacid') + "½" + $('#ddlRevisionType').val();
                var $DTL = "";
                if ($(this).attr('tag') == "0") {
                    $('#tblHourlyData > tbody > tr').each(function (index, element) {
                        if ($('#txtHOURLY_DATA_TYPE').val() == "RDAC") {
                            $DTL += $.trim($($(this).find('td')[0]).html()) + '½' + $.trim($($(this).find('td')[1]).html()) + '½' + $.trim($($(this).find('td')[2]).html()) + '½' + $($($(this).find('td')[5]).find('input')[0]).val() + '½' + $($($(this).find('td')[6]).find('input')[0]).val() + '│';
                        } else {
                            if ($($(this).find('td')[1]).find('input').length > 0) {
                                $DTL += $.trim($($(this).find('td')[0]).html()) + '½' + $($($(this).find('td')[1]).find('input')[0]).val() + '½' + $($($(this).find('td')[2]).find('input')[0]).val() + '½' + $($($(this).find('td')[5]).find('input')[0]).val() + '½' + $($($(this).find('td')[6]).find('input')[0]).val() + '│';
                            }
                            else {
                                $DTL += $.trim($($(this).find('td')[0]).html()) + '½' + $.trim($($(this).find('td')[1]).html()) + '½' + $.trim($($(this).find('td')[2]).html()) + '½' + $.trim($($(this).find('td')[5]).html()) + '½' + $.trim($($(this).find('td')[6]).html()) + '│';
                            }
                        }

                    });
                }
                else {
                    $('#tblHourlyData > tbody > tr').each(function (index, element) {
                        if ($('#txtHOURLY_DATA_TYPE').val() == "RDAC") {
                            $DTL += $(this).attr('tag') + '½' + $($(this).find('td')[1]).html() + '½' + $($(this).find('td')[2]).html() + '½' + $($($(this).find('td')[5]).find('input')[0]).val() + '½' + $($($(this).find('td')[6]).find('input')[0]).val() + '│';

                        } else {
                            if ($($(this).find('td')[1]).find('input').length > 0) {
                                $DTL += $(this).attr('tag') + '½' + $($($(this).find('td')[1]).find('input')[0]).val() + '½' + $($($(this).find('td')[2]).find('input')[0]).val() + '½' + $($($(this).find('td')[5]).find('input')[0]).val() + '½' + $($($(this).find('td')[6]).find('input')[0]).val() + '│';
                            }
                            else {
                                $DTL += $(this).attr('tag') + '½' + $.trim($($(this).find('td')[1]).html()) + '½' + $.trim($($(this).find('td')[2]).html()) + '½' + $.trim($($(this).find('td')[5]).html()) + '½' + $.trim($($(this).find('td')[6]).html()) + '│';
                            }


                        }

                    });
                }

                $DTL += '½';
                $DTL = $DTL.replace('│½', '');
                var fromdata = new FormData();
                fromdata.append("vls", $data);
                fromdata.append("dtl", $DTL);

                swal({
                    title: "Are you sure?",
                    text: "Do you really want to Submit Record?",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonClass: "btn-danger",
                    confirmButtonText: "Yes, Submit it!",
                    closeOnConfirm: false
                },
                    function () {
                        $('.sa-button-container').hide();
                        $.ajax({
                            type: "POST",
                            url: "/NPCC/AjaxCall" + $(location).attr("search"),
                            data: fromdata,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                $('.sa-button-container').show();
                                swal("Success!", "Record has been submitted Successfully.", "success");
                                $($('.btnCloseRDAC')[0]).click()
                            }
                        });

                    }
                );
            });

            $('body').off('focus', '.dtDateTime');
            $('body').on('focus', '.dtDateTime', function () {
                $(this).datetimepicker({
                    format: 'DD-MMM-YYYY HH:mm'
                });
            });

            $('body').off('click', '.btnCloseRDAC');
            $('body').on('click', '.btnCloseRDAC', function (e) {
                e.preventDefault();
                var options = {};
                $("#pageContainer").hide('slide', options, 300);
                $.ajax({
                    url: "/NPCC/ViewAndEditDespatch" + $(location).attr('search'),
                    success: function (result) {
                        var options = {};
                        $('#pageContainer').html($(result).find('#pcontent').html());
                        $("#pageContainer").show('slide', options, 500);
                    }
                });
            });//End of edit click
            $('body').off('change', '#ddlIPP');
            $('body').on('change', '#ddlIPP', function (e) {
                LoadVendorSites();
            });// End of change
            $('body').off('change', '#ddlSite');
            $('body').on('change', '#ddlSite', function (e) {
                LoaddllBlockFuel();
            });// End of change

            $('body').off('change', '#ddlBlock');
            $('body').on('change', '#ddlBlock', function (e) {
                if ($('#ddlBlock').val() != null || $('#ddlBlock').val() != undefined) {
                    $('#txtFuel').val($('#ddlBlock').val().split('½')[1]);
                    $('#txtCapacity , #txtDependableCapacity').val($('#ddlBlock').val().split('½')[2]);
                    $('#txtPowerPolicy').val($('#ddlBlock').val().split('½')[3]);

                }
                else {
                    $('#txtFuel').val('');
                }
            });// End of

            $(function () {
                debugger;
                if ($('.btnCloseRDAC').attr('tag') == "0") {
                    LoadForNewByDAC();
                }
                else {
                    debugger;
                    LoadVendorSitesAndDetails();
                }

            });//End
            function LoadVendorSites() {
                var fromdata = new FormData();
                fromdata.append('vls', '0½' + $('#ddlIPP').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlSite').html(response);
                        if ($('#ddlSite').val() != null || $('#ddlSite').val() != undefined) {
                            LoaddllBlockFuel();
                        }
                        else {
                            $('#ddlBlock').html('');
                            $('#txtFuel').val('');
                            $('#txtPowerPolicy').val('');
                        }
                    }
                });
            }//END OF LOAD
            function LoadForNewByDAC() {
                var fromdata = new FormData();
                fromdata.append("vls", '23½' + @ViewBag.DISPACTH_DETAIL_ID);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var $dta = $.parseJSON(response);

                        //$('#txtHOURLY_DATA_TYPE').val($dta[0].HOURLY_DATA_TYPE);
                        //$('#txtStatus').val($dta[0].STATUS);
                        $('#txtSubmitDate').val($dta[0].TARGET_DATE);
                        //$('#ddlRevisionType').val($dta[0].REVISION_TYPE);
                        //$('#txtHOURLY_DATA_TYPE').change();
                        $('#ddlIPP').html($dta[0].ddlIPP);
                        $('#ddlSite').html($dta[0].ddlSite);
                        $('#ddlBlock').html($dta[0].ddlBlock);
                        $('#txtFuel').val($dta[0].fuel);
                        $('#txtCapacity , #txtDependableCapacity').val($dta[0].capacity);
                        $('#txtPowerPolicy').val($dta[0].policiy);
                        $('#txtTargetDate').val($dta[0].TARGET_DATE);
                        $('#txtINTIMATION_DATE_TIME').val($dta[0].INTIMATION_DATE_TIME);
                        //$('#txtSENDER_NAME').val($dta[0].SENDER_NAME);
                        //$('#txtSENDER_DESIGNATION').val($dta[0].SENDER_DESIGNATION);
                        //$('#txtSENDER_REMARKS').val($dta[0].SENDER_REMARKS);
                        // $('#txtRECEIVER_NAME').val($dta[0].RECEIVER_NAME);
                        // $('#txtRECEIVER_DESIGNATION').val($dta[0].RECEIVER_DESIGNATION);
                        // $('#txtRECEIVER_REMARKS').val($dta[0].RECEIVER_REMARKS);

                       

                        if ($('#txtStatus').val() != "Draft") {
                            $('#btnImprtPre').remove();
                            $('#btnSubmitRDAC').remove();
                            $('#btnSaveRDAC').remove();
                            $('#ddlIPP').prop('disabled', true);
                            $('#ddlSite').prop('disabled', true);
                            $('#ddlBlock').prop('disabled', true);
                            $('#txtTargetDate').prop('readonly', true);
                            // $('#txtINTIMATION_DATE_TIME').prop('readonly', true);
                            // $('#txtSENDER_NAME').prop('readonly', true);
                            //  $('#txtSENDER_DESIGNATION').prop('readonly', true);
                            // $('#txtSENDER_REMARKS').prop('disabled', true);
                            //  $('#txtRECEIVER_NAME').prop('readonly', true);
                            // $('#txtRECEIVER_DESIGNATION').prop('readonly', true);
                            // $('#txtRECEIVER_REMARKS').prop('disabled', true);
                            debugger;
                           
                                $('#tblHourlyData tbody').append('<tr tag="' + @ViewBag.DISPACTH_DETAIL_ID + '">\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_0 + '">' + $dta[0].HOUR_0 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_01 + '">' + $dta[0].HOUR_01 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_02 + '">' + $dta[0].HOUR_02 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_03 + '">' + $dta[0].HOUR_03 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_04 + '">' + $dta[0].HOUR_04 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_05 + '">' + $dta[0].HOUR_05 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_06 + '">' + $dta[0].HOUR_06 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_07 + '">' + $dta[0].HOUR_07 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_08 + '">' + $dta[0].HOUR_08 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_09 + '">' + $dta[0].HOUR_09 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_010 + '">' + $dta[0].HOUR_010 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_011 + '">' + $dta[0].HOUR_011 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_012 + '">' + $dta[0].HOUR_012 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_013 + '">' + $dta[0].HOUR_013 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_014 + '">' + $dta[0].HOUR_014 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_015 + '">' + $dta[0].HOUR_015 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_016 + '">' + $dta[0].HOUR_016 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_017 + '">' + $dta[0].HOUR_017 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_018 + '">' + $dta[0].HOUR_018 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_019 + '">' + $dta[0].HOUR_019 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_020 + '">' + $dta[0].HOUR_020 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_021 + '">' + $dta[0].HOUR_021 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_022 + '">' + $dta[0].HOUR_022 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_023 + '">' + $dta[0].HOUR_023 + '</td>\
                                                </tr>');
                           
                        } else {
                            $('#txtTargetDate').prop('readonly', true);
                            debugger;
                                $('#tblHourlyData tbody').append('<tr tag="' + @ViewBag.DISPACTH_DETAIL_ID + '">\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_0 + '">' + $dta[0].HOUR_0 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_01 + '">' + $dta[0].HOUR_01 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_02 + '">' + $dta[0].HOUR_02 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_03 + '">' + $dta[0].HOUR_03 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_04 + '">' + $dta[0].HOUR_04 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_05 + '">' + $dta[0].HOUR_05 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_06 + '">' + $dta[0].HOUR_06 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_07 + '">' + $dta[0].HOUR_07 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_08 + '">' + $dta[0].HOUR_08 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_09 + '">' + $dta[0].HOUR_09 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_010 + '">' + $dta[0].HOUR_010 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_011 + '">' + $dta[0].HOUR_011 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_012 + '">' + $dta[0].HOUR_012 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_013 + '">' + $dta[0].HOUR_013 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_014 + '">' + $dta[0].HOUR_014 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_015 + '">' + $dta[0].HOUR_015 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_016 + '">' + $dta[0].HOUR_016 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_017 + '">' + $dta[0].HOUR_017 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_018 + '">' + $dta[0].HOUR_018 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_019 + '">' + $dta[0].HOUR_019 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_020 + '">' + $dta[0].HOUR_020 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_021 + '">' + $dta[0].HOUR_021 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_022 + '">' + $dta[0].HOUR_022 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_023 + '">' + $dta[0].HOUR_023 + '</td>\
                                                </tr>');
                          
                        }

                    }
                });
            }
            function LoadVendorSitesAndDetails() {
                var fromdata = new FormData();
                fromdata.append("vls", '23½' + @ViewBag.DISPACTH_DETAIL_ID);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var $dta = $.parseJSON(response);

                        $('#txtStatus').val($dta[0].STATUS);
                        $('#ddlIPP').html($dta[0].ddlIPP);
                        $('#ddlSite').html($dta[0].ddlSite);
                        $('#ddlBlock').html($dta[0].ddlBlock);
                        $('#txtFuel').val($dta[0].fuel);
                        $('#txtCapacity , #txtDependableCapacity').val($dta[0].capacity);
                        $('#txtPowerPolicy').val($dta[0].policiy);
                        if ($('#txtPowerPolicy') == "1994") {
                            $('.pol1994').show();
                        }
                        $('#txtSubmitDate').val($dta[0].TARGET_DATE);
                        $('#txtTargetDate').val($dta[0].TARGET_DATE);

                        debugger;
                         
                                $('#tblHourlyData tbody').append('<tr tag="' + @ViewBag.DISPACTH_DETAIL_ID + '">\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_0 + '">' + $dta[0].HOUR_0 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_01 + '">' + $dta[0].HOUR_01 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_02 + '">' + $dta[0].HOUR_02 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_03 + '">' + $dta[0].HOUR_03 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_04 + '">' + $dta[0].HOUR_04 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_05 + '">' + $dta[0].HOUR_05 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_06 + '">' + $dta[0].HOUR_06 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_07 + '">' + $dta[0].HOUR_07 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_08 + '">' + $dta[0].HOUR_08 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_09 + '">' + $dta[0].HOUR_09 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_010 + '">' + $dta[0].HOUR_010 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_011 + '">' + $dta[0].HOUR_011 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_012 + '">' + $dta[0].HOUR_012 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_013 + '">' + $dta[0].HOUR_013 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_014 + '">' + $dta[0].HOUR_014 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_015 + '">' + $dta[0].HOUR_015 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_016 + '">' + $dta[0].HOUR_016 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_017 + '">' + $dta[0].HOUR_017 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_018 + '">' + $dta[0].HOUR_018 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_019 + '">' + $dta[0].HOUR_019 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_020 + '">' + $dta[0].HOUR_020 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_021 + '">' + $dta[0].HOUR_021 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_022 + '">' + $dta[0].HOUR_022 + '</td>\
                                                <td style="text-align:right;" tg="'+ $dta[0].HOUR_023 + '">' + $dta[0].HOUR_023 + '</td>\
                                                </tr>');


                    



                    

                        if ($('#txtStatus').val() != "Draft") {

                            
                            $('#txtINTIMATION_DATE_TIME,#txtTargetDate').css('background', '#eee');
                            $('#txtINTIMATION_DATE_TIME').prop('disabled', true);
                            $('#btnSubmitRDAC').remove();
                            $('#btnSaveRDAC').remove();
                            $('#ddlIPP').prop('disabled', true);
                            $('#ddlSite').prop('disabled', true);
                            $('#ddlBlock').prop('disabled', true);
                            $('#txtTargetDate').prop('readonly', true);
                            $('#txtINTIMATION_DATE_TIME').prop('readonly', true);
                            $('#txtSENDER_NAME').prop('readonly', true);
                            $('#txtSENDER_DESIGNATION').prop('readonly', true);
                            //$('#txtSENDER_REMARKS').prop('disabled', true);


                            
                           
                        }

                    }
                });
            }
            function LoaddllBlockFuel() {
                var fromdata = new FormData();
                fromdata.append('vls', '1½' + $('#ddlSite').val() + "½" + $('#ddlIPP').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlBlock').html(response);
                        if ($('#ddlBlock').val() != null || $('#ddlBlock').val() != undefined) {
                            $('#txtFuel').val($('#ddlBlock').val().split('½')[1]);
                            $('#txtCapacity , #txtDependableCapacity').val($('#ddlBlock').val().split('½')[2]);
                            $('#txtPowerPolicy').val($('#ddlBlock').val().split('½')[3]);
                        }
                        else {
                            $('#txtFuel').val('');
                            $('#txtPowerPolicy').val('');
                        }
                    }
                });
            }
        });
    </script>
</div>
