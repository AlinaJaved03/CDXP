@{
    ViewBag.Title = "Plant Event";
}
<div id="pcontent">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0px;">
            <div class="panel panel-default card-view panel-refresh">
                <div class="refresh-container">
                    <div class="la-anim-1"></div>
                </div>
                <div class="panel-heading">
                    <div class="pull-left" style="display: inline-flex;">
                        <i class="fa fa-wpforms" style="padding-top: 4px;margin-right: 5px;color:#fff;"></i>
                        <h6 class="panel-title txt-light">@ViewBag.Title</h6>
                    </div>
                    <div class="pull-right">
                        <a class="pull-left inline-block mr-15" data-toggle="collapse" href="#collapse_1" aria-expanded="true">
                            <i class="zmdi zmdi-chevron-down"></i>
                            <i class="zmdi zmdi-chevron-up"></i>
                        </a>


                        <a href="#" class="pull-left inline-block full-screen mr-15">
                            <i class="zmdi zmdi-fullscreen"></i>
                        </a>
                        @*<a class="pull-left inline-block close-panel" href="#" data-effect="fadeOut">
                                <i class="zmdi zmdi-close"></i>
                            </a>*@
                    </div>
                    <div class="clearfix"></div>
                </div>
                <div id="collapse_1" class="panel-wrapper collapse in">
                    <div class="panel-body">

                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Header</div>
                            <div class="tab2">&nbsp;</div>
                        </div>



                        <div style="margin-bottom: 20px;">
                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="ddlIPP_Cat">Category<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC Ipp" id="ddlIPP_Cat" required>
                                            @Html.Raw(@ViewBag.IPP)
                                        </select>
                                    </td>

                                </tr>

                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Power Producer<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_IPP" required>
                                        </select>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame" id="">Producer Site<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;display:none;">

                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_Site" required></select>
                                    </td>
                                </tr>


                                <tr>

                                    <td style="width: 25%;">
                                        <label for="Disconame">Fuel</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="txtPEF_Fuel" required>
                                        </select>
                                    </td>

                                    <td style="width: 25%;">
                                        <label for="Disconame">Unit / Complex<span class="startColor">*</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_CBF" required>
                                        </select>
                                    </td>
                                </tr>


                                <tr>
                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame">Power Policy</label>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <input type="text" readonly value="" class="form-control frm" style="text-align:right;" id="txtPEF_PowerPolicy" name="">
                                    </td>

                                    <td style="width: 25%; display:none;">
                                        <label for="Disconame">Address</label>
                                    </td>
                                    <td style="width: 25%; display:none;">
                                        <input type="text" value="" class="form-control " id="txtPEF_Address" name="">
                                    </td>

                                </tr>

                                <tr>
                                    <td style="width: 25%;display:none">
                                        <label for="Disconame">Installed Capacity (MW)</label>
                                    </td>
                                    <td style="width: 25%;display:none" ">
                                        <input type="text" style="display:none; text-align:right;" value="" readonly class="form-control frm" id="txtPEF_InstalledCap">

                                    </td>

                                    <td style="width: 25%;">
                                        <label for="Disconame">Dependant Capacity (MW)</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" style="display:inline-block;  text-align:right;" value="" readonly class="form-control frm" id="txtPEF_DependantCap">

                                    </td>

                                </tr>

                            </table>




                        </div>@*End Of Table*@
                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Event</div>
                            <div class="tab2">&nbsp;</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <table class="tblFrm">


                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Event Type<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_Event" required>
                                            @*<option selected="selected" value="">Select</option>*@
                                            @* 8/10<option>Made Available</option>*@
                                            <option>Desync</option>
                                            <option>Sync</option>
                                            <option>Supply Failure</option>
                                            <option>Supply Restoration</option>
                                            <option>Declaration Of PFO</option>
                                            <option>Availability After PFO</option>
                                            <option>Miscellaneous</option>

                                            @*<option>Tripping</option>*@
                                        </select>
                                    </td>
                                    <td></td>
                                    <td></td>



                                </tr>

                                <tr id="trPEF_TypeOfOutage">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="OutageLabel">Type of Outage<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_TypeOfOutage" required>
                                            <option>Forced Outage</option>
                                            @*<option>Partial Outage</option>*@
                                            <option>Scheduled Outage</option>
                                            <option>Supply Failure</option>
                                            <option>Standby</option>
                                        </select>
                                    </td>

                                </tr>

                                <tr id="trPEF_EventReason">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="labelddlPEF_Reason">Reason<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_Reason" required>
                                            <option>Technical Problem</option>
                                            <option>Fuel Constraints</option>
                                            <option>Others</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr id="trPEF_ReasonDetail" style="display:none;">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="labelddlPEF_ReasonDetail">Detail (For Reason)</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input style="display:inline-block; text-align:left;" type="text" class="form-control requiredFieldBGC frm" id="txtPEF_ReasonDetail" required>

                                    </td>

                                </tr>

                                @*New Code for Sync Status  *@


                                @*<tr id="trPEF_StatusBeforeSync" style="display: none;">
                                        <td style="width: 25%;">
                                            <label for="Disconame" id="StatusSync">Status Before Sync<span class="startColor"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <select class="form-control frm requiredFieldBGC" id="ddlPEF_StatusSync" required>
                                                <option>Force Outage</option>
                                                <option>Partial Outage</option>
                                                <option>Scheduled Outage</option>
                                                <option>Supply Failure</option>
                                                <option></option>

                                            </select>
                                        </td>
                                    </tr>*@

                                @*New Code for Sync Status  *@


                                <tr id="trPEF_StatusOfMachine" style="display:none;">
                                    <td style="width: 25%;">
                                        <label id="StatusLabel">Status of Complex<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frm requiredFieldBGC" id="ddlPEF_StatusOfMachine" required>
                                            <option></option>
                                        </select>
                                    </td>
                                </tr>

                                <tr id="trPEF_Availability" style="display:none">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Before Event Availability<span class="startColor"> (MW) *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frm requiredFieldBGC clsAddComa" id="txtPEFBE_Availability" required>

                                    </td>

                                    <td style="width: 25%;">
                                        <label for="Disconame">After Event Availability<span class="startColor"> (MW) *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frm requiredFieldBGC clsAddComa" id="txtPEF_Availability" required>

                                    </td>
                                </tr>

                                <tr id="trPEF_Availability_Complex" style="display:none">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Before Event Availability<span class="startColor"> (MW PER COMPLEX) *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frm requiredFieldBGC clsAddComa" id="txtPEFBEC_Availability" required>

                                    </td>

                                    <td style="width: 25%;">
                                        <label for="Disconame">After Event Availability<span class="startColor"> (MW PER COMPLEX) *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frm requiredFieldBGC clsAddComa" id="txtPEFC_Availability" required>

                                    </td>
                                </tr>



                                @*<tr>
                                        <td style="width: 25%;">
                                            <label for="Disconame">Availability Before Event<span class="startColor"> *</span></label>
                                        </td>
                                        <td style="width: 25%; ">
                                            <input style="display:inline-block; width:90%; text-align:right;" type="text" value="" class="form-control frm requiredFieldBGC clsAddComa" id="txtPEF_Availability_BeforEvent" required>
                                            <label style="display:inline-block;">MW</label>
                                        </td>
                                    </tr>*@

                                <tr>
                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame">Last Demand<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" class="form-control  requiredFieldBGC clsAddComa" id="txtPEF_LastDemand" readonly>
                                    </td>

                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame">Demand Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <input id="datePEF_DemandDateTime" value="@ViewBag.currentDate" type="text" class="form-control  dtDateTime requiredFieldBGC" readonly>

                                    </td>
                                </tr>
                                <tr id="trderated_cap">

                                    <td style="width: 25%;">
                                        <label for="Disconame" id="Derated_Cap">Capacity<span class="startColor"> *</span></label>
                                    </td>

                                    <td>
                                        <input type="text" style="display:inline-block;   text-align:left;" value="" readonly class="form-control frm requiredFieldBGC" id="txtPEF_DeratedCap">
                                    </td>



                                </tr>
                                <tr id="trlaststatus">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="Last_Event">Last Status<span class="startColor"> *</span></label>
                                    </td>

                                    <td>
                                        <input type="text" style="display:inline-block;   text-align:left;" value="" readonly class="form-control frm requiredFieldBGC" id="txtPEF_lastEvent">
                                    </td>
                                </tr>

                                <tr id="trevent_dt">
                                    <td style="width: 25%;">
                                        <label for="Disconame">Event Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="datePEF_EventTime" value="@ViewBag.currentDate" type="text" class="form-control frm dtDateTime requiredFieldBGC" required>

                                    </td>
                                </tr>

                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Intimation Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="datePEF_IntimationTime" value="" type="datetime" readonly class="form-control frm dtDateTime requiredFieldBGC" required>

                                    </td>
                                </tr>

                                <tr id="trPEF_Miscellaneous_message" style="display:none">
                                    <td style="width: 25%;vertical-align:top;">
                                        <label>Message<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;" colspan="3">
                                        <textarea cols="70" rows="26" maxlength="6000" class="requiredFieldBGC frm" id="txtPEF_Message" style="width: 100%;" required></textarea>
                                    </td>

                                </tr>

                            </table>


                        </div>

                        @*Remarks starting*@

                        <div class="tab0">
                            &nbsp;<div class="tab1">&nbsp;Remarks</div>
                            <div class="tab2">&nbsp;</div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <table class="tblFrm">
                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Sender Name</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.name" placeholder="@ViewBag.name" class="form-control frm" id="txtPEF_SenderName" >
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Sender Designation</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.designation" placeholder="@ViewBag.designation" class="form-control frm" id="txtPEF_SenderDesg" >
                                    </td>
                                </tr>

                                <tr>
                                    <td style="width: 25%;vertical-align:middle;">
                                        <label>Remarks</label>
                                    </td>
                                    <td style="width: 25%;" colspan="3">
                                        <textarea cols="70" rows="6" maxlength="2000" class="requiredFieldBGC frm" id="txtPEF_Remarks" style="width: 100%;"></textarea>

                                    </td>


                                </tr>
                            </table>
                        </div>
                        @*Remarks Ending*@


                        <div class="form-actions">
                            <div class="row">
                                <div class="col-md-12">

                                    <button id="btnPEF_submit" value="Submitted" style="float:right;display:none; margin-left: 10px;" class="btn btn-success btnAction" type="button">
                                        Submit
                                    </button>

                                    @*<button id="btnPEF_save" value="Draft" style="float:left;" class="btn btn-info btnAction" type="button">
                                            Save
                                        </button>*@

                                    <button id="btnClose" style="float:right;" class="btn btn-default btnCloseCls" tg="@ViewBag.tg" type="button">
                                        Close
                                    </button>

                                    <button id="btnRevoke" value="Draft" style="float:left;" class="btn btn-default btnAction" type="button">
                                        Revoke
                                    </button>

                                </div>
                            </div>
                        </div>


                        <div class="tab0 clsdivPEF_NPCCRemarks" style="display:none;">
                            &nbsp;<div class="tab1">&nbsp;NPCC Remarks</div>
                            <div class="tab2">&nbsp;</div>
                        </div>



                        <div style="margin-bottom: 20px; display:none;" class="clsdivPEF_NPCCRemarks">

                            <table class="tblFrm">
                                <tr style="display:none">
                                    <td style="width: 25%;">

                                        <label for="Disconame" id="labelVerifyAck">
                                            @*<input type="checkbox" id="chkVerifyAck" name="chkVerifyAck" hidden value="false" class="chkVerifyAck" />*@
                                            <input type="checkbox" id="chkVerifyAck" name="chkVerifyAck" class="chkVerifyAck" value="true" />Event Verified
                                        </label>

                                    </td>


                                </tr>

                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Acknowledgement Date/Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="datePEF_ACKtime" value="@ViewBag.currentDate" type="text" class="form-control frmAck dtDateTime requiredFieldBGC" required>

                                    </td>
                                </tr>
                                <tr style="width: 25%; display:none;">
                                    <td style="width: 25%; display:none;">
                                        <label id="NPCC_ReasonLabel" for="Disconame">Reason<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%; display:none;">
                                        <select class="form-control frmAck requiredFieldBGC" id="ddlNPCC_Reason" required>
                                            <option selected="selected" value="">Select</option>
                                            <option>Leaking in Bolier</option>
                                            <option>Gas Quota Nil</option>
                                            <option>Fuel Shortage</option>
                                            <option>Low Pressure</option>
                                            <option>Standby</option>
                                            <option>Outage</option>
                                        </select>
                                    </td>
                                    <td style="width: 25%; display:none;">
                                        <label for="Disconame" id="NPCC_OutageLabel">Type of Outage<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%; display:none;">
                                        <select class="form-control frmAck requiredFieldBGC" id="ddlNPCC_TypeOfOutage" required>
                                            <option selected="selected" value="">Select</option>
                                            <option>Scheduled Outages</option>
                                            <option>Forced Outage</option>
                                            <option>Maintenance</option>
                                            <option>Washing</option>
                                            <option>Partial FO</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">NPCC Name</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.name" placeholder="@ViewBag.name" readonly id="txtPEF_NPCCNAME" class="form-control frmAck" disabled>
                                    </td>
                                    <td style="width: 25%;">
                                        <label for="Disconame">NPCC Designation</label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input type="text" value="@ViewBag.designation" placeholder="@ViewBag.designation" readonly class="form-control frmAck" id="txtPEF_NPCCDESIG" disabled>
                                    </td>
                                </tr>


                                @*<div style="margin-bottom: 20px;">*@



                                <tr>
                                    <td style="width: 25%;">
                                        <label for="Disconame">Event Type<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frmAck requiredFieldBGC" id="forNPCC_ddlPEF_Event" required>
                                            @*<option selected="selected" value="">Select</option>*@
                                            @*<option>Made Available</option>
                                                <option>Supply Failure</option>
                                                <option>Sync</option>
                                                <option>Desync</option>
                                                <option>Schedule</option>*@
                                            @*<option>Tripping</option>*@

                                            <option>Desync</option>
                                            <option>Sync</option>
                                            <option>Supply Failure</option>
                                            <option>Supply Restoration</option>
                                            <option>Declaration Of PFO</option>
                                            <option>Availability After PFO</option>
                                            <option>Miscellaneous</option>





                                        </select>
                                    </td>

                                    <td style="width: 25%;">
                                        <label for="Disconame">Event Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="forNPCC_datePEF_EventTime" value="@ViewBag.currentDate" type="text" class="form-control frmAck dtDateTime requiredFieldBGC" required>

                                    </td>
                                </tr>




                                <tr id="forNPCC_trPEF_TypeOfOutage">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="OutageLabel">Type of Outage<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frmAck requiredFieldBGC" id="forNPCC_ddlPEF_TypeOfOutage" required>
                                            <option>Forced Outage</option>
                                            @*<option>Partial Outage</option>*@
                                            <option>Scheduled Outage</option>
                                            <option>Supply Failure</option>
                                            <option>Standby</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr id="forNPCC_trPEF_EventReason">

                                    <td style="width: 25%;">
                                        <label for="Disconame" id="labelddlPEF_Reason">Reason<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frmAck requiredFieldBGC" id="forNPCC_ddlPEF_Reason" required>
                                            <option>Technical Problem</option>
                                            <option>Fuel Constraints</option>
                                            <option>Others</option>

                                        </select>
                                    </td>

                                </tr>


                                @*New Code for Sync Status  *@

                                @*<tr id="forNPCC_trPEF_StatusBeforeSync" style="display: none;">
                                        <td style="width: 25%;">
                                            <label for="Disconame" id="StatusSync">Status Before Sync<span class="startColor"> *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <select class="form-control frmAck requiredFieldBGC" id="forNPCC_ddlPEF_StatusSync" required>
                                                <option>Force Outage</option>
                                                <option>Partial Outage</option>
                                                <option>Scheduled Outage</option>
                                                <option>Supply Failure</option>
                                                <option></option>

                                            </select>
                                        </td>
                                    </tr>*@

                                @*New Code for Sync Status  *@


                                <tr id="forNPCC_trPEF_StatusOfMachine" style="display:none;">
                                    <td style="width: 25%;">
                                        <label id="StatusLabel">Status of Machine<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <select class="form-control frmAck requiredFieldBGC" id="forNPCC_ddlPEF_StatusOfMachine" required>
                                            <option></option>
                                        </select>
                                    </td>
                                </tr>


                                @* Commented Availability element.. *@


                                @*<tr id="forNPCC_trPEF_Availability" style="display:none">
                                        <td style="width: 25%;">
                                            <label for="Disconame">Before Event Availability<span class="startColor"> (MW) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frmAck requiredFieldBGC clsAddComa" id="forNPCC_txtPEFBE_Availability" required>

                                        </td>

                                        <td style="width: 25%;">
                                            <label for="Disconame">After Event Availability<span class="startColor"> (MW) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frmAck requiredFieldBGC clsAddComa" id="forNPCC_txtPEF_Availability" required>

                                        </td>
                                    </tr>


                                    <tr id="forNPCC_trPEF_Availability_Complex" style="display:none">
                                        <td style="width: 25%;">
                                            <label for="Disconame">Before Event Availability<span class="startColor"> (MW PER COMPLEX) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frmAck requiredFieldBGC clsAddComa" id="forNPCC_txtPEFBEC_Availability" required>

                                        </td>

                                        <td style="width: 25%;">
                                            <label for="Disconame">After Event Availability<span class="startColor"> (MW PER COMPLEX) *</span></label>
                                        </td>
                                        <td style="width: 25%;">
                                            <input style="display:inline-block; text-align:right;" type="text" value="" readonly class="form-control frmAck requiredFieldBGC clsAddComa" id="forNPCC_txtPEFC_Availability" required>

                                        </td>
                                    </tr>*@



                                @*<tr>
                                        <td style="width: 25%;">
                                            <label for="Disconame">Availability Before Event<span class="startColor"> *</span></label>
                                        </td>
                                        <td style="width: 25%; ">
                                            <input style="display:inline-block; width:90%; text-align:right;" type="text" value="" class="form-control frm requiredFieldBGC clsAddComa" id="txtPEF_Availability_BeforEvent" required>
                                            <label style="display:inline-block;">MW</label>
                                        </td>
                                    </tr>*@

                                <tr style="width: 25%;display:none;">
                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame">Last Demand<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <input style="display:inline-block; text-align:right;" type="text" value="" class="form-control  requiredFieldBGC clsAddComa" id="forNPCC_txtPEF_LastDemand" readonly>
                                    </td>

                                    <td style="width: 25%;display:none;">
                                        <label for="Disconame">Demand Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;display:none;">
                                        <input id="forNPCC_datePEF_DemandDateTime" value="@ViewBag.currentDate" type="text" class="form-control  dtDateTime requiredFieldBGC" readonly>

                                    </td>
                                </tr>

                                <tr id="forNPCC_trderated_cap">

                                    <td style="width: 25%;">
                                        <label for="Disconame" id="Derated_Cap">Capacity<span class="startColor"> *</span></label>
                                    </td>

                                    <td>
                                        <input type="text" style="display:inline-block;   text-align:left;" value="" readonly class="form-control frmAck requiredFieldBGC" id="forNPCC_txtPEF_DeratedCap">
                                    </td>

                                </tr>


                                <tr id="forNPCC_trlaststatus">
                                    <td style="width: 25%;">
                                        <label for="Disconame" id="Last_Event">Last Status<span class="startColor"> *</span></label>
                                    </td>

                                    <td>
                                        <input type="text" style="display:inline-block;   text-align:left;" value="" readonly class="form-control frmAck requiredFieldBGC" id="forNPCC_txtPEF_lastEvent">
                                    </td>
                                </tr>

                                <tr>

                                    <td style="width: 25%;">
                                        <label for="Disconame">Intimation Date & Time<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;">
                                        <input id="forNPCC_datePEF_IntimationTime" value="@ViewBag.currentDate" type="text" readonly class="form-control frmAck dtDateTime requiredFieldBGC" required>

                                    </td>

                                </tr>

                                <tr id="forNPCC_trPEF_Miscellaneous_message" style="display:none">
                                    <td style="width: 25%;vertical-align:top;">
                                        <label>Message<span class="startColor"> *</span></label>
                                    </td>
                                    <td style="width: 25%;" colspan="3">
                                        <textarea cols="70" rows="26" maxlength="6000" class="requiredFieldBGC frmAck" id="forNPCC_txtPEF_Message" style="width: 100%;" required></textarea>
                                    </td>

                                </tr>



                                @*</table>*@


                                @*</div>*@


                                @* REMARKS START *@
                                <tr style="display:none">
                                    <td style="width:25%;vertical-align:middle;">
                                        <label class="Disconame Npcconly">Remarks (only for NPCC)</label>

                                    </td>
                                    <td style="width:25%;" colspan="3">
                                        <textarea cols="70" rows="6" maxlength="2000" id="NPCCOnlyRemarks" class="frmAck Npcconly" required style="width: 100%;"></textarea>

                                    </td>
                                </tr>


                                <tr>
                                    <td style="width:25%;vertical-align:middle;">
                                        <label class="Disconame">Remarks (by NPCC)</label>

                                    </td>
                                    <td style="width:25%;" colspan="3">
                                        <textarea cols="70" rows="6" maxlength="2000" id="NPCCRemarksForIPP" required class="frmAck " style="width: 100%;"></textarea>

                                    </td>
                                </tr>
                            </table>



                        </div>


                        <div class="form-actions clsdivPEF_NPCCRemarks">
                            <div class="row">
                                <div class="col-md-12">

                                    <button id="btnAckNpcc" style="float:right; display:none;" value="Acknowledge" class="btn btn-success" type="button">
                                        Acknowledge
                                    </button>

                                    <button id="btnUpdateNpcc" style="float:right; display:none;" value="Acknowledged" class="btn btn-success" type="button">
                                        Update
                                    </button>
                                    <button id="btnUpdateNpcc" style="float:right; " value="Rejected" class="btn btn-danger" type="button">
                                        Update & Reject
                                    </button>
                                    <button id="btnCloseNpcc" style="float:right;" class="btn btn-default btnCloseCls" tg="@ViewBag.tg" type="button">
                                        Close
                                    </button>

                                </div>
                            </div>
                        </div>




                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        //Check submission date and time
        var submitDateTime;
        //Check Status
        var $status = "";

        $(document).ready(function () {


            //var currentUtcTime = new Date(); // This is in UTC

            // Converts the UTC time to a locale specific format, including adjusting for timezone.
            //var currentDateTimeCentralTimeZone = new Date(currentUtcTime.toLocaleString('en-US', { timeZone: 'Asia/Karachi' }));
            //currentDateTimeCentralTimeZone.toLocaleTimeString();
            //var dateconvert = dateFormat(currentDateTimeCentralTimeZone, "dddd, mmmm dS, yyyy, h:MM:ss");
            //console.log(currentDateTimeCentralTimeZone);

            //var n = d.toLocaleString(convertdate);
            //$('datePEF_IntimationTime').val(dateconvert);

            var usertype = 0;

            // Action Buttons
            $('body').off('click', '.btnAction');
            $('body').on('click', '.btnAction', function (event) {
                event.preventDefault();
                removeComma();
                if ($('#ddlPEF_CBF').val() == "" || $('#ddlPEF_CBF').val() == null || $('#ddlPEF_CBF').val() == undefined) {
                    $strflg = false;
                    swal({
                        title: "Error",
                        text: "Select valid Block / Complex / Unit ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",

                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_CBF').focus(), 100);
                        }
                    });

                    return false;
                }


                if ($('#ddlPEF_Event').val() == "" || $('#ddlPEF_Event').val() == null || $('#ddlPEF_Event').val() == undefined) {
                    $strflg = false;
                    swal({
                        title: "Error",
                        text: "Select valid Event Type ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#PIAR').focus(), 100);
                        }
                    });

                    return false;
                }


                console.log($(this).val());
                var FormStatus = $(this).val();
                var isTrue = validations();
                var GenerationCompany = $('#ddlPEF_IPP :selected').text();
                var Site = $('#ddlPEF_Site :selected').text();
                var Block = $('#ddlPEF_CBF :selected').text(); //ddlPEF_CBF
                var Fuel = $('#txtPEF_Fuel :selected').text();

                if (!isTrue) {
                    return false;
                }
                
                if (($(ddlPEF_TypeOfOutage).val() == 'Standby')) {
                    $(ddlPEF_Reason).val('');
                }

                var $Status = '9½' + $('.btnCloseCls').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + $('#ddlPEF_CBF').val().split('½')[0] + '½' + GenerationCompany + '½' + Site + '½' + Block + '½' + Fuel;
                $('.frm').each(function () {
                    if ($(this).val() == "") {
                        $Status += '½' + "";
                    }
                    else {
                        $Status += '½' + $(this).val() ;
                    }
                });

                //$Status += '½' + $("#txtPEFBE_Availability").val() + '½' + $("#txtPEF_Availability").val();
                console.log($Status);


                // need to add single value of all elements
                ///////////////////////////////////////////////////////////////////////// Submit Confirmation  Start
                /*swal({
                            title: ""+ FormStatus+" Confirmation",
                            text: "Do you want to " + FormStatus+" this plant event notification?",
                            type: "warning",
                            showCancelButton: true,
                            confirmButtonClass: "btn btn-danger",
                            confirmButtonText: "Continue"
                       })*/
                ////////////////////////////////////////////////////////////////////////// Submit Confirmation End


                if ($('#ddlPEF_Event').val() == "Tripping" && $('#ddlPEF_Reason').val() == "") {
                    swal({
                        title: "Error",
                        text: "Select Valid Reason ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_Reason').focus(), 100);
                        }
                    });
                    return false;
                }


                if ($('#ddlPEF_Event').val() == "Tripping" &&
                    $('#ddlPEF_Reason').val() == "Outage" &&
                    $('#ddlPEF_TypeOfOutage').val() == "") {

                    swal({
                        title: "Error",
                        text: "Select valid Type of Outage ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_TypeOfOutage').focus(), 100);
                        }
                    });
                    return false;
                }

                if ($('#ddlPEF_Event').val() == "Supply Failure" && $('#ddlPEF_StatusOfMachine').val() == "") {

                    swal({
                        title: "Error",
                        text: "Select Valid Status of Machine ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_StatusOfMachine').focus(), 100);
                        }
                    });
                    return false;
                }

                var formdata = new FormData();
                // ajax call start
                formdata.append("vls", $Status);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: formdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('.btnAction').prop("disabled", true);

                         if (parseInt(response) > 0) {
                             swal({
                                title: "Plant Event!",
                                text: "Plant event with event no " + response + " has been " + FormStatus + " successfully.",
                                type: "success",
                                showCancelButton: false,  
                                showConfirmButton: true
                            });

                        var options = {};
                        $("#pageContainer").hide('slide', options, 300);
                        $.ajax({
                            url: "/NPCC/PlantEventsList" + $(location).attr('search'),
                            success: function (response) {
                                var options = {};
                                $('#pageContainer').html($(response).find('#pcontent').html());
                                $("#pageContainer").show('slide', options, 500);
                                swal.close();
                            }
                        });
                    }

                }
                });
              //ajax call end
            });
            // Action BUttons End



            //Acknowledge
            $('body').off('click', '#btnAckNpcc');
            $('body').on('click', '#btnAckNpcc', function (event) {
                event.preventDefault();
                removeComma();


                var isTrue = validations();
                var IsVerified = $('.chkVerifyAck').val();
                var FormAckStatus = $(this).val();

                if (!isTrue) {
                    return false;
                }
                var $Status = '109½' + $('.btnCloseCls').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + IsVerified;
                $('.frmAck').each(function () {
                    $Status += '½' + $(this).val();
                });
                console.log($Status);

                // ajax call start

                var formdata = new FormData();
                formdata.append("vls", $Status);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: formdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        swal({
                            title: "Plant Event!",
                            text: "Plant event with event no " + response + " has been "+  FormAckStatus + "successfully.",
                            type: "success",
                            showCancelButton: true,
                            showConfirmButton: false

                        });

                        var options = {};
                        $("#pageContainer").hide('slide', options, 300);
                        $.ajax({
                            url: "/NPCC/PlantEventsList" + $(location).attr('search'),
                            success: function (response) {
                                var options = {};
                                $('#pageContainer').html($(response).find('#pcontent').html());
                                $("#pageContainer").show('slide', options, 500);
                                swal.close();
                            }
                        });

                    }

                });
                //ajax call end
            });
            // Acknowledge End
            // End OF SUBMIT





            //Acknowledge
            $('body').off('click', '#btnUpdateNpcc');
            $('body').on('click', '#btnUpdateNpcc', function (event) {
                event.preventDefault();
                removeComma();

                var isTrue = validations();
                var IsVerified = $('.chkVerifyAck').val();
                var FormAckStatus = $(this).val();

                if (!isTrue) {
                    return false;
                }

                if ($('#NPCCRemarksForIPP').val() == "" || $('#NPCCRemarksForIPP').val() == null || $('#NPCCRemarksForIPP').val() == undefined) {
                    $strflg = false;
                    swal({
                        title: "Error",
                        text: "Please Fill NPCC Remarks ... !",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#PIAR').focus(), 100);
                        }
                    });

                    return false;
                }

                var $Status = '9½' + $('.btnCloseCls').attr('tg').split('½')[0] + '½' + $(this).val() + '½' + IsVerified;
                $('.frmAck').each(function () {
                    $Status += '½' + $(this).val();
                });
                console.log($Status);

                // ajax call start

                var formdata = new FormData();
                formdata.append("vls", $Status);
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: formdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#btnUpdateNpcc').html('Update');
                        swal({
                            title: "Plant Event!",
                            text: "Plant event has been UPDATED successfully.",
                            type: "success",
                            showCancelButton: true,
                            showConfirmButton: false

                        });

                        var options = {};
                        $("#pageContainer").hide('slide', options, 300);
                        $.ajax({
                            url: "/NPCC/PlantEventsList" + $(location).attr('search'),
                            success: function (response) {
                                var options = {};
                                $('#pageContainer').html($(response).find('#pcontent').html());
                                $("#pageContainer").show('slide', options, 500);
                                swal.close();
                            }
                        });

                    }//ajax response

                });
                //ajax call end
            });
            // Acknowledge End
            // End OF Update

            //Anonymous Initiate Function
            $(function () {

                @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 7)
                {
                     @: usertype = 7;
                }
                @if (ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 9)
                {
                     @: usertype = 9;
                }
                else if(ViewBag.userinfo.WP_SETUP_USER_TYPES_ID == 10)
                {
                    @: usertype = 10;
                }

                if ($('.btnCloseCls').attr('tg') == "0") {
                    LoadVendors();
                    CheckStatus();
                }
                else {
                    //FILL FORM TO UPDATE OR VIEW OR FOR FLOW
                    CheckStatus();
                    LoadFormByID();  // keep this to edit and view form

                    //LoadVendors();

                }
            });
            //End Anonymous Initiate Fuction


            // Check Status Start
            function CheckStatus() {
                $('.clsdivPEF_NPCCRemarks').hide();
                $('#btnPEF_submit').hide();
                $('#btnClose').hide();
                $('#btnAckNpcc').hide();
                $('#btnCloseNpcc').hide();
                $('#btnPEF_save').hide();
                $('#btnRevoke').hide();
                $('#btnUpdateNpcc').hide();


                if (((usertype == 7) || (usertype == 9)) && $status == "Draft") {
                    $('#txtPEF_Remarks').prop("disabled", true);
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('.frm').prop("disabled", true);
                    $('#chkVerifyAck').hide();
                    $('#labelVerifyAck').hide();
                    $('#btnCloseNpcc').show();
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    return false;
                }

                if (((usertype == 7) || (usertype == 9)) && $status == "Submitted") {
                    $('#txtPEF_Remarks').prop("disabled", true);
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('.frm').prop("disabled", true);
                    $('#btnAckNpcc').show();

                    var date = new Date(); // checking whether 5 mins have passed or not
                    if (new Date(submitDateTime) > date) {
                        $('#btnAckNpcc').show();
                    }

                    $('#chkVerifyAck').hide();
                    $('#labelVerifyAck').hide();
                    $('#btnCloseNpcc').show();
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    $('#btnUpdateNpcc').show();

                    var vORe = $('#btnClose').attr('tg').split('½')[1];
                    if (vORe == 'e') {
                        $('#btnAckNpcc').hide();
                        $('#btnUpdateNpcc').html('Update & Acknowledge');

                    }
                    if (vORe == 'v') {
                        $('#chkVerifyAck').show();
                        $('#labelVerifyAck').show();

                        $('#btnAckNpcc').show();
                        $('#btnUpdateNpcc').hide();
                        $('.frmAck').prop("disabled", true);
                        $('#chkVerifyAck,#NPCCRemarksForIPP,#datePEF_ACKtime').prop("disabled", false);

                    }

                    return false;
                }


                if (((usertype == 7) || (usertype == 9)) && $status == "Acknowledged") {
                    $('#txtPEF_Remarks,.frm').prop("disabled", true);
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('#btnCloseNpcc').show();
                    $('.frmAck').prop("disabled", false);
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    //$('#btnPEF_submit').show();
                    $('#btnUpdateNpcc').hide();
                    $('.frmAck').prop("disabled", true);

                    return false;
                }

                if (((usertype == 10) || (usertype == 7) || (usertype == 9)) && $status == "") {
                    $('#btnClose').show();
                    $('#btnPEF_submit').show();
                    //$('#btnPEF_save').show();
                    return false;
                }
                if (((usertype == 7) || (usertype == 9)) && $status == "Rejected") {
                    $('#txtPEF_Remarks,.frm').prop("disabled", true);
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('#btnCloseNpcc').show();
                    $('.frmAck').prop("enabled", true);
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    //$('#btnPEF_submit').show();
                    $('#btnUpdateNpcc').show();
                    $('.frmAck').prop("disabled", true);

                    return false;
                }

                if (((usertype == 10) || (usertype == 7) || (usertype == 9)) && $status == "") {
                    $('#btnClose').show();
                    $('#btnPEF_submit').show();
                    //$('#btnPEF_save').show();
                    return false;
                }

                if (usertype == 10 && $status == "Draft") {
                    $('#btnClose').show();
                    $('#btnPEF_submit').hide();
                    return false;
                }

                if (usertype == 10 && $status == "Submitted") {

                    //var date = new Date(); // for showing revoke button within 5 mins
                    //if (new Date(submitDateTime) > date) {
                    //    $('#btnRevoke').show();
                    //}
                    $('#btnPEF_submit').hide();

                    $('#btnClose').show();
                    $('.frm').prop("disabled", true);
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    return false;
                }

                if (usertype == 10 && $status == "Acknowledged") {
                    $('#btnClose').hide();
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('.Npcconly').hide();
                    $('#btnCloseNpcc').show();
                    $('#btnPEF_submit').hide();

                    $('.frm,.frmAck').prop("disabled", true);
                    $('#trPEF_Availability').find('input').prop("disabled", true);
                    return false;
                }
                if (usertype == 10 && $status == "Rejected") {
                    $('#btnClose').hide();
                    $('.clsdivPEF_NPCCRemarks').show();
                    $('.Npcconly').hide();
                    $('#btnCloseNpcc').show();
                    $('#btnPEF_submit').hide();

                    $('.frm,.frmAck').prop("enabled", true);
                    $('#trPEF_Availability').find('input').prop("enabled", true);
                    return false;
                }

     
            }
            //Check Status END


            $('#ddlNPCC_TypeOfOutage').hide();
            $("#NPCC_OutageLabel").hide();
            $('body').off('change', '#ddlNPCC_Reason');
            $('body').on('change', '#ddlNPCC_Reason', function (e) {
                e.preventDefault();
                if ($(this).val() == "Outage") {
                    $('#ddlNPCC_TypeOfOutage').show();
                    $('#NPCC_OutageLabel').show();
                    //typeOfOutage = true;
                }
                else {
                    $('#ddlNPCC_TypeOfOutage').hide();
                    $("#NPCC_OutageLabel").hide();
                    $('#ddlNPCC_TypeOfOutage').val('');
                }
            }); 



            var fd;
            var CompORUnit_NPCC;
            //Start OF EDIT
            function LoadFormByID() {
                var vORe = $('#btnClose').attr('tg').split('½')[1];
                if (vORe == 'e') {
                    $('#btnAckNpcc').hide();
                    //$('#btnUpdateNpcc').html('Update & Acknowledge');

                }
                if (vORe == 'v') {
                    $('#btnAckNpcc').show();
                    $('#chkVerifyAck,#NPCCRemarksForIPP').prop("disabled", false);

                }


                var fromdata = new FormData();
                fromdata.append("vls", '18½' + $('#btnClose').attr('tg'));
                $.ajax({

                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        //OKK ADD
                        fd = $.parseJSON(response);

                        console.log(fd);
                        $('#ddlPEF_IPP').html(fd[0].POWERPRODUCER);
                        $('#ddlIPP_Cat').val(fd[0].IPP_CATEGORY);

                        $('#ddlPEF_Site').html(fd[0].VENDORSITE);
                        $('#ddlPEF_CBF').html(fd[0].BLOCKDDL);
                        $status = fd[0].STATUS;

                        submitDateTime = new Date(fd[0].INTIMATION_TIME);
                        submitDateTime = new Date(submitDateTime.getTime() + 5 * 60000); // increasing time by five minutes

                        CheckStatus();
                        $('#txtPEF_Fuel').html(fd[0].FUELDDL);
                        // $('#txtPowerPolicy').val(fd[0].POWER_POLICY);
                        $('#datePEF_IntimationTime').val(fd[0].INTIMATION_TIME);
                        $('#ddlPEF_Event').html(fd[0].EVENTDDL);
                        $('#datePEF_EventTime').val(fd[0].EVENT_TIME);
                        $('#txtPEF_PowerPolicy').val(fd[0].POWER_POLICY);
                        $('#txtPEF_DependantCap').val(fd[0].DEPENDABLE_CAPACITY);
                        //$('#txtPEF_InstalledCap').val(fd[0].INSTALLED_CAPACITY);
                        $('#txtPEF_lastEvent').val(fd[0].last_status_event);
                        $('#txtPEF_ReasonDetail').val(fd[0].REASON_DETAIL);

                        $('#txtPEF_SenderName').val(fd[0].SENDER_NAME);
                        $('#txtPEF_SenderDesg').val(fd[0].SENDER_DESIGNATION);
                        $("#txtPEFBE_Availability").val(fd[0].PREV_AVAILABILITY);
                        $("#txtPEF_Availability").val(fd[0].AVAILABILITY);
                        $('#txtPEF_Remarks').val(fd[0].REMARKS);
                        $('#txtPEF_Message').val(fd[0].Miscellaneous_Message);
                        $('#txtPEF_DeratedCap').val(fd[0].derated_capacity);
                        $('#forNPCC_ddlPEF_Event option:selected').val(fd[0].EVENT);


                        if ($('#ddlPEF_Event').val() == "Desync" || $('#ddlPEF_Event').val() == "Sync") {
                            $('#trlaststatus').show();
                        }
                        else {
                            $('#trlaststatus').hide();
                        }


                        $('#ddlPEF_Reason').html(fd[0].REASONDDL);
                        if ($('#ddlPEF_Reason').val() == "") {
                            $('#labelddlPEF_Reason').hide();
                            $('#ddlPEF_Reason').hide();
                        }
                        else {
                            $('#ddlPEF_Reason').show();

                        }

                        $('#ddlPEF_TypeOfOutage').html(fd[0].TYPEOFOUTAGE);
                        if ($('#ddlPEF_TypeOfOutage').val() == "") {
                            $('#ddlPEF_TypeOfOutage').hide();
                            $('#OutageLabel').hide();
                        }
                        
                        $('#ddlPEF_StatusOfMachine').html(fd[0].STATUSOFMACHINE);
                        if ($('#ddlPEF_TypeOfOutage').val() == "") {
                            $('#ddlPEF_TypeOfOutage').hide();
                            $('#OutageLabel').hide();
                        }
                        if ($('#ddlPEF_StatusOfMachine').val() == "") {
                            $('#ddlPEF_StatusOfMachine').hide();
                            $('#StatusLabel').hide();
                        }

                        
                        //npcc

                        if ($status == "Submitted") {

                            $('#NPCCOnlyRemarks').val(fd[0].REMARKS);
                        }

                        if ($status == "Acknowledged") {

                            if (fd[0].EVENT_VERIFIED == 1) {
                                $('#chkVerifyAck').attr("checked", "checked");
                            }
                            if ($('#ddlNPCC_TypeOfOutage').val() != "") {
                                $('#ddlNPCC_TypeOfOutage').html("");

                                $('#ddlNPCC_TypeOfOutage').html(fd[0].NPCC_TYPE_OF_OUTAGEDDL);
                            }

                            $('#forNPCC_ddlPEF_Event').html(fd[0].NPCC_EVENT);

                            $('#ddlNPCC_Reason').html(fd[0].NPCC_REASONDDL);
                            if ($('#ddlNPCC_Reason option:selected').val() == "") {                                
                                $('#forNPCC_trPEF_EventReason').hide();
                            }

                            $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                            $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);

                            $('#datePEF_ACKtime').val(fd[0].NPCC_ACK_DATE_TIME);
                            //$('#txtPEF_NPCCNAME').val(fd[0].NPCC_RECEIVER_NAME);
                            //$('#txtPEF_NPCCDESIG').val(fd[0].NPCC_RECEIVER_DESIGNATION);
                            $('#NPCCOnlyRemarks').val(fd[0].NPCC_REMARKS_ONLY_NPCC);
                            $('#NPCCRemarksForIPP').val(fd[0].NPCC_REMARKS_FOR_IPP);

                        }

                        if ($('#ddlPEF_CBF option:selected').val() != "") {

                            //LoadFuelCapacity();
                            //LoadPowerPolicy();
                            //LoadInstalledCapacity();
                        }

                        if (($('#ddlPEF_Reason').val() != null || $('#ddlPEF_Reason').val() != undefined || $('#ddlPEF_Reason').val() != "") && $('#ddlPEF_TypeOfOutage').val() != "") {
                            $('#trPEF_EventReason').show();
                        }
                        if (($('#ddlPEF_TypeOfOutage').val() != null || $('#ddlPEF_TypeOfOutage').val() != undefined || $('#ddlPEF_TypeOfOutage').val() != "") && $('#ddlPEF_TypeOfOutage').val() != "") {
                            $('#trPEF_TypeOfOutage').show();
                        }
                        if (($('#ddlPEF_StatusOfMachine').val() != null || $('#ddlPEF_StatusOfMachine').val() != undefined || $('#ddlPEF_StatusOfMachine').val() != "") && $('#ddlPEF_StatusOfMachine').val() != "") {
                            $('#trPEF_StatusOfMachine').show();
                        }
                        if (($('#ddlPEF_Reason').val() != null || $('#ddlPEF_Reason').val() != undefined || $('#ddlPEF_Reason').val() != "") && $('#ddlPEF_TypeOfOutage').val() == "Forced Outage") {
                            $('#trPEF_EventReason').show();
                            $('#trPEF_ReasonDetail').show();

                        }
                        else {
                            $('#trPEF_ReasonDetail').hide();
                        }

                        $('#forNPCC_ddlPEF_Reason').html(fd[0].NPCC_REASONDDL);
                        if ($('#forNPCC_ddlPEF_Reason').val() == "") {

                            $('#forNPCC_trPEF_EventReason').hide();
                        }
                        else {
                            $('#forNPCC_trPEF_EventReason').show();
                        }

                        $('#forNPCC_ddlPEF_TypeOfOutage').html(fd[0].NPCC_TYPE_OF_OUTAGEDDL);
                        if ($('#forNPCC_ddlPEF_TypeOfOutage').val() == "") {
                            $('#forNPCC_ddlPEF_TypeOfOutage').hide();
                            $('#OutageLabel').hide();
                            $('#forNPCC_trPEF_TypeOfOutage').hide();                            
                        }

                        $('#forNPCC_ddlPEF_StatusOfMachine').html(fd[0].NPCC_STATUS_OF_MACHINE);
                        if ($('#forNPCC_ddlPEF_StatusOfMachine').val() == "") {
                            $('#forNPCC_ddlPEF_StatusOfMachine').hide();
                            $('#StatusLabel').hide();
                        }

                        if ($status == "Acknowledged") {
                            debugger;

                            $('#ddlNPCC_TypeOfOutage').html(fd[0].NPCC_TYPE_OF_OUTAGEDDL);

                            $('#ddlNPCC_Reason').html(fd[0].NPCC_REASONDDL);
                            if ($('#ddlNPCC_Reason option:selected').val() == "") {
                                $('#forNPCC_trPEF_EventReason').hide();
                            }
                            if ($('#forNPCC_ddlPEF_Event').val() == "Desync" || $('#forNPCC_ddlPEF_Event').val() == "Sync") {
                                $('#forNPCC_trlaststatus').show();
                            }
                            else {
                                $('#forNPCC_trlaststatus').hide();
                            }
                            debugger;
                            $('#datePEF_ACKtime').val(fd[0].NPCC_ACK_DATE_TIME);
                            $('#forNPCC_datePEF_EventTime').val(fd[0].NPCC_ACK_DATE_TIME);
                            //$('#txtPEF_NPCCNAME').val(fd[0].NPCC_RECEIVER_NAME);
                            //$('#txtPEF_NPCCDESIG').val(fd[0].NPCC_RECEIVER_DESIGNATION);
                            $('#NPCCOnlyRemarks').val(fd[0].NPCC_REMARKS_ONLY_NPCC);
                            $('#NPCCRemarksForIPP').val(fd[0].NPCC_REMARKS_FOR_IPP);

                        }


                //    }//END OF SUCC
                //});
                        if ($status == "Submitted") {
                            debugger;
                            //new ajax for getting the state of Complex or Unit for NPCC Generation
                            var formdata = new FormData();
                            formdata.append("vls", '180½' + $('#btnClose').attr('tg'));
                            $.ajax({

                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: formdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var c = $.parseJSON(response);
                                    var CompORUnit = c[0].CompORUnit;
                                    console.log(CompORUnit);
                                    debugger;
                                    if (($('#txtPEF_Fuel option:selected').text() != "Solar") && ($('#txtPEF_Fuel option:selected').text() != "Wind") && (CompORUnit == "Complex")) {

                                        $('#forNPCC_ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>\
                            <option>Miscellaneous</option>'
                                        );
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);

                                        debugger;

                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                    <option>Late Sync</option>\
                                    <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }

                                    }

                                    else {
                                        $('#forNPCC_ddlPEF_Event').html('<option>Desync</option>\<option>Sync</option>\<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>\
                            <option>Miscellaneous</option>');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);




                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>'
                                            );

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }

                                    }

                                    if (($('#txtPEF_Fuel option:selected').text() != "Solar" && $('#txtPEF_Fuel option:selected').text() != "Wind") && (CompORUnit) != "Complex") {

                                        $('#forNPCC_ddlPEF_Event').html('<option>Desync</option>\<option>Sync</option>\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);




                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                    <option> Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }
                                    }

                                    if ($('#txtPEF_Fuel option:selected').text() == "Solar" || $('#txtPEF_Fuel option:selected').text() == "Wind") {

                                        $('#forNPCC_ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Miscellaneous</option>');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);



                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                    <option>Late Sync</option>\
                                    <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }
                                    }


                                    if (($('#txtPEF_Fuel option:selected').text() == "Hydel") && (c[0].CompORUnit) != "Complex") {
                                        $('#forNPCC_ddlPEF_Event').html('<option>Desync</option>\<option> Sync</option >');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);




                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }
                                    }

                                    if (($('#txtPEF_Fuel option:selected').text() == "Solar" || $('#txtPEF_Fuel option:selected').text() == "Wind") || (($('#txtPEF_Fuel option:selected').text() == "Hydel") && (CompORUnit) == "Complex")) {
                                        $('#forNPCC_ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Miscellaneous</option>');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);



                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }

                                    }

                                    if (($('#txtPEF_Fuel option:selected').text() == "Hydel") && (c[0].CompORUnit) != "Complex") {
                                        $('#forNPCC_ddlPEF_Event').html('<option>Desync</option>\<option> Sync</option >');
                                        $('#forNPCC_txtPEF_DeratedCap').val(fd[0].derated_capacity);
                                        $('#forNPCC_txtPEF_lastEvent').val(fd[0].last_status_event);



                                        $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                        $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                                        $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                        $('#forNPCC_trevent_dt').show();
                                        $('#forNPCC_trderated_cap').hide();
                                        $('#forNPCC_trPEF_Miscellaneous_message').hide();
                                        $('#forNPCC_trlaststatus').hide();


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Failure") {
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Supply Restoration") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Miscellaneous") {
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_Miscellaneous_message').show();
                                            $('#forNPCC_trevent_dt').hide();
                                            $('#forNPCC_trderated_cap').hide();
                                            $('#forNPCC_trlaststatus').hide();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option>Fuel Constraint</option>');

                                        }

                                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                                            $('#forNPCC_trPEF_Availability').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trderated_cap').show();

                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync") {

                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').hide();
                                            $('#forNPCC_trPEF_TypeOfOutage').hide();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                        }


                                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync") {

                                            $('#forNPCC_trderated_cap').show();
                                            $('#forNPCC_trlaststatus').show();
                                            $('#forNPCC_trPEF_StatusOfMachine').hide();
                                            $('#forNPCC_trPEF_EventReason').show();
                                            $('#forNPCC_trPEF_TypeOfOutage').show();
                                            $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                                            $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                            $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                                        }
                                    }


                                }

                            });
                        }
                        //debugger;
                        //if (NPCC_TOO_DDL != "") {
                        //    $('#ddlNPCC_TypeOfOutage').html(NPCC_TOO_DDL);

                        //}
                        //if (NPCC_REASON_DDL != "") {
                        //    $('#ddlNPCC_TypeOfOutage').html(NPCC_REASON_DDL);

                        //}
                        //debugger;


                    }//END OF SUCC
                });



            }// END of EDIT or View

            //$('body').off('change', '.dtDateTimeLocal');
            //$('body').on('change', '.dtDateTimeLocal', function (e) {
            //    var a = $('datePEF_EventTime').val();
            //    var n = a.toLocaleString();
            //    console.log(n);


            //});


            //var reasonVisible = false, statusOfMachine = false, typeOfOutage = false;
            $('body').off('click', '.btnCloseCls');
            $('body').on('click', '.btnCloseCls', function (e) {
                e.preventDefault();
                var options = {};
                $("#pageContainer").hide('slide', options, 300);
                $.ajax({
                    url: "/NPCC/PlantEventsList" + $(location).attr('search'),
                    success: function (result) {
                        var options = {};
                        $('#pageContainer').html($(result).find('#pcontent').html());
                        $("#pageContainer").show('slide', options, 500);
                    }
                });
            });//End of btnClose Click

            var d = new Date();
            console.log(d);
            var n = d.toLocaleString();
            console.log(n);



            var currentDateTimeCentralTimeZone;
            $('body').on('focus', ".dtDateTime", function () {
                $(this).datetimepicker({

                    format: 'DD-MMM-YYYY HH:mm'
                });
            });//Date Picker



            $('body').off('change', '#ddlPEF_IPP');
            $('body').on('change', '#ddlPEF_IPP', function (e) {
                e.preventDefault();

                $('#txtPEF_PowerPolicy').val('');

                //$('#txtPEF_Fuel option:selected').val('');
                $('#txtPEF_InstalledCap').val('');
                $('#txtPEF_DependantCap').val('');
                //if ($('#ddlPEF_IPP option:selected').val() != "") {
                LoadVendorSites();
                // }
            });// End of change


            $('body').off('change', '#ddlPEF_Site');
            $('body').on('change', '#ddlPEF_Site', function (e) {
                e.preventDefault();

                $('#txtPEF_PowerPolicy').val('');
                //$('#txtPEF_Fuel option:selected').val('');
                $('#txtPEF_InstalledCap').val('');
                $('#txtPEF_DependantCap').val('');
                if ($('#ddlPEF_Site option:selected').val() != "") {
                    LoadFuels();
                    LoadBlockComplexFuels();
                    //LoadFuelCapacity();
                    //LoadPowerPolicy();
                    //LoadInstalledCapacity();
                }
            });


            $('body').off('change', '#txtPEF_Fuel');
            $('body').on('change', '#txtPEF_Fuel', function (e) {
                e.preventDefault();
                if ($('#txtPEF_Fuel option:selected').val() != "") {
                    LoadBlockComplexFuels();

                }


            });



            $('body').off('change', '#ddlPEF_CBF');
            $('body').on('change', '#ddlPEF_CBF', function (e) {
                e.preventDefault();
                if ($('#ddlPEF_CBF').val() == null || $('#ddlPEF_CBF').val() == undefined || $('#ddlPEF_CBF').val() == "") {
                    $('#txtPEF_PowerPolicy, #txtPEF_InstalledCap, #txtPEF_DependantCap').val('');
                }
                else {
                    LoadFuelCapacity();
                }
                // NEW CHANGE
                //else {
                //    $('#txtPEF_Fuel').val($('#ddlPEF_CBF option:selected').val().split('½')[1]);
                //    $('#txtPEF_InstalledCap').val($('#ddlPEF_CBF option:selected').val().split('½')[2]);
                //    $('#txtPEF_DependantCap').val($('#ddlPEF_CBF option:selected').val().split('½')[4]); //AFTER CHANGE THE QUERY CHANGED THE INDEX 2 TO 4
                //    $('#txtPEF_PowerPolicy').val($('#ddlPEF_CBF option:selected').val().split('½')[3]);

                //}
            });


            //Start ddlEvents Scenario....

            $('body').off('change', '#ddlPEF_StatusOfMachine');
            $('body').on('change', '#ddlPEF_StatusOfMachine', function (e) {
                e.preventDefault();

                LoadBeforeAfterAvailability();
            });


            $('body').off('change', '#ddlPEF_Reason');
            $('body').on('change', '#ddlPEF_Reason', function (e) {

                e.preventDefault();

                LoadBeforeAfterAvailability();

            });



            $('body').off('change', '#ddlPEF_Event');
            $('body').on('change', '#ddlPEF_Event', function (e) {
                e.preventDefault();

                $('#ddlPEF_Reason').html('<option></option>');
                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                $('#trPEF_Miscellaneous_message').hide();
                $('#trevent_dt').show();
                $('#trderated_cap').hide();
                $('#trPEF_Miscellaneous_message').hide();
                $('#trlaststatus').hide();
                $('#trPEF_ReasonDetail').hide();

                if ($(this).val() == "Supply Failure") {
                    $('#trPEF_EventReason').hide();
                    $('#trPEF_TypeOfOutage').hide();
                    $('#trPEF_StatusOfMachine').show();
                    $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                    $('#ddlPEF_TypeOfOutage').html('<option></option>');

                }

                //new event type by mr.faheem
                if ($(this).val() == "Supply Restoration") {
                    $('#trPEF_TypeOfOutage').hide();
                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').hide();
                }

                if ($(this).val() == "Miscellaneous") {

                    $('#trPEF_TypeOfOutage').hide();
                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').hide();
                    $('#trPEF_Miscellaneous_message').show();
                    $('#trevent_dt').hide();
                    $('#trderated_cap').hide();
                    $('#trlaststatus').hide();

                }

                if ($(this).val() == "Declaration Of PFO") {

                    $('#trderated_cap').show();
                    $('#trPEF_Availability').hide();
                    $('#trPEF_TypeOfOutage').hide();
                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').show();
                    $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');
                }

                if ($(this).val() == "Availability After PFO") {

                    $('#trPEF_Availability').hide();
                    $('#trPEF_TypeOfOutage').hide();
                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').hide();
                    $('#trderated_cap').show();

                }

                // new code for Sync Event Type

                if ($(this).val() == "Sync") {

                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').hide();
                    $('#trPEF_TypeOfOutage').hide();
                    $('#ddlPEF_StatusOfMachine').html('<option></option>');
                    $('#ddlPEF_Reason').html('<option></option>');
                    $('#trderated_cap').show();
                    $('#trlaststatus').show();

                }

                if ($(this).val() == "Desync") {

                    $('#trderated_cap').show();
                    $('#trlaststatus').show();
                    $('#trPEF_StatusOfMachine').hide();
                    $('#trPEF_EventReason').show();
                    $('#trPEF_TypeOfOutage').show();
                    $('#trPEF_ReasonDetail').show();

                    $('#ddlPEF_StatusOfMachine').html('<option></option>');
                    $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                <option>Late Sync</option>\
                                <option>Others</option>');
                    $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                }
               LoadBeforeAfterAvailability();
            });




            $('body').off('change', '#ddlPEF_TypeOfOutage');
            $('body').on('change', '#ddlPEF_TypeOfOutage', function (e) {
                e.preventDefault();

                if ($(this).val() == "Forced Outage") {
                    $('#trPEF_ReasonDetail').show();
                    $('#trPEF_EventReason').show();

                    $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                        <option>Late Sync</option>\
                                <option>Others</option>');
                }

                if ($(this).val() == "Scheduled Outage") {
                    $('#trPEF_EventReason').show();

                    $('#ddlPEF_Reason').html('<option>Minor Overhaul</option><option>Major Overhaul</option><option>Periodic Inspection</option><option>Combustion Inspection</option><option>Hot Gas Path Inspection</option><option>Major Inspection</option>\
                        <option>Washing</option>\
                        <option>500 OPR HRS</option>\
                        <option>1K OPR HRS</option>\
                        <option>2K OPR HRS</option>\
                        <option>4K OPR HRS</option>\
                        <option>8K OPR HRS</option><option>Others</option>');
                    $('#trPEF_ReasonDetail').hide();

                }

                if ($(this).val() == "Partial Outage") {
                    $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                        <option>Fuel Constraint</option>');
                    $('#trPEF_ReasonDetail').hide();

                }

                if ($(this).val() == "Supply Failure") {
                    $('#trPEF_EventReason').hide();
                    $('#trPEF_ReasonDetail').hide();

                }

                if ($(this).val() == "Standby") {
                    $('#trPEF_EventReason').hide();
                    $('#trPEF_ReasonDetail').hide();

                }

                LoadBeforeAfterAvailability();
            });



            //for NPCC_ddlEvent Scenarios...
            $('body').off('change', '#forNPCC_ddlPEF_TypeOfOutage');
            $('body').on('change', '#forNPCC_ddlPEF_TypeOfOutage', function (e) {
                e.preventDefault();
                if ($(this).val() == "Forced Outage") {
                    $('#forNPCC_trPEF_EventReason').show();

                    $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                <option>Late Sync</option>\
                                <option>Others</option>');
                }

                if ($(this).val() == "Scheduled Outage") {
                    $('#forNPCC_trPEF_EventReason').show();

                    $('#forNPCC_ddlPEF_Reason').html('<option>Minor Overhaul</option><option>Major Overhaul</option><option>Periodic Inspection</option><option>Combustion Inspection</option><option>Hot Gas Path Inspection</option><option>Major Inspection</option>\
                        <option>Washing</option>\
                        <option>500 OPR HRS</option>\
                        <option>1K OPR HRS</option>\
                        <option>2K OPR HRS</option>\
                        <option>4K OPR HRS</option>\
                        <option>8K OPR HRS</option><option>Others</option>');
                }

                if ($(this).val() == "Partial Outage") {
                    $('#forNPCC_trPEF_EventReason').show();

                    $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                        <option>Fuel Constraint</option>');
                }

                if ($(this).val() == "Supply Failure") {
                    $('#forNPCC_trPEF_EventReason').hide();
                }

                if ($(this).val() == "Standby") {
                    $('#forNPCC_trPEF_EventReason').hide();
                }

                for_npcc_LoadBeforeAfterAvailability();
            });



            $('body').off('change', '#forNPCC_ddlPEF_StatusOfMachine');
            $('body').on('change', '#forNPCC_ddlPEF_StatusOfMachine', function (e) {
                e.preventDefault();

                for_npcc_LoadBeforeAfterAvailability();
            });


            $('body').off('change', '#forNPCC_ddlPEF_Reason');
            $('body').on('change', '#forNPCC_ddlPEF_Reason', function (e) {
                e.preventDefault();

                for_npcc_LoadBeforeAfterAvailability();

            });



            //For NPCC EVENT
            $('body').off('change', '#forNPCC_ddlPEF_Event');
            $('body').on('change', '#forNPCC_ddlPEF_Event', function (e) {
                e.preventDefault();


                $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');
                $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                $('#forNPCC_trevent_dt').show();
                $('#forNPCC_trderated_cap').hide();
                $('#forNPCC_trPEF_Miscellaneous_message').hide();
                $('#forNPCC_trlaststatus').hide();


                if ($(this).val() == "Supply Failure") {
                    $('#forNPCC_trPEF_EventReason').hide();
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_trPEF_StatusOfMachine').show();
                    $('#forNPCC_ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                    $('#forNPCC_ddlPEF_TypeOfOutage').html('<option></option>');

                }

                if ($(this).val() == "Supply Restoration") {
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').hide();

                }

                if ($(this).val() == "Miscellaneous") {
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').hide();
                    $('#forNPCC_trPEF_Miscellaneous_message').show();
                    $('#forNPCC_trevent_dt').hide();
                    $('#forNPCC_trderated_cap').hide();
                    $('#forNPCC_trlaststatus').hide();
                }


                if ($(this).val() == "Declaration Of PFO") {
                    $('#forNPCC_trderated_cap').show();
                    $('#forNPCC_trPEF_Availability').hide();
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').show();
                    $('#forNPCC_ddlPEF_Reason').html('\
                    <option>Technical Problem</option>\
                    <option>Fuel Constraint</option>'
                    );

                }

                if ($(this).val() == "Availability After PFO") {
                    $('#forNPCC_trPEF_Availability').hide();
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').hide();
                    $('#forNPCC_trderated_cap').show();

                }


                if ($(this).val() == "Sync") {

                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').hide();
                    $('#forNPCC_trPEF_TypeOfOutage').hide();
                    $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                    $('#forNPCC_ddlPEF_Reason').html('<option></option>');
                    $('#forNPCC_trderated_cap').show();
                    $('#forNPCC_trlaststatus').show();
                }


                if ($(this).val() == "Desync") {

                    $('#forNPCC_trderated_cap').show();
                    $('#forNPCC_trlaststatus').show();
                    $('#forNPCC_trPEF_StatusOfMachine').hide();
                    $('#forNPCC_trPEF_EventReason').show();
                    $('#forNPCC_trPEF_TypeOfOutage').show();
                    $('#forNPCC_ddlPEF_StatusOfMachine').html('<option></option>');
                    $('#forNPCC_ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                <option>Late Sync</option>\
                                <option>Others</option>');
                    $('#forNPCC_ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                }

                for_npcc_LoadBeforeAfterAvailability();

            });



            function LoadBeforeAfterAvailability() {

                $('#txtPEF_Availability').val('');
                $('#txtPEF_Availability').prop("readonly", true);
                $('#txtPEFC_Availability').val('');
                $('#txtPEFC_Availability').prop("readonly", true);
                $('#txtPEFBE_Availability').val('');
                $('#txtPEFBEC_Availability').val('');
                $('#txtPEF_DeratedCap').prop("readonly", true);



                            var ca;
                            var dc;
                            var laststatus;
                            var fromdata = new FormData();

                            fromdata.append("vls", '42½' + $('#ddlPEF_IPP').val() + '½' + $('#ddlPEF_Site').val() + '½' + $('#ddlPEF_CBF').val() + '½' + $('#txtPEF_Fuel option:selected').text());
                            $.ajax({
                                type: "POST",
                                url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                                data: fromdata,
                                contentType: false,
                                processData: false,
                                success: function (response) {
                                    var fd = $.parseJSON(response);
                                    console.log(fd);

                                    ca = (fd[0].ca);
                                    dc = (fd[0].dc);
                                    laststatus = (fd[0].laststatus);

                                    console.log(ca, dc, laststatus);

                                    //if (laststatus == 'On bar' && ) {
                                    //    $('#ddlPEF_Event').html('<option>Desync</option><option>Sync</option><option>Declaration Of PFO</option><option>Availability After PFO</option>');

                                    //}
                                    //else {

                                    //}


                                    //4.    For Standby in Sync or Desync Event

                                    if (($('#ddlPEF_Event').val() == "Sync" && $('#ddlPEF_StatusSync').val() == "Standby") || ($('#ddlPEF_Event').val() == "Desync" && $('#ddlPEF_TypeOfOutage').val() == "Standby")) {
                                        //var a = $('#txtPEF_DependantCap').val();
                                        $('#txtPEF_Availability').val(y);
                                        $('#txtPEFBE_Availability').val(y);

                                        $('#txtPEFBEC_Availability').val(ca);
                                        //var c = b - a;
                                        $('#txtPEFC_Availability').val(ca);
                                        $('#txtPEF_DeratedCap').val(dc);
                                        $('#txtPEF_lastEvent').val(laststatus);


                                    }
                                    //1.except standby & Made Available
                                    else {
                                        $('#txtPEF_Availability').val('0');
                                        $('#txtPEFBE_Availability').val(y);

                                        $('#txtPEFBEC_Availability').val(ca);
                                        var a = ca - y;
                                        $('#txtPEFC_Availability').val(a);
                                        $('#txtPEF_DeratedCap').val(dc);
                                        $('#txtPEF_lastEvent').val(laststatus);

                                    }


                                    //2.For Partial Outage in Sync or Made Available Event
                                    if ($('#ddlPEF_Event').val() == "Sync" && $('#ddlPEF_StatusSync').val() == "Partial Outage") {
                                        $('#txtPEF_Availability').val('');
                                        $('#txtPEFC_Availability').val('');
                                        $('#txtPEFBEC_Availability').val('');
                                        $('#txtPEFBE_Availability').val('');
                                        $('#txtPEF_DeratedCap').val('');

                                        $('#txtPEF_lastEvent').val(laststatus);

                                        $('#txtPEFBE_Availability').val('0');
                                        var b = ca - y;
                                        $('#txtPEFBEC_Availability').val(ca);
                                        $('#txtPEF_Availability').prop("readonly", false);
                                        $('#txtPEFC_Availability').prop("readonly", false);
                                        $('#txtPEF_DeratedCap').prop("readonly", false);

                                    }


                                    //3.Made Available Event
                                    if (($('#ddlPEF_Event').val() == "Sync") && $('#ddlPEF_StatusSync').val() == "Forced Outage" || $('#ddlPEF_StatusSync').val() == "Scheduled Outage" || $('#ddlPEF_StatusSync').val() == "Supply Failure") {
                                        $('#txtPEF_lastEvent').val(laststatus);

                                        //var a = $('#txtPEF_DependantCap').val();
                                        $('#txtPEF_Availability').val(y);
                                        $('#txtPEFBE_Availability').val('0');
                                        //var b = $('#txtPEFBEC_Availability').val();
                                        $('#txtPEFBEC_Availability').val(ca);
                                        var b = parseFloat(ca) + parseFloat(y);
                                        $('#txtPEFC_Availability').val(b);
                                        $('#txtPEF_DeratedCap').val(dc);


                                    }

                                    //4.Partial Outage in Made Available Event
                                    if ($('#ddlPEF_Event').val() == "Desync" && $('#ddlPEF_TypeOfOutage').val() == "Partial Outage") {
                                        $('#txtPEF_Availability').val('');
                                        $('#txtPEFC_Availability').val('');
                                        $('#txtPEFBEC_Availability').val('');
                                        $('#txtPEFBE_Availability').val('');
                                        $('#txtPEF_DeratedCap').val('');
                                        $('#txtPEF_lastEvent').val(laststatus);

                                        $('#txtPEFBE_Availability').val(y);
                                        var b = ca - y;
                                        $('#txtPEFBEC_Availability').val(ca);
                                        $('#txtPEF_Availability').prop("readonly", false);
                                        $('#txtPEFC_Availability').prop("readonly", false);
                                        $('#txtPEF_DeratedCap').prop("readonly", false);

                                    }



                                    if ($('#ddlPEF_Event').val() == "Declaration Of PFO" ) {
                                        $('#txtPEF_Availability').val('');
                                        $('#txtPEFC_Availability').val('');
                                        $('#txtPEFBEC_Availability').val('');
                                        $('#txtPEFBE_Availability').val('');
                                        $('#txtPEF_DeratedCap').val(dc);
                                        $('#txtPEF_lastEvent').val(laststatus);


                                        $('#txtPEFBE_Availability').val('0');
                                        var b = ca - y;
                                        $('#txtPEFBEC_Availability').val(b);
                                        $('#txtPEF_Availability').prop("readonly", false);
                                        $('#txtPEFC_Availability').prop("readonly", false);
                                        $('#txtPEF_DeratedCap').prop("readonly", false);

                                    }



                                    if ($('#ddlPEF_Event').val() == "Availability After PFO" ) {
                                        $('#txtPEF_Availability').val('');
                                        $('#txtPEFC_Availability').val('');
                                        $('#txtPEFBEC_Availability').val('');
                                        $('#txtPEFBE_Availability').val('');
                                        $('#txtPEF_DeratedCap').val(dc);
                                        $('#txtPEF_lastEvent').val(laststatus);


                                        $('#txtPEFBE_Availability').val('0');
                                        var b = ca - y;
                                        $('#txtPEFBEC_Availability').val(b);
                                        $('#txtPEF_Availability').prop("readonly", false);
                                        $('#txtPEFC_Availability').prop("readonly", false);
                                        $('#txtPEF_DeratedCap').prop("readonly", false);

                                    }


                                }
                                });
            }




            //For NPCC Availability Function()

            var for_npcc_ipp;
            function for_npcc_LoadBeforeAfterAvailability() {

                $('#forNPCC_txtPEF_Availability').val('');
                $('#forNPCC_txtPEF_Availability').prop("readonly", true);
                $('#forNPCC_txtPEFC_Availability').val('');
                $('#forNPCC_txtPEFC_Availability').prop("readonly", true);
                $('#forNPCC_txtPEFBE_Availability').val('');
                $('#forNPCC_txtPEFBEC_Availability').val('');
                $('#forNPCC_txtPEF_DeratedCap').prop("readonly", true);




                var ca;
                var dc;
                var laststatus;
                var fromdata = new FormData();
                fromdata.append("vls", '42½' + $('#ddlPEF_IPP').val() + '½' + $('#ddlPEF_Site').val() + '½' + $('#ddlPEF_CBF').val() + '½' + $('#txtPEF_Fuel option:selected').text());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);

                        ca = (fd[0].ca);
                        dc = (fd[0].dc);
                        laststatus = (fd[0].laststatus);

                        console.log(ca, dc, laststatus);


                        if (($('#forNPCC_ddlPEF_Event').val() == "Sync" && $('#forNPCC_ddlPEF_StatusSync').val() == "Standby") || ($('#forNPCC_ddlPEF_Event').val() == "Desync" && $('#forNPCC_ddlPEF_TypeOfOutage').val() == "Standby")) {
                            //var a = $('#txtPEF_DependantCap').val();
                            $('#forNPCC_txtPEF_Availability').val(y);
                            $('#forNPCC_txtPEFBE_Availability').val(y);

                            $('#forNPCC_txtPEFBEC_Availability').val(ca);
                            //var c = b - a;
                            $('#forNPCC_txtPEFC_Availability').val(ca);
                            $('#forNPCC_txtPEF_DeratedCap').val(dc);
                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);


                        }
                        //1.except standby & Made Available
                        else {
                            $('#forNPCC_txtPEF_Availability').val('0');
                            $('#forNPCC_txtPEFBE_Availability').val(y);

                            $('#forNPCC_txtPEFBEC_Availability').val(ca);
                            var a = ca - y;
                            $('#forNPCC_txtPEFC_Availability').val(a);
                            $('#forNPCC_txtPEF_DeratedCap').val(dc);
                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);

                        }


                        //2.For Partial Outage in Sync or Made Available Event
                        if ($('#forNPCC_ddlPEF_Event').val() == "Sync" && $('#forNPCC_ddlPEF_StatusSync').val() == "Partial Outage") {
                            $('#forNPCC_txtPEF_Availability').val('');
                            $('#forNPCC_txtPEFC_Availability').val('');
                            $('#forNPCC_txtPEFBEC_Availability').val('');
                            $('#forNPCC_txtPEFBE_Availability').val('');
                            $('#forNPCC_txtPEF_DeratedCap').val('');

                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);

                            $('#forNPCC_txtPEFBE_Availability').val('0');
                            var b = ca - y;
                            $('#forNPCC_txtPEFBEC_Availability').val(ca);
                            $('#forNPCC_txtPEF_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEFC_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEF_DeratedCap').prop("readonly", false);

                        }


                        //3.Made Available Event
                        if (($('#forNPCC_ddlPEF_Event').val() == "Sync") && $('#forNPCC_ddlPEF_StatusSync').val() == "Forced Outage" || $('#forNPCC_ddlPEF_StatusSync').val() == "Scheduled Outage" || $('#forNPCC_ddlPEF_StatusSync').val() == "Supply Failure") {
                            $('#txtPEF_lastEvent').val(laststatus);

                            //var a = $('#txtPEF_DependantCap').val();
                            $('#forNPCC_txtPEF_Availability').val(y);
                            $('#forNPCC_txtPEFBE_Availability').val('0');
                            //var b = $('#txtPEFBEC_Availability').val();
                            $('#forNPCC_txtPEFBEC_Availability').val(ca);
                            var b = parseFloat(ca) + parseFloat(y);
                            $('#forNPCC_txtPEFC_Availability').val(b);
                            $('#forNPCC_txtPEF_DeratedCap').val(dc);


                        }

                        //4.Partial Outage in Made Available Event
                        if ($('#forNPCC_ddlPEF_Event').val() == "Desync" && $('#forNPCC_ddlPEF_TypeOfOutage').val() == "Partial Outage") {
                            $('#forNPCC_txtPEF_Availability').val('');
                            $('#forNPCC_txtPEFC_Availability').val('');
                            $('#forNPCC_txtPEFBEC_Availability').val('');
                            $('#forNPCC_txtPEFBE_Availability').val('');
                            $('#forNPCC_txtPEF_DeratedCap').val('');
                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);

                            $('#forNPCC_txtPEFBE_Availability').val(y);
                            var b = ca - y;
                            $('#forNPCC_txtPEFBEC_Availability').val(ca);
                            $('#forNPCC_txtPEF_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEFC_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEF_DeratedCap').prop("readonly", false);

                        }

                        if ($('#forNPCC_ddlPEF_Event').val() == "Declaration Of PFO") {
                            $('#forNPCC_txtPEF_Availability').val('');
                            $('#forNPCC_txtPEFC_Availability').val('');
                            $('#forNPCC_txtPEFBEC_Availability').val('');
                            $('#forNPCC_txtPEFBE_Availability').val('');
                            $('#forNPCC_txtPEF_DeratedCap').val(dc);
                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);

                            $('#forNPCC_txtPEFBE_Availability').val('0');
                            var b = ca - y;
                            $('#forNPCC_txtPEFBEC_Availability').val(b);
                            $('#forNPCC_txtPEF_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEFC_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEF_DeratedCap').prop("readonly", false);

                        }



                        if ($('#forNPCC_ddlPEF_Event').val() == "Availability After PFO") {
                            $('#forNPCC_txtPEF_Availability').val('');
                            $('#forNPCC_txtPEFC_Availability').val('');
                            $('#forNPCC_txtPEFBEC_Availability').val('');
                            $('#forNPCC_txtPEFBE_Availability').val('');
                            $('#forNPCC_txtPEF_DeratedCap').val(dc);
                            //$('#forNPCC_txtPEF_lastEvent').val(laststatus);


                            $('#forNPCC_txtPEFBE_Availability').val('0');
                            var b = ca - y;
                            $('#forNPCC_txtPEFBEC_Availability').val(b);
                            $('#forNPCC_txtPEF_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEFC_Availability').prop("readonly", false);
                            $('#forNPCC_txtPEF_DeratedCap').prop("readonly", false);

                        }

                    }
                });

            }







            $('body').on('focus', "#txtPEF_Availability", function () {
                removeComma();
            });

            $('body').on('focusout', "#txtPEF_Availability", function () {
                addComma();
            });

            $('body').on('focus', "#txtPEFBE_Availability", function () {
                removeComma();
            });

            $('body').on('focusout', "#txtPEFBE_Availability", function () {
                addComma();
            });

            $('body').off('keypress', '.clsAddComa');
            $('body').on('keypress', '.clsAddComa', function (event) {
                var keyCode = event.keyCode || event.which;
                if (keyCode == 9) {
                    event.preventDefault();
                    // call custom function here
                }
                var $this = $(this);
                if ((event.which != 46 || $this.val().indexOf('.') != -1) &&
                    ((event.which < 48 || event.which > 57) &&
                        (event.which != 0 && event.which != 8))) {
                    event.preventDefault();

                }

                var text = $(this).val();
                text = text.replace(/,/g, '');
                if ((event.which == 46) && (text.indexOf('.') == -1)) {
                    setTimeout(function () {
                        if ($this.val().substring($this.val().indexOf('.')).length > 5) {
                            $this.val($this.val().substring(0, $this.val().indexOf('.') + 5));
                        }
                    }, 1);
                }

                if ((text.indexOf('.') != -1) &&
                    (text.substring(text.indexOf('.')).length > 4) &&
                    (event.which != 0 && event.which != 8) &&
                    ($(this)[0].selectionStart >= text.length - 4)) {
                    event.preventDefault();
                }

            });

            //$('body').off('change', '#txtPEF_Availability');
            //$('body').on('change', '#txtPEF_Availability', function (e) {
            //    e.preventDefault();
            //    addComma();

            //});


            $('body').off("paste", '.clsAddComa');
            $('body').on("paste", '.clsAddComa', function (e) {
                var thisCtrl = $(this);
                var text = e.originalEvent.clipboardData.getData('Text');
                text = text.replace(/,/g, '');
                if ($.isNumeric(text)) {
                    if ((text.substring(text.indexOf('.')).length >= 5) && (text.indexOf('.') > -1)) {
                        e.preventDefault();
                        thisCtrl.val(text.substring(0, text.indexOf('.') + 5));
                        thisCtrl.change();
                    }
                }
                else {
                    e.preventDefault();
                    swal({
                        title: "Invalid Input",
                        text: "Please enter only numeric values!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => thisCtrl.focus(), 100);
                        }
                    });
                }
            });

            //7-1-21
            //function LoadIPPCat() {
            //    var fromdata = new FormData();
            //    fromdata.append('vls', '110');
            //    $.ajax({
            //        type: "POST",
            //        url: "/NPCC/AjaxCall" + $(location).attr("search"),
            //        data: fromdata,
            //        contentType: false,
            //        processData: false,
            //        success: function (response) {

            //            //var fd = $.parseJSON(response);
            //            //$('#ddlIPP').val(fd[0].vendors);
            //            $('#ddlIPP_Cat').html(response);

            //            if ($('#ddlIPP_Cat').val() == null || $('#ddlIPP_Cat').val() == undefined || $('#ddlIPP_Cat').val() == "") {

            //                $('#ddlIPP').html('');
            //                //$('#txtFuel, #txtCapacity, #txtDependableCapacity, #txtPowerPolicy').val('');
            //            }
            //            else {
            //                LoadVendors();
            //            }
            //        }
            //    });

            //}//END OF LOAD


            function LoadVendors() {
                var fromdata = new FormData();
                fromdata.append('vls', '104½' + $('#ddlIPP_Cat').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCall" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {

                        //var fd = $.parseJSON(response);
                        //$('#ddlIPP').val(fd[0].vendors);
                        $('#ddlPEF_IPP').html(response);

                        if ($('#ddlPEF_IPP').val() == null || $('#ddlPEF_IPP').val() == undefined || $('#ddlPEF_IPP').val() == "") {

                            $('#ddlPEF_Site,#ddlPEF_CBF').html('');
                            //$('#txtFuel, #txtCapacity, #txtDependableCapacity, #txtPowerPolicy').val('');
                        }
                        else {
                            LoadVendorSites();
                        }
                    }
                });

            }//END OF LOAD


            function LoadVendorSites() {
                var fromdata = new FormData();
                fromdata.append("vls", '0½' + $('#ddlPEF_IPP').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlPEF_Site').html(response);
                        if ( $('#ddlPEF_Site').val() == null || $('#ddlPEF_Site').val() == undefined || $('#ddlPEF_Site').val() == "") {
                            $('#txtPEF_PowerPolicy, #txtPEF_InstalledCap, #txtPEF_DependantCap').val('');
                            //LoadPowerPolicy();
                        } else {
                            LoadFuels();

                            //LoadFuelCapacity();
                        }
                    }
                });
            }//END OF LOAD


            function LoadFuels() {
                var fromdata = new FormData();

                fromdata.append("vls", '8½' + $('#ddlPEF_Site').val());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#txtPEF_Fuel').html(response);
                        console.log($('#txtPEF_Fuel option:selected').text());
                        LoadBlockComplexFuels();

                    }
                });

            }
            $('body').off('change', '#ddlIPP_Cat');
            $('body').on('change', '#ddlIPP_Cat', function (e) {
               LoadVendors();
            });

            function LoadBlockComplexFuels() {
                var fromdata = new FormData();
                fromdata.append("vls", '1½' + $('#ddlPEF_IPP').val() + '½' + $('#ddlPEF_Site').val() + '½' + $('#txtPEF_Fuel option:selected').text());
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        $('#ddlPEF_CBF').html(response);
                        if ( $('#ddlPEF_CBF').val() != null || $('#ddlPEF_CBF').val() != undefined || $('#ddlPEF_CBF').val() != "") {
                            $('#ddlPEF_CBF option').filter(function () { return $.trim($(this).text()) == 'Complex'; }).prop('selected', true);
                            $('#ddlPEF_CBF').change();
                            LoadFuelCapacity();


                            LoadBeforeAfterAvailability();

                            //$('#txtPEF_Fuel').val($('#ddlPEF_CBF option:selected').val().split('½')[1]);
                            //$('#txtPEF_InstalledCap').val($('#ddlPEF_CBF option:selected').val().split('½')[2]);
                            //$('#txtPEF_DependantCap').val($('#ddlPEF_CBF option:selected').val().split('½')[4]); //AFTER CHANGE THE QUERY CHANGED THE INDEX 2 TO 4
                            //$('#txtPEF_PowerPolicy').val($('#ddlPEF_CBF option:selected').val().split('½')[3]);

                        }
                        else {
                            $('#txtPEF_PowerPolicy, #txtPEF_InstalledCap, #txtPEF_DependantCap').val('');
                        }


                        //$('#ddlPEF_CBF option:contains("Complex")').prop('selected', true);
                    }

                });
            }


            var x;
            var y;
            var c;
            function LoadFuelCapacity() {
                var fromdata = new FormData();
                fromdata.append("vls", '39½' + $('#ddlPEF_IPP').val() + '½' + $('#ddlPEF_Site').val() + '½' + $('#ddlPEF_CBF').val() );
                $.ajax({
                    type: "POST",
                    url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                    data: fromdata,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var fd = $.parseJSON(response);
                        console.log(fd);
                        //$('#txtPEF_Fuel').val('');
                        //$('#txtPEF_PowerPolicy').val('');
                        //$('#txtPEF_InstalledCap').val('');
                        //$('#txtPEF_DependantCap').val('');

                        //$('#txtPEF_Fuel').val(fd[0].fuel);
                        $('#txtPEF_PowerPolicy').val(fd[0].power_policy);
                        $('#txtPEF_InstalledCap').val(fd[0].installed_capacity);
                        $('#txtPEF_DependantCap').val(fd[0].dependable_capacity);
                        $('#txtPEF_DeratedCap').val(fd[0].dependable_capacity);

                        y=(fd[0].dependable_capacity);
                        //$('#txtPEFBEC_Availability')(fd[0].complex_dependable_capacity);

                        x = (fd[0].complex_dependable_capacity);


                        var fromdata = new FormData();
                        fromdata.append("vls", '181½' + $('#ddlPEF_CBF').val());
                        $.ajax({

                            type: "POST",
                            url: "/NPCC/AjaxCallNext" + $(location).attr("search"),
                            data: fromdata,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                c = $.parseJSON(response);
                                console.log(c);




                                if (($('#txtPEF_Fuel option:selected').text() != "Solar" && $('#txtPEF_Fuel option:selected').text() != "Wind") && ((c[0].CompORUnit) == "Complex")) {
                            $('#ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>\
                            <option>Miscellaneous</option>'
                            );


                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trlaststatus').hide();
                            $('#trPEF_ReasonDetail').hide();

                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }



                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                $('#trderated_cap').show();
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                $('#trderated_cap').show();

                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#trPEF_ReasonDetail').show();

                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }




                        }
                        else {
                            $('#ddlPEF_Event').html('<option>Desync</option>\<option>Sync</option>\<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>\
                            <option>Miscellaneous</option>');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trlaststatus').hide();
                            $('#trPEF_ReasonDetail').hide();





                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }



                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                $('#trderated_cap').show();
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                $('#trderated_cap').show();


                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }





                                }
                                

                                if (($('#txtPEF_Fuel option:selected').text() != "Solar") && ($('#txPEF_Fuel option:selected').text() != "Wind") && ((c[0].CompORUnit) != "Complex")) {

                                   
                            $('#ddlPEF_Event').html('<option>Desync</option>\<option>Sync</option>\
                            <option>Declaration Of PFO</option>\
                            <option>Availability After PFO</option>');
                            //<option>Miscellaneous</option>');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trlaststatus').hide();
                            $('#trPEF_ReasonDetail').hide();





                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }



                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                $('#trderated_cap').show();
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                $('#trderated_cap').show();


                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                        }


                                if ($('#txtPEF_Fuel option:selected').text() == "Solar" || $('#txtPEF_Fuel option:selected').text() == "Wind") {
                            $('#ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Miscellaneous</option>');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                                    $('#trlaststatus').hide();
                                    $('#trPEF_ReasonDetail').hide();



                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();

                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }

                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                $('#trderated_cap').show();
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trderated_cap').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');

                            }
                        }


                                if (($('#txtPEF_Fuel option:selected').text() == "Hydel") && ((c[0].CompORUnit) != "Complex")) {
                                    debugger;
                            $('#ddlPEF_Event').html('<option>Desync</option>\<option> Sync</option >');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                                    $('#trlaststatus').hide();
                                    $('#trPEF_ReasonDetail').hide();





                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();
                            }

                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                trPEF_Availability
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();

                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }
                        }



                                if (($('#txtPEF_Fuel option:selected').text() == "Solar" || $('#txtPEF_Fuel option:selected').text() == "Wind") || (($('#txtPEF_Fuel option:selected').text() == "Hydel") && ((c[0].CompORUnit) == "Complex"))) {
                            $('#ddlPEF_Event').html('<option>Supply Failure</option>\<option> Supply Restoration</option >\
                            <option>Miscellaneous</option>');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                                    $('#trlaststatus').hide();
                                    $('#trPEF_ReasonDetail').hide();





                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }



                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                trPEF_Availability
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();

                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                    <option> Fuel Constraints</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }
                        }

                                if (($('#txtPEF_Fuel option:selected').text() == "Hydel") && ((c[0].CompORUnit) != "Complex")) {
                            $('#ddlPEF_Event').html('<option>Desync</option>\<option> Sync</option >');

                            $('#ddlPEF_Reason').html('<option></option>');
                            $('#ddlPEF_TypeOfOutage').html('<option></option>');
                            $('#ddlPEF_StatusOfMachine').html('<option></option>');
                            $('#ddlPEF_StatusSync').html('<option></option>'); //new line
                            $('#trPEF_Miscellaneous_message').hide();
                            $('#trevent_dt').show();
                            $('#trderated_cap').hide();
                            $('#trPEF_Miscellaneous_message').hide();
                                    $('#trlaststatus').hide();
                                    $('#trPEF_ReasonDetail').hide();





                            //new event type by mr.faheem
                            if ($('#ddlPEF_Event').val() == "Supply Restoration") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();


                            }

                            if ($('#ddlPEF_Event').val() == "Miscellaneous") {
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();
                                //$('#trPEF_Availability').show();
                                $('#trPEF_Miscellaneous_message').show();
                                $('#trevent_dt').hide();
                                $('#trderated_cap').hide();
                                $('#trlaststatus').hide();


                            }



                            if ($('#ddlPEF_Event').val() == "Declaration Of PFO") {
                                trPEF_Availability
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').show();
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                    <option>Fuel Constraint</option>');

                            }

                            if ($('#ddlPEF_Event').val() == "Availability After PFO") {
                                $('#trPEF_Availability').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_EventReason').hide();

                            }


                            if ($('#ddlPEF_Event').val() == "Supply Failure") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').hide(); //new line
                                $('#trPEF_StatusOfMachine').show();
                                $('#ddlPEF_StatusOfMachine').html('<option>Island Mode</option><option>Tripped</option><option>Previously Offbar</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option></option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }


                            // new code for Sync Event Type

                            if ($('#ddlPEF_Event').val() == "Sync") {
                                //$('#trPEF_Availability').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').hide();
                                $('#trPEF_TypeOfOutage').hide();
                                $('#trPEF_StatusBeforeSync').show();
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option></option>');
                                //$('#ddlPEF_StatusSync').html('<option>Force Outage</option><option>Standby</option><option>Partial Outage</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#ddlPEF_StatusSync').html('<option>Forced Outage</option><option>Standby</option><option>Scheduled Outage</option><option>Supply Failure</option>');
                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                            }


                            // new code for Sync Event Type End

                            if ($('#ddlPEF_Event').val() == "Desync") {
                                //$('#trPEF_Availability').show();

                                $('#trderated_cap').show();
                                $('#trlaststatus').show();

                                $('#trPEF_StatusOfMachine').hide();
                                $('#trPEF_EventReason').show();
                                $('#trPEF_TypeOfOutage').show();
                                $('#trPEF_ReasonDetail').show();

                                $('#trPEF_StatusBeforeSync').hide();  //new line
                                $('#ddlPEF_StatusOfMachine').html('<option></option>');
                                $('#ddlPEF_Reason').html('<option>Technical Problem</option>\
                                                            <option>Late Sync</option>\
                                <option>Others</option>');
                                $('#ddlPEF_TypeOfOutage').html('<option>Forced Outage</option><option>Scheduled Outage</option><option>Supply Failure</option><option>Standby</option><option>Low Hydrology</option>');
                                $('#ddlPEF_StatusSync').html('<option></option>'); //new line

                            }
                        }



                        LoadBeforeAfterAvailability();




                            }
                        });


                    }
                });
            }



            function validations() {
                if ($('#ddlPEF_IPP').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please select power producer!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_IPP').focus(), 100)
                        }
                    });
                    return false;
                }
                if ($('#ddlPEF_Site').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please select power producer site!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_Site').focus(), 100)
                        }
                    });
                    return false;
                }
                if ($('#ddlPEF_CBF').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please select complex/block/unit!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_CBF').focus(), 100);
                        }
                    });
                    return false;
                }
                if ($('#ddlPEF_Event').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please select event type!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_Event').focus(), 100);
                        }
                    });
                    return false;
                }
                if ($('#datePEF_EventTime').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please enter event date & time!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#datePEF_EventTime').focus(), 100);
                        }
                    });
                    return false;
                }

                if ($('#ddlPEF_Reason > option:selected').text() == 'Outage' && $('#ddlPEF_TypeOfOutage').val() == '') {
                    swal({
                        title: "Error",
                        text: "Please select type of outage!",
                        type: "warning",
                        showCancelButton: false,
                        confirmButtonClass: "btn btn-danger",
                        confirmButtonText: "OK",
                        onAfterClose: () => {
                            setTimeout(() => $('#ddlPEF_TypeOfOutage').focus(), 100)
                        }
                    });
                    return false;
                }
                //if ($('#datePEF_IntimationTime').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter intimation time!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#datePEF_IntimationTime').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                //if ($('#txtPEF_Remarks').val() == '') {
                //    swal({
                //        title: "Error",
                //        text: "Please enter event remarks!",
                //        type: "warning",
                //        showCancelButton: false,
                //        confirmButtonClass: "btn btn-danger",
                //        confirmButtonText: "OK",
                //        onAfterClose: () => {
                //            setTimeout(() => $('#txtPEF_Remarks').focus(), 100)
                //        }
                //    });
                //    return false;
                //}
                return true;
            }

            function removeComma() {
                $('.clsAddComa').each(function (index, element) {
                    var $val = $(this).val().replace(/,/g, '');
                    $(this).val($val);
                });
            }
            function addComma() {
                $('.clsAddComa').each(function (index, element) {
                    var $val = $(this).val().replace(/,/g, '');
                    $val = numberWithCommas($val);
                    $(this).val($val);
                });
            }
            function numberWithCommas(x) {
                // return x.toString().replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                x = x.toString();
                if (x % 1 == 0) {
                    if (x.indexOf(".") < 0) {
                        x = x.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                        x += ".0000";
                    } else {
                        x = x.replace('.0000', '').replace('.000', '').replace('.00', '').replace('.0', '');
                        x = x.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                        x += ".0000";

                    }
                } else {
                    var index = x.indexOf(".");
                    var p1 = x.substring(0, index);
                    p1 = p1.replace(/\D/g, '').replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    var p2 = x.substring(index);
                    p2 = p2 + "0000";
                    p2 = p2.substring(0, 5);
                    x = p1 + p2;
                }
                return x;
            }

        });


    </script>
</div>